<?php
//$this->headLink()->appendStylesheet(Connexions::url('/css/auth.css'));
//$this->headLink()->appendStylesheet($this->baseUrl('css/auth.css'));
$this->headTitle('Sign In');

$jQuery = $this->jQuery();
$jQuery->addStylesheet($this->baseUrl('css/auth.css'));

$jQuery->addJavascriptFile($this->baseUrl('js/ui.button.js'));
$jQuery->addJavascriptFile($this->baseUrl('js/ui.input.js'));

$jQuery->addOnLoad('authSignin_onLoad();');

$jQuery->javascriptCaptureStart();
?>
/************************************************
 * UI Initialization
 *
 */
var $form       = null;
var $submit     = null;
var $error      = null;

function authSignin_onLoad()
{
    $form   = $('#auth form');
    $form.hide();   // hide while we prepare....

    $form.addClass('ui-form');

    $error      = $('.formError');
    $submit     = $('#auth button[name=submit]');

    $submit.button({ priority:'primary', enabled:false});

    // Style all remaining input[type=text] / textarea controls with ui.input
    $('#auth input[type=text],#auth input[type=password],textarea')
            .input()
            .bind('validationChanged.uiinput', function() {
                    validate_form();
                  });

    $form.show();
}

function validate_form()
{
    var $required   = $('.required');
    var isValid     = true;

    $required.each(function() {
        if (! $(this).hasClass('ui-state-valid'))
        {
            isValid = false;
            return false;
        }
    });

    if (isValid)
    {
        $submit.button('enable');
        $error.text('');
    }
    else
    {
        $submit.button('disable');
    }
}

<?php
$jQuery->javascriptCaptureEnd();

?>
<div id="auth">
 <div class="line"><!-- { -->
  <div class="legend unit"><!-- { -->
   <h1>Sign in</h1>
   <p>
    or <?= Connexions::anchor('/auth/register', 'Join now') ?>
   </p>
  </div><!-- legend } -->
  <div class="userInput unit"><!-- { -->
   <form method='post'>
    <div class='field'>
     <label for='user'>Username</label>
     <input type='text' class='text required'
            name='user' value='<?= $this->user ?>' />
    </div>
    <div class='field'>
     <label for='password' >Password</label>
     <input type='password' class='text required'
            name='password' />
    </div>
    <div class='field buttons'>
     <button name='submit'>Sign in</button>
    </div>
   </form>
 
   <? if ($this->welcome)   echo "Welcome!!<br />"; ?>
   <div class='error'>
    <?= (@isset($this->error) ? $this->error : '') ?>
   </div>
  </div><!-- userInput } -->
 </div><!-- line } -->
</div>
