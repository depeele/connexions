<?php

if ($this->owner !== '*')
    $this->headTitle($this->owner ."'s Bookmarks");
else
    $this->headTitle('Bookmarks')

?>
<p>Present the Bookmarks for <?= $this->owner ?>
                         to  <?= $this->viewer ?>
<?php   if (@empty($this->tags))
            printf (", NO tags.");
        else
            printf (" with tags '%s'", $this->tags);
?>
</p>

<?php
if ( @isset($this->userItems) )
{
    /* If $this->tags is NOT set, make use of the 'userItem' Model_UserItemSet
     * instance to retrieve the tags for these userItems (specifically, for the
     * unique items and unique users represented by these userItems).
     */
    if (! @isset($this->tags))
        $this->tags = new Model_TagSet( $this->userItems->userIds(),
                                        $this->userItems->itemIds() );
}

if ( @isset($this->tags))
{
    // The partial is faster than the  View Helper by about 0.01 seconds
    $time_start = microtime(true);
    if (false)
    {
    /* Use the Connexions_View_Helper_HtmlTagCloud class to render the tag
     * cloud for $this->tags.
     */
    $this->layout()->right = $this->htmlTagCloud();

    }
    else
    {
    /* Use the tagCloud.phtml partial to render the tag cloud associated with
     * the incoming userItems.
     */
    $this->layout()->right = $this->partial('tagCloud.phtml',
                                            array(
                                                'tags'      => &$this->tags,
                                                'maxTags'   => 50
                                            ));
    }

    $time_end   = microtime(true);
    $this->layout()->right .= sprintf ("%f seconds to render tag cloud<br />\n",
                                       $time_end - $time_start);
}

/* Present the pagination control, established by
 * Bootstrap.php::_initViewGlobal() to be rendered via:
 *      views/scripts/paginationControl.phtml
 */
echo $this->paginator;

if (count($this->paginator))
{
    // Present the items of the current page
    echo "<ul class='items'>\n";
    foreach ($this->paginator as $idex => $userItem)
    {
        /* Present the current item -- This should probably be via a view
         * partial like:
         *      view/scripts/userItem.phtml
         */
        //$userItem = new Model_UserItem($item);
        echo $this->partial('userItem.phtml',
                            array(
                                'index'    => $idex,
                                'userItem' => &$userItem
                            ));
    }
    echo "</ul>\n";
}

echo $this->paginator;

?>


<div class='error'><?= (@isset($this->error) ? $this->error : '') ?></div>
