(function(c){function a(){c.log=function(e){if((window.console!==undefined)&&c.isFunction(window.console.log)){var g=e;for(var f=1;f<arguments.length;f++){g=g.replace(/%s/,arguments[f])}window.console.log(g)}};c.log("Logging enabled")}if((window.console===undefined)||(!c.isFunction(window.console.log))){c(document).ready(a)}else{a()}if(c.browser.msie){try{document.execCommand("BackgroundImageCache",false,true)}catch(d){}}c.spawn=function(f,e){setTimeout(f,(e===undefined?0:e))};var b=0;c.jsonRpc=function(f,j,h,e){var g={version:f.version,id:b++,method:j,params:h};e=c.extend({},e,{url:f.target,type:f.transport,dataType:"json",data:JSON.stringify(g)});c.ajax(e)};c.validatePasswords=function(e,k,j){var g=k.val();var f=j.val();var h=true;if((g.length<1)||(f.length<1)){h=undefined;if(e[0]===k[0]){j.input("valid")}else{k.input("valid")}}else{if(g!==f){h="Passwords do not match.";if(e[0]===k[0]){j.input("valid",h);h=undefined}else{k.input("valid")}}else{if(e[0]===k[0]){j.input("valid",true)}else{k.input("valid",true)}}}return h};c.padString=function(g,f,e){f=f||2;e=e||"0";g=""+g;while(g.length<f){g=e+g}return g};c.esc=function(e){return c.htmlspecialchars(e)};c.summarize=function(g,f){if(f===undefined){f=40}var e=c.html_entity_decode(g,"ENT_QUOTES");if(e.length>f){e=e.substr(0,f);e=e.substr(0,e.lastIndexOf(" "));e=e.replace(/[\s\.\!\?:;\,\-]+$/,"");e+="..."}e=c.htmlentities(e,"ENT_QUOTES");return e};c.get_html_translation_table=function(n,l){var h={},k={},g=0,e="";var j={},f={};var o={},m={};j[0]="HTML_SPECIALCHARS";j[1]="HTML_ENTITIES";f[0]="ENT_NOQUOTES";f[2]="ENT_COMPAT";f[3]="ENT_QUOTES";o=(!isNaN(n)?j[n]:(n?n.toUpperCase():"HTML_SPECIALCHARS"));m=(!isNaN(l)?f[l]:(l?l.toUpperCase():"ENT_COMPAT"));if((o!=="HTML_SPECIALCHARS")&&(o!=="HTML_ENTITIES")){throw new Error("Table: "+o+" not supported")}h["38"]="&amp;";if(o==="HTML_ENTITIES"){h["160"]="&nbsp;";h["161"]="&iexcl;";h["162"]="&cent;";h["163"]="&pound;";h["164"]="&curren;";h["165"]="&yen;";h["166"]="&brvbar;";h["167"]="&sect;";h["168"]="&uml;";h["169"]="&copy;";h["170"]="&ordf;";h["171"]="&laquo;";h["172"]="&not;";h["173"]="&shy;";h["174"]="&reg;";h["175"]="&macr;";h["176"]="&deg;";h["177"]="&plusmn;";h["178"]="&sup2;";h["179"]="&sup3;";h["180"]="&acute;";h["181"]="&micro;";h["182"]="&para;";h["183"]="&middot;";h["184"]="&cedil;";h["185"]="&sup1;";h["186"]="&ordm;";h["187"]="&raquo;";h["188"]="&frac14;";h["189"]="&frac12;";h["190"]="&frac34;";h["191"]="&iquest;";h["192"]="&Agrave;";h["193"]="&Aacute;";h["194"]="&Acirc;";h["195"]="&Atilde;";h["196"]="&Auml;";h["197"]="&Aring;";h["198"]="&AElig;";h["199"]="&Ccedil;";h["200"]="&Egrave;";h["201"]="&Eacute;";h["202"]="&Ecirc;";h["203"]="&Euml;";h["204"]="&Igrave;";h["205"]="&Iacute;";h["206"]="&Icirc;";h["207"]="&Iuml;";h["208"]="&ETH;";h["209"]="&Ntilde;";h["210"]="&Ograve;";h["211"]="&Oacute;";h["212"]="&Ocirc;";h["213"]="&Otilde;";h["214"]="&Ouml;";h["215"]="&times;";h["216"]="&Oslash;";h["217"]="&Ugrave;";h["218"]="&Uacute;";h["219"]="&Ucirc;";h["220"]="&Uuml;";h["221"]="&Yacute;";h["222"]="&THORN;";h["223"]="&szlig;";h["224"]="&agrave;";h["225"]="&aacute;";h["226"]="&acirc;";h["227"]="&atilde;";h["228"]="&auml;";h["229"]="&aring;";h["230"]="&aelig;";h["231"]="&ccedil;";h["232"]="&egrave;";h["233"]="&eacute;";h["234"]="&ecirc;";h["235"]="&euml;";h["236"]="&igrave;";h["237"]="&iacute;";h["238"]="&icirc;";h["239"]="&iuml;";h["240"]="&eth;";h["241"]="&ntilde;";h["242"]="&ograve;";h["243"]="&oacute;";h["244"]="&ocirc;";h["245"]="&otilde;";h["246"]="&ouml;";h["247"]="&divide;";h["248"]="&oslash;";h["249"]="&ugrave;";h["250"]="&uacute;";h["251"]="&ucirc;";h["252"]="&uuml;";h["253"]="&yacute;";h["254"]="&thorn;";h["255"]="&yuml;"}if(m!=="ENT_NOQUOTES"){h["34"]="&quot;"}if(m==="ENT_QUOTES"){h["39"]="&#39;"}h["60"]="&lt;";h["62"]="&gt;";for(g in h){e=String.fromCharCode(g);k[e]=h[g]}return k};c.htmlentities=function(g,k){var j={},h="",e="",f="";e=g.toString();if(false===(j=c.get_html_translation_table("HTML_ENTITIES",k))){return false}j["'"]="&#039;";for(h in j){f=j[h];e=e.split(h).join(f)}return e};c.html_entity_decode=function(g,k){var j={},h="",e="",f="";e=g.toString();if(false===(j=c.get_html_translation_table("HTML_ENTITIES",k))){return false}delete (j["&"]);j["&"]="&amp;";for(h in j){f=j[h];e=e.split(f).join(h)}e=e.split("&#039;").join("'");return e};c.htmlspecialchars=function(g,m,l,f){var j=0,h=0,k=false;if(m===undefined||m===null){m=2}g=g.toString();if(f!==false){g=g.replace(/&/g,"&amp;")}g=g.replace(/</g,"&lt;").replace(/>/g,"&gt;");var e={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(m===0){k=true}if(typeof m!=="number"){m=[].concat(m);for(h=0;h<m.length;h++){if(e[m[h]]===0){k=true}else{if(e[m[h]]){j=j|e[m[h]]}}}m=j}if(m&e.ENT_HTML_QUOTE_SINGLE){g=g.replace(/'/g,"&#039;")}if(!k){g=g.replace(/"/g,"&quot;")}return g};c.htmlspecialchars_decode=function(f,k){var h=0,g=0,j=false;if(k===undefined){k=2}f=f.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var e={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(k===0){j=true}if(typeof k!=="number"){k=[].concat(k);for(g=0;g<k.length;g++){if(e[k[g]]===0){j=true}else{if(e[k[g]]){h=h|e[k[g]]}}}k=h}if(k&e.ENT_HTML_QUOTE_SINGLE){f=f.replace(/&#0*39;/g,"'")}if(!j){f=f.replace(/&quot;/g,'"')}f=f.replace(/&amp;/g,"&");return f};c.date2str=function(g,j){if((g===undefined)||(!g instanceof Date)){g=new Date()}var f="";if(j!==true){f=g.getFullYear()+"-"+c.padString((g.getMonth()+1))+"-"+c.padString(g.getDate())+" "}var e=g.getHours();var h="am";if(e===0){e=12}else{if(e===12){h="pm"}else{if(e>12){e-=12;h="pm"}}}f+=c.padString(e,2,"<span style='visibility:hidden;'>1</span>")+":"+c.padString(g.getMinutes())+" "+h;return f};c.str2date=function(j){j=""+j;var h=j.split(" ");var f=h[0].split("-");var g=h[1].split(":");var e=new Date();e.setUTCFullYear(f[0]);e.setUTCMonth(parseInt(f[1],10)-1);e.setUTCDate(f[2]);e.setUTCHours(g[0]);e.setUTCMinutes(g[1]);e.setUTCSeconds(g[2]);return e};c.fn.mask=function(){return this.each(function(){var h=c("#pageHeader h1 a img");var g=c(this);var j=g.css("z-index");if(j==="auto"){j=99999}else{j++}var e=c("<div></div>").addClass("ui-widget-overlay").appendTo(g).css({width:g.outerWidth(),height:g.outerHeight(),"z-index":j});if(h.length>0){var f=h.attr("src");h.attr("src",f.replace(".gif","-spinner.gif"))}if(c.fn.bgiframe){e.bgiframe()}})};c.fn.unmask=function(){return this.each(function(){var h=c("#pageHeader h1 a img");var g=c(this);var e=g.find(".ui-widget-overlay");e.remove();if(h.length>0){var f=h.attr("src");h.attr("src",f.replace("-spinner.gif",".gif"))}})}}(jQuery));(function(a){a.registry=function(b,c){if(c!==undefined){a.data(document,b,c)}else{return a.data(document,b)}}}(jQuery));jQuery.cookie=function(b,j,m){if(typeof j!=="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires==="number"||m.expires.toUTCString)){var f;if(typeof m.expires==="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}if(m.path===undefined){m.path=window.location.pathname}if(m.path){m.path=m.path.replace(/\/+$/,"")}if((m.secure===undefined)&&(window.location.protocol==="https")){m.secure=true}var l=m.path?"; path="+m.path:"";var g=m.domain?"; domain="+m.domain:"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!==""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)===(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};(function(a){jQuery.fn.pngFix=function(d){d=jQuery.extend({blankgif:"blank.gif"},d);var c=(navigator.appName==="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)===4&&navigator.appVersion.indexOf("MSIE 5.5")!==-1);var b=(navigator.appName==="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)===4&&navigator.appVersion.indexOf("MSIE 6.0")!==-1);if(jQuery.browser.msie&&(c||b)){jQuery(this).find("img[src$=.png]").each(function(){jQuery(this).attr("width",jQuery(this).width());jQuery(this).attr("height",jQuery(this).height());var m="";var g="";var f=(jQuery(this).attr("id"))?'id="'+jQuery(this).attr("id")+'" ':"";var n=(jQuery(this).attr("class"))?'class="'+jQuery(this).attr("class")+'" ':"";var j=(jQuery(this).attr("title"))?'title="'+jQuery(this).attr("title")+'" ':"";var k=(jQuery(this).attr("alt"))?'alt="'+jQuery(this).attr("alt")+'" ':"";var h=(jQuery(this).attr("align"))?"float:"+jQuery(this).attr("align")+";":"";var e=(jQuery(this).parent().attr("href"))?"cursor:hand;":"";if(this.style.border){m+="border:"+this.style.border+";";this.style.border=""}if(this.style.padding){m+="padding:"+this.style.padding+";";this.style.padding=""}if(this.style.margin){m+="margin:"+this.style.margin+";";this.style.margin=""}var l=(this.style.cssText);g+="<span "+f+n+j+k;g+='style="position:relative;white-space:pre-line;display:inline-block;background:transparent;'+h+e;g+="width:"+jQuery(this).width()+"px;height:"+jQuery(this).height()+"px;";g+="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+jQuery(this).attr("src")+"', sizingMethod='scale');";g+=l+'"></span>';if(m!==""){g='<span style="position:relative;display:inline-block;'+m+e+"width:"+jQuery(this).width()+"px;height:"+jQuery(this).height()+'px;">'+g+"</span>"}jQuery(this).hide();jQuery(this).after(g)});jQuery(this).find("*").each(function(){var f=jQuery(this).css("background-image");if(f.indexOf(".png")!==-1){var e=f.split('url("')[1].split('")')[0];jQuery(this).css("background-image","none");jQuery(this).get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"',sizingMethod='scale')"}});jQuery(this).find("input[src$=.png]").each(function(){var e=jQuery(this).attr("src");jQuery(this).get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale');";jQuery(this).attr("src",d.blankgif)})}return jQuery}}(jQuery));(function(a){a.widget("ui.checkbox",{version:"0.1.1",widgetEventPrefix:"",options:{css:"checkbox",cssOn:"on",cssOff:"off",titleOn:"click to turn off",titleOff:"click to turn on",useElTitle:true,hideLabel:false},_create:function(){var b=this;var d=this.options;d.enabled=b.element.attr("disabled")?false:true;d.checked=b.element.attr("checked")?true:false;d.title="";b.element.data("value.uicheckbox",d.checked);var c=b.element.attr("name");var f=b.element.attr("id");b.$label=false;if(f){b.$label=a("label[for="+f+"]")}if(((!b.$label)||(b.$label.length<1))&&c){b.$label=a("label[for="+c+"]")}if(d.useElTitle===true){d.title=b.element.attr("title");if(((!d.title)||(d.title.length<1))&&(b.$label.length>0)){d.title=b.$label.text()}}var e=d.title+(d.checked?d.titleOn:d.titleOff);b.$el=a('<span class="checkbox"><div class="'+d.css+(d.enabled?" ":" diabled ")+(d.checked?d.cssOn:d.cssOff)+'"'+(e&&e.length>0?' title="'+e+'"':"")+">&nbsp;</div></span>");b.img=b.$el.find("div");b.$el.insertAfter(b.element);b.element.hide();b.$value=a('<input type="hidden" '+(f?'id="'+f+'" ':"")+'name="'+c+'" />');b.$value.attr("value",d.checked);b.$value.insertBefore(b.$el);if(b.$label&&(b.$label.length>0)){if(d.hideLabel===true){b.$label.hide()}else{b.$label.click(function(g){g.preventDefault();g.stopPropagation();b.$el.trigger("click",[g]);return false})}}b._bindEvents()},_bindEvents:function(){var d=this;var c=function(h){if(d.options.enabled===true){d.$el.addClass("ui-state-hover")}};var g=function(h){d.$el.removeClass("ui-state-hover")};var f=function(h){if(d.options.enabled===true){d.$el.addClass("ui-state-focus")}};var e=function(h){d.$el.removeClass("ui-state-focus")};var b=function(h){d.toggle()};d.$el.bind("mouseenter.uicheckbox",c).bind("mouseleave.uicheckbox",g).bind("focus.uicheckbox",f).bind("blur.uicheckbox",e).bind("click.uicheckbox",b)},isChecked:function(){return this.options.checked},isEnabled:function(){return this.options.enabled},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.$el.removeClass("ui-state-disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.$el.addClass("ui-state-disabled");this._trigger("disabled")}},toggle:function(){if(this.options.checked){this.uncheck()}else{this.check()}},check:function(){if(!this.options.checked){this.options.checked=true;this.$value.attr("value",this.options.checked);this.img.removeClass(this.options.cssOff).addClass(this.options.cssOn).attr("title",this.options.title+this.options.titleOn);this._trigger("change",null,"check")}},uncheck:function(){if(this.options.checked){this.options.checked=false;this.$value.attr("value",this.options.checked);this.img.removeClass(this.options.cssOn).addClass(this.options.cssOff).attr("title",this.options.title+this.options.titleOff);this._trigger("change",null,"uncheck")}},reset:function(){if(this.element.data("value.uicheckbox")){this.check()}else{this.uncheck()}},hasChanged:function(){return(this.options.checked!==this.element.data("value.uicheckbox"))},destroy:function(){if(this.$label){this.$label.show()}this.$el.unbind(".uicheckbox");this.$value.remove();this.$el.remove();this.element.show()}})}(jQuery));(function(a){a.widget("ui.input",{version:"0.1.1",widgetEventPrefix:"",options:{priority:"normal",$label:null,hideLabel:true,$validation:null,validation:null},_create:function(){var b=this;var c=this.options;b.saved(true);c.enabled=b.element.attr("disabled")?false:true;if(c.$validation){if(c.$validation.jquery===undefined){c.$validation=a(c.$validation)}}else{c.$validation=b.element.parent().find(".ui-field-status:first")}if((!c.validation)&&(b.element.hasClass("required"))){c.validation="!empty"}b.element.addClass("ui-input ui-corner-all ");b.keyTimer=null;if(c.priority==="primary"){b.element.addClass("ui-priority-primary")}else{if(c.priority==="secondary"){b.element.addClass("ui-priority-secondary")}}b.element.addClass("ui-state-default");if(!c.enabled){b.element.addClass("ui-state-disabled")}var d=b.element.attr("id");if((d===undefined)||(d.length<1)){d=b.element.attr("name")}if((d!==undefined)&&(d.length>0)){c.$label=b.element.parent().find("label[for="+d+"]")}else{c.$label=b.element.closest("label")}if(c.hideLabel===true){c.$label.addClass("ui-input-over").hide()}else{c.$label.addClass("ui-input-over").show()}b._bindEvents()},_bindEvents:function(){var d=this;var e=d.options;var c=function(j){if(d.options.enabled===true){d.element.addClass("ui-state-hover")}};var h=function(k){var j=a(this);j.removeClass("ui-state-hover")};var b=function(j){if(d.options.enabled!==true){return}if(d.keyTimer!==null){clearTimeout(d.keyTimer)}if(j.keyCode===9){return}d.valid(undefined);d.keyTimer=setTimeout(function(){d.validate()},1000)};var g=function(j){if(d.options.enabled===true){if(e.hideLabel===true){e.$label.hide()}d.element.removeClass("ui-state-empty").addClass("ui-state-focus ui-state-active")}};var f=function(j){d._blur()};d.element.bind("mouseenter.uiinput",c).bind("mouseleave.uiinput",h).bind("keydown.uiinput",b).bind("focus.uiinput",g).bind("blur.uiinput",f);e.$label.bind("click.uiinput",function(){d.element.focus()});if(d.val()!==""){d.validate()}else{if(e.hideLabel===true){e.$label.show()}}},_blur:function(){var b=this;var c=b.options;b.element.removeClass("ui-state-focus ui-state-active");if(!b.element.hasClass("ui-state-valid")){b.validate()}if(b.val()===""){b.element.addClass("ui-state-empty");if(c.hideLabel===true){c.$label.show()}}else{if(c.hideLabel===true){c.$label.hide()}b.element.removeClass("ui-state-empty")}},isEnabled:function(){return this.options.enabled},isValid:function(){return this.options.valid},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.element.removeClass("ui-state-disabled").removeAttr("disabled");this.options.$label.removeClass("ui-state-disabled").removeAttr("disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.element.attr("disabled",true).addClass("ui-state-disabled");this.options.$label.attr("disabled",true).addClass("ui-state-disabled");this._trigger("disabled")}},reset:function(){this.val(this.element.data("value.uiinput"));this.element.removeClass("ui-state-error ui-state-valid ui-state-changed");this._blur();this.element.removeClass("ui-state-error ui-state-valid ui-state-changed")},hasChanged:function(){return(this.val()!==this.element.data("value.uiinput"))},valid:function(b){if(b===this.options.valid){return}this.element.removeClass("ui-state-error ui-state-valid ui-state-changed");this.options.$validation.html("&nbsp;").removeClass("ui-state-invalid ui-state-valid");if(b===true){this.element.addClass("ui-state-valid");this.options.$validation.addClass("ui-state-valid")}else{if(b!==undefined){this.element.addClass("ui-state-error");this.options.$validation.addClass("ui-state-invalid");if(typeof b==="string"){this.options.$validation.html(b)}}}if(this.hasChanged()){this.element.addClass("ui-state-changed")}this.options.valid=b;if(b!==undefined){this._trigger("validation_change",null,[b])}},getLabel:function(){return this.options.$label.text()},setLabel:function(b){this.options.$label.text(b)},getOrigValue:function(){return this.element.data("value.uiinput")},saved:function(b){this.element.data("value.uiinput",this.val());if(b!==true){this.options.valid=undefined;this.validate()}},val:function(c){if(c!==undefined){c=a.trim(c);this.element.removeClass("ui-state-valid");delete this.options.valid;var b=this.element.val(c);this._blur();return b}return a.trim(this.element.val())},validate:function(){var d=[];var c;if(this.options.validation===null){this.valid(true);return}if(a.isFunction(this.options.validation)){var b=this.options.validation.apply(this.element,[this.val()]);if(typeof b==="string"){c=false;d.push(b)}else{c=b}}else{if(this.options.validation==="!empty"){c=((this.val().length>0)?true:false);if(!c){d.push("Cannot be empty")}}}this.valid(((c===false)&&(d.length>0)?d.join("<br />"):c))},destroy:function(){this.options.$validation.removeClass("ui-state-valid ui-state-invalid ");this.options.$label.unbind(".uiinput");this.element.removeClass("ui-state-default ui-state-disabled ui-state-hover ui-state-valid ui-state-error ui-state-focus ui-state-active ui-priority-primary ui-priority-secondary ").unbind(".uiinput").removeData(".uiinput")}})}(jQuery));
/*
 * jQuery UI Stars v2.1.1
 * http://plugins.jquery.com/project/Star_Rating_widget
 *
 * Copyright (c) 2009 Orkan (orkans@gmail.com)
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * $Rev: 114 $
 * $Date:: 2009-06-12 #$
 * $Build: 32 (2009-06-12)
 *
 * Take control of pre-assembled HTML:
 *  <div >
 *    <input class='ui-stars-rating' type='hidden' name='rating' value='...' />
 *    <div class='ui-stars ui-stars-cancel ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    ...
 *  </div>
 *
 * Depends:
 *      ui.core.js
 *      ui.widget.js
 *
 */
(function(a){a.widget("ui.stars",{version:"2.1.1b",widgetEventPrefix:"",options:{inputType:"div",split:0,disabled:false,cancelTitle:"Cancel Rating",cancelValue:0,cancelShow:true,oneVoteOnly:false,showTitles:false,captionEl:null,callback:null,starWidth:16,baseClass:"ui-stars",cancelClass:"ui-stars-cancel",starClass:"ui-stars-star",starOnClass:"ui-stars-star-on",starHoverClass:"ui-stars-star-hover",starDisabledClass:"ui-stars-star-disabled",cancelHoverClass:"ui-stars-cancel-hover",cancelDisabledClass:"ui-stars-cancel-disabled"},_create:function(){var b=this,e=this.options,f=0;this.$stars=a("."+e.starClass,this.element);this.$cancel=a("."+e.cancelClass,this.element);this.$input=a("input[type=hidden]:first",this.element);e.items=this.$stars.filter("."+e.starClass).length;e.value=this.$stars.filter("."+e.starOnClass).length;if(e.value>0){e.checked=e.defaultValue=e.value}else{e.value=e.defaultValue=e.cancelValue}if(e.disabled){this.$cancel.addClass(e.cancelDisabledClass)}e.cancelShow&=!e.oneVoteOnly;function d(){b.$stars.removeClass(e.starOnClass+" "+e.starHoverClass);b._showCap("")}function c(g,j){if(g>=0){var k=j?e.starHoverClass:e.starOnClass;var h=j?e.starOnClass:e.starHoverClass;b.$stars.eq(g).removeClass(h).addClass(k).prevAll("."+e.starClass).removeClass(h).addClass(k);b.$stars.eq(g).nextAll("."+e.starClass).removeClass(e.starHoverClass+" "+e.starOnClass);b._showCap(b.$stars.eq(g).find("a").attr("title"))}else{d()}}this.$stars.bind("click.stars",function(h){if(!e.forceSelect&&e.disabled){return false}var g=b.$stars.index(this);e.checked=g;e.value=g+1;e.title=a(this).find("a").attr("title");b.$input.val(e.value);c(e.checked,false);b._disableCancel();if(!e.forceSelect){b.callback(h,"star")}b._trigger("change",null,e.value)}).bind("mouseover.stars",function(){if(e.disabled){return false}var g=b.$stars.index(this);c(g,true)}).bind("mouseout.stars",function(){if(e.disabled){return false}c(e.checked,false)});this.$cancel.bind("click.stars",function(g){if(!e.forceSelect&&(e.disabled||e.value===e.cancelValue)){return false}e.checked=-1;e.value=e.cancelValue;b.$input.val(e.cancelValue);d();b._disableCancel();if(!e.forceSelect){b.callback(g,"cancel")}b._trigger("change",null,e.value)}).bind("mouseover.stars",function(){if(b._disableCancel()){return false}b.$cancel.addClass(e.cancelHoverClass);d();b._showCap(e.cancelTitle)}).bind("mouseout.stars",function(){if(b._disableCancel()){return false}b.$cancel.removeClass(e.cancelHoverClass);b.$stars.triggerHandler("mouseout.stars")});a(window).unload(function(){b.$cancel.unbind(".stars");b.$stars.unbind(".stars");b.$stars=b.$cancel=null});this.select(e.value);if(e.disabled){this.disable()}},_disableCancel:function(){var c=this.options,b=c.disabled||c.oneVoteOnly||(c.value===c.cancelValue);if(b){this.$cancel.removeClass(c.cancelHoverClass).addClass(c.cancelDisabledClass)}else{this.$cancel.removeClass(c.cancelDisabledClass)}this.$cancel.css("opacity",b?0.5:1);return b},_disableAll:function(){var b=this.options;this._disableCancel();if(b.disabled){this.$stars.filter("div").addClass(b.starDisabledClass)}else{this.$stars.filter("div").removeClass(b.starDisabledClass)}},_showCap:function(b){var c=this.options;if(c.captionEl){c.captionEl.text(b)}},value:function(){return this.options.value},select:function(d){var c=this.options,b=(d===c.cancelValue)?this.$cancel:this.$stars.eq(d-1);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},selectID:function(d){var c=this.options,b=(d===-1)?this.$cancel:this.$stars.eq(d);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},enable:function(){this.options.disabled=false;this._disableAll()},disable:function(){this.options.disabled=true;this._disableAll()},hasChanged:function(){return(this.options.value!==this.options.defaultValue)},reset:function(){this.select(this.options.defaultValue)},destroy:function(){this.$cancel.unbind(".stars");this.$stars.unbind(".stars");this.element.unbind(".stars").removeData("stars")},callback:function(c,b){var d=this.options;if(d.callback){d.callback(this,b,d.value,c)}if(d.oneVoteOnly&&!d.disabled){this.disable()}}})}(jQuery));(function(a){a.widget("ui.notify",{options:{speed:500,expires:5000,stack:"below"},_create:function(){var b=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message").each(function(d){var c=this.id||d;b.keys.push(c);b.templates[c]=a(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty()},create:function(b,d,c){if(typeof b==="object"){c=d;d=b;b=null}return new a.ui.notify.instance(this)._create(d,a.extend({},this.options,c),this.templates[b||this.keys[0]])}});a.extend(a.ui.notify,{instance:function(b){this.parent=b;this.isOpen=false}});a.extend(a.ui.notify.instance.prototype,{_create:function(h,e,g){this.options=e;var d=this,f=g.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(j,k){return(k in h)?h[k]:""}),c=(this.element=a(f)),b=c.find("a.ui-notify-close");if(this._trigger("beforeopen")===false){return}if(typeof this.options.click==="function"){c.addClass("ui-notify-click").bind("click",function(j){d._trigger("click",j,d)})}if(b.length&&!!e.expires){b.remove()}else{if(b.length){b.bind("click",function(){d.close();return false})}}this.open();if(typeof e.expires==="number"){window.setTimeout(function(){d.close()},e.expires)}return this},close:function(){var b=this,c=this.options.speed;this.isOpen=false;this.element.fadeTo(c,0).slideUp(c,function(){b._trigger("close")});return this},open:function(){if(this.isOpen){return this}var b=this;this.isOpen=true;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.parent.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){b._trigger("open")});return this},widget:function(){return this.element},_trigger:function(c,d,b){return this.parent._trigger.call(this,c,d,b)}})}(jQuery));(function(a){a.widget("ui.confirmation",{version:"0.0.1",widgetEventPrefix:"",options:{question:"Really?",answers:{confirm:"Yes",cancel:"No"},primary:"cancel",position:{my:"center middle",at:"center middle"},confirmed:function(){},canceled:function(){},closed:function(){}},_init:function(){var b=this;var d=b.options;if(d.position.of===undefined){d.position.of=b.element}var e=0;b.element.parents().each(function(){if((!this)||(this.length<1)){return}var f=parseInt(a(this).css("z-index"),10);if(f>e){e=f}});var c='<div class="ui-confirmation">'+d.question+'<br /><button name="yes" class="'+(d.primary==="confirm"?"ui-priority-primary":"ui-priority-secondary")+'">'+d.answers.confirm+'</button><button name="no" class="'+(d.primary!=="confirm"?' class="ui-priority-primary"':"ui-priority-secondary")+'">'+d.answers.cancel+"</button></div>";d.$dialog=a(c).css({position:"absolute","z-index":e+1}).appendTo("body").position(d.position);b.element.attr("disabled",true);d.$confirm=d.$dialog.find("button[name=yes]");d.$cancel=d.$dialog.find("button[name=no]");b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;c.$confirm.bind("click.confirmation",function(d){b._trigger("confirmed");c.$dialog.remove();b._trigger("closed");b.destroy()});c.$cancel.bind("click.confirmation",function(){b._trigger("canceled");c.$dialog.remove();b._trigger("closed");b.destroy()});a(document).bind("keydown.confirmation",function(d){switch(d.keyCode){case 13:switch(c.primary){case"confirm":c.$confirm.click();break;case"cancel":default:c.$cancel.click();break}break;case 27:c.$cancel.click();break}})},destroy:function(){var b=this;var c=b.options;c.$confirm.unbind(".confirmation");c.$cancel.unbind(".confirmation");a(document).unbind(".confirmation");c.$dialog.remove()}})}(jQuery));(function(a){a.widget("ui.validationForm",{version:"0.1.1",widgetEventPrefix:"",options:{submitSelector:"button[name=submit]",hideLabels:true,disableSubmitOnUnchanged:true,$status:null},_init:function(){var b=this;var c=this.options;b.element.addClass("ui-form");if(!a.isFunction(c.validate)){c.validate=function(){return b._validate()}}c.enabled=b.element.attr("disabled")?false:true;if(c.$status){if(c.$status.jquery===undefined){c.$status=a(c.$status)}}else{c.$status=b.element.parent().find(".ui-form-status:first")}c.$required=b.element.find(".required");c.$inputs=b.element.find("input[type=text],input[type=password],textarea");if(c.$submit===undefined){c.$submit=b.element.find(c.submitSelector)}c.$cancel=b.element.find("button[name=cancel]");c.$reset=b.element.find("button[name=reset]");c.$inputs.input({hideLabel:c.hideLabels});c.$submit.button({priority:"primary",enabled:false});c.$cancel.button({priority:"secondary"});c.$reset.button({priority:"secondary"});b._bindEvents();b.validate()},_bindEvents:function(){var c=this;var d=c.options;var e=function(f){c.validate()};var b=function(f){f.preventDefault();f.stopPropagation();c.reset()};d.$inputs.bind("validation_change.uivalidationform",e);d.$reset.bind("click.uivalidationform",b)},_validate:function(){var b=this;var c=b.options;var d=true;c.$required.each(function(){if(!a(this).hasClass("ui-state-valid")){d=false;return false}});return d},isEnabled:function(){return this.options.enabled},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.element.removeClass("ui-state-disabled").removeAttr("disabled");this.options.$label.removeClass("ui-state-disabled").removeAttr("disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.element.attr("disabled",true).addClass("ui-state-disabled");this.options.$label.attr("disabled",true).addClass("ui-state-disabled");this._trigger("disabled")}},reset:function(){var b=this;var c=this.options;c.$inputs.input("reset");b.validate()},saved:function(){this.options.$inputs.input("saved");this.validate()},hasChanged:function(){var b=this;var d=this.options;var c=false;d.$inputs.each(function(){if(a(this).input("hasChanged")){c=true;return false}});return c},rebind:function(){var b=this;var c=b.options;c.$required=b.element.find(".required");c.$inputs=b.element.find("input[type=text],input[type=password],textarea");c.$inputs.unbind(".uivalidationform");b._bindEvents()},validate:function(){var b=this;var c=b.options;var d=b._trigger("validate");if(d){c.$status.removeClass("error").addClass("success").text("")}else{c.$status.removeClass("success").addClass("error")}if(d&&((c.disableSubmitOnUnchanged===false)||b.hasChanged())){c.$submit.button("enable")}else{c.$submit.button("disable")}},destroy:function(){var b=this;var c=b.options;b.element.unbind(".uivalidationform");c.$inputs.unbind(".uivalidationform");c.$submit.unbind(".uivalidationform");c.$cancel.unbind(".uivalidationform");c.$reset.unbind(".uivalidationform");c.$inputs.input("destroy");c.$submit.button("destroy");c.$cancel.button("destroy");c.$reset.button("destroy");b.element.removeClass("ui-form")}})}(jQuery));(function(a){a.widget("connexions.tabs",a.ui.tabs,{version:"0.0.1",options:{panelId:null,loadUrl:null},load:function(e){e=this._getIndex(e);var c=this,h=this.options,g=this.anchors.eq(e),b=g[0],d=g.data("load.tabs");this.abort();if(!d||this.element.queue("tabs").length!==0&&g.data("cache.tabs")){this.element.dequeue("tabs");return}this.lis.eq(e).addClass("ui-state-processing");if(h.spinner){var f=a("span",b);f.data("label.tabs",f.html()).html(h.spinner)}this.xhr=a.ajax(a.extend({},h.ajaxOptions,{url:d,beforeSend:function(j,k){if(a.isFunction(h.ajaxOptions.beforeSend)){h.ajaxOptions.beforeSend.call(c.element,j,k)}},complete:function(j,k){if(a.isFunction(h.ajaxOptions.complete)){h.ajaxOptions.complete.call(c.element,j,k)}},success:function(k,j){c._getPanel(g).html(k);c._cleanup();if(h.cache){g.data("cache.tabs",true)}c._trigger("load",null,c._ui(c.anchors[e],c.panels[e]));if(a.isFunction(h.ajaxOptions.success)){h.ajaxOptions.success.call(c.element,k,j)}},error:function(l,j,k){c._cleanup();c._trigger("load",null,c._ui(c.anchors[e],c.panels[e]));if(a.isFunction(h.ajaxOptions.error)){h.ajaxOptions.error.call(c.element,l,j,e,b)}}}));c.element.dequeue("tabs");return this},_getPanel:function(b){return this.element.find(this._sanitizeSelector(b.data("panel.tabs")))},_getPanelByIndex:function(b){return this.element.find(this._sanitizeSelector(a.data(this.anchors[b],"panel.tabs")))},_tabify:function(n){var p=this,d=this.options,c=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=a(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return a("a",this)[0]});this.panels=a([]);this.anchors.each(function(u,w){var s=a(w);var o=s.attr("href");var t=s.data("panel.tabs");if(t===undefined){var v=o.split("#")[0],x;if(v&&(v===location.toString().split("#")[0]||(x=a("base")[0])&&v===x.href)){o=w.hash;w.href=o}}else{s.data("href.tabs",o);o=t}if(c.test(o)){s.data("panel.tabs",o);s.data("cache.tabs",o);p.panels=p.panels.add(p._getPanel(s))}else{if(o&&o!=="#"){s.data("href.tabs",o);s.data("load.tabs",o.replace(/#.*$/,""));var r=p._tabId(w);w.href="#"+r;s.data("panel.tabs","#"+r);var y=p.element.find("#"+r);if(!y.length){y=a(d.panelTemplate).attr("id",r).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(p.panels[u-1]||p.list);y.data("destroy.tabs",true)}p.panels=p.panels.add(y)}else{d.disabled.push(u)}}});if(n){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(d.selected===undefined){if(location.hash){this.anchors.each(function(r,o){if(o.hash==location.hash){d.selected=r;return false}})}if(typeof d.selected!=="number"&&d.cookie){d.selected=parseInt(p._cookie(),10)}if(typeof d.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length){d.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}d.selected=d.selected||(this.lis.length?0:-1)}else{if(d.selected===null){d.selected=-1}}d.selected=((d.selected>=0&&this.anchors[d.selected])||d.selected<0)?d.selected:0;d.disabled=a.unique(d.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(r,o){return p.lis.index(r)}))).sort();if(a.inArray(d.selected,d.disabled)!=-1){d.disabled.splice(a.inArray(d.selected,d.disabled),1)}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(d.selected>=0&&this.anchors.length){var q=p._getPanelByIndex(d.selected);q.removeClass("ui-tabs-hide");this.lis.eq(d.selected).addClass("ui-tabs-selected ui-state-active");p.element.queue("tabs",function(){p._trigger("show",null,p._ui(p.anchors[d.selected],q[0]))});this.load(d.selected)}a(window).bind("unload",function(){p.lis.add(p.anchors).unbind(".tabs");p.lis=p.anchors=p.panels=null})}else{d.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[d.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(d.cookie){this._cookie(d.selected,d.cookie)}for(var g=0,m;(m=this.lis[g]);g++){a(m)[a.inArray(g,d.disabled)!=-1&&!a(m).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}if(d.cache===false){this.anchors.removeData("cache.tabs")}this.lis.add(this.anchors).unbind(".tabs");if(d.event!=="mouseover"){var f=function(r,o){if(o.is(":not(.ui-state-disabled)")){o.addClass("ui-state-"+r)}};var j=function(r,o){o.removeClass("ui-state-"+r)};this.lis.bind("mouseover.tabs",function(){f("hover",a(this))});this.lis.bind("mouseout.tabs",function(){j("hover",a(this))});this.anchors.bind("focus.tabs",function(){f("focus",a(this).closest("li"))});this.anchors.bind("blur.tabs",function(){j("focus",a(this).closest("li"))})}var b,h;if(d.fx){if(a.isArray(d.fx)){b=d.fx[0];h=d.fx[1]}else{b=h=d.fx}}function e(o,r){o.css("display","");if(!a.support.opacity&&r.opacity){o[0].style.removeAttribute("filter")}}var k=h?function(o,r){a(o).closest("li").addClass("ui-tabs-selected ui-state-active");r.hide().removeClass("ui-tabs-hide").animate(h,h.duration||"normal",function(){e(r,h);p._trigger("show",null,p._ui(o,r[0]))})}:function(o,r){a(o).closest("li").addClass("ui-tabs-selected ui-state-active");r.removeClass("ui-tabs-hide");p._trigger("show",null,p._ui(o,r[0]))};var l=b?function(r,o){o.animate(b,b.duration||"normal",function(){p.lis.removeClass("ui-tabs-selected ui-state-active");o.addClass("ui-tabs-hide");e(o,b);p.element.dequeue("tabs")})}:function(r,o,s){p.lis.removeClass("ui-tabs-selected ui-state-active");o.addClass("ui-tabs-hide");p.element.dequeue("tabs")};this.anchors.bind(d.event+".tabs",function(){var s=this,r=a(s),u=r.closest("li"),o=p.panels.filter(":not(.ui-tabs-hide)"),t=p._getPanel(r);if((u.hasClass("ui-tabs-selected")&&!d.collapsible)||u.hasClass("ui-state-disabled")||u.hasClass("ui-state-processing")||p.panels.filter(":animated").length||p._trigger("select",null,p._ui(this,t[0]))===false){this.blur();return false}d.selected=p.anchors.index(this);p.abort();if(d.collapsible){if(u.hasClass("ui-tabs-selected")){d.selected=-1;if(d.cookie){p._cookie(d.selected,d.cookie)}p.element.queue("tabs",function(){l(s,o)}).dequeue("tabs");this.blur();return false}else{if(!o.length){if(d.cookie){p._cookie(d.selected,d.cookie)}p.element.queue("tabs",function(){k(s,t)});p.load(p.anchors.index(this));this.blur();return false}}}if(d.cookie){p._cookie(d.selected,d.cookie)}if(t.length){if(o.length){p.element.queue("tabs",function(){l(s,o)})}p.element.queue("tabs",function(){k(s,t)});p.load(p.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}if(a.browser.msie){this.blur()}});this.anchors.bind("click.tabs",function(){return false})}})}(jQuery));(function(b){var a=0;b.widget("connexions.collapsable",{version:"0.0.1",options:{cache:true,ajaxOptions:null,cookie:null,idPrefix:"connexions-collapsable-",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"},_init:function(){var d=this;var f=d.options;d.$toggle=d.element.find(".toggle:first");d.$a=d.$toggle.find("a:first");if(d.$a.length>0){var c=d.$a.attr("href");if(!c.match(/^#.+/)){d.$a.data("href.collapsable",c);var e=d.$a.data("load.collapsable");if(e===undefined){d.$a.data("load.collapsable",c.replace(/#.*$/,""))}var g=d.$a.data("cache.collapsable");if(g===undefined){g=d.$a.data("content.collapsable")}if(g===undefined){g=((d.$a.title&&d.$a.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,""))||f.idPrefix+(++a));d.$a.attr("href","#"+g)}d.$content=b("#"+g);if(d.$content.length<1){d.$content=b(f.panelTemplate).attr("id",g).addClass("ui-corner-bottom").insertAfter(d.$toggle);d.$content.data("destroy.collapsable",true)}d.$content.addClass("content")}}else{d.$content=d.$toggle.next();d.$content.addClass("ui-corner-bottom")}d.$toggle.addClass("ui-corner-top");d.$toggle.prepend('<div class="ui-icon">&nbsp;</div>');d.$indicator=d.$toggle.find(".ui-icon:first");if(d.$toggle.hasClass("collapsed")){d.$indicator.addClass("ui-icon-triangle-1-e");d.$content.hide()}else{d.$indicator.addClass("ui-icon-triangle-1-s");d.$content.show();if(!d.$toggle.hasClass("expanded")){d.$toggle.addClass("expanded")}d._load()}d._bindEvents()},_bindEvents:function(){var c=this;c.$toggle.bind("click.collapsable",function(d){d.preventDefault();if(c.$content.is(":hidden")){c.$toggle.removeClass("collapsed").addClass("expanded");c.$indicator.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s");c.$content.slideDown();c.element.trigger("expand");c._load()}else{c.$toggle.removeClass("expanded").addClass("collapsed");c.$indicator.removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e");c.$content.slideUp();c.element.trigger("collapse")}c.element.trigger("toggle")})},_load:function(){var c=this;var e=c.options;var d=c.$a.data("load.collapsable");c._abort();if((!d)||c.$a.data("cache.collapsable")){return}b.log("connexions.collapsable: load url[ "+d+" ]");c.xhr=b.ajax(b.extend({},e.ajaxOptions,{url:d,beforeSend:function(g,h){c.element.addClass("ui-state-processing");if(e.spinner){var f=c.$a.find("span:first");f.data("label.collapsable",f.html()).html(e.spinner)}if(e.ajaxOptions&&b.isFunction(e.ajaxOptions.beforeSend)){e.ajaxOptions.beforeSend.call(c.element,g,h)}},complete:function(g,h){if(e.ajaxOptions&&b.isFunction(e.ajaxOptions.complete)){e.ajaxOptions.complete.call(c.element,g,h)}if(e.spinner){var f=c.$a.find("span:first");f.html(f.data("label.collapsable")).removeData("label.collapsable")}c.element.removeClass("ui-state-processing")},success:function(f,g){c.$content.html(f);if(e.cache){c.$a.data("cache.collapsable",true)}c._trigger("load",null,c.element);try{e.ajaxOptions.success(f,g)}catch(h){}},error:function(j,f,g){c.$content.html("<div class='error'>Cannot load: "+j.statusText+"</div>");c._trigger("load",null,c.element);try{e.ajaxOptions.error(j,f,c.element,c.$a)}catch(h){}}}));return this},_abort:function(){var c=this;if(c.xhr){c.xhr.abort();delete c.xhr}return c},destroy:function(){var d=this;var e=d.options;var c=d.$a.data("href.collapsable");if(c){d.$a.attr("href",c)}b.each(["href","load","cache"],function(f,g){d.$a.removeData(g+".collapsable")});if(d.$content.data("destroy.collapsable")){d.$content.remove()}else{d.$content.removeClass("ui-corner-bottom content")}d.$toggle.removeClass("ui-corner-top");d.$toggle.removeClass("collapsed,expanded");d.$toggle.unbind(".collapsable");d.$content.show()}})}(jQuery));(function(a){a.widget("connexions.dropdownForm",{version:"0.1.1",widgetEventPrefix:"",options:{namespace:null,form:null,groups:null},_init:function(){var b=this;var c=b.options;b.$form=b.element.find("form:first");b.$reset=b.element.find(":reset");b.$submit=b.element.find(":submit");b.$control=a("<div class='control'><button>Display Options</button></div>");b.$control.prependTo(b.element);b.$button=b.$control.find("button");b.$button.button({icons:{secondary:"ui-icon-triangle-1-s"}});b.$control.fadeTo(100,0.5);b.element.find(".ui-optionGroups").optionGroups({namespace:c.namespace,form:b.$form});b.$form.hide();b._bindEvents()},_bindEvents:function(){var m=this;var b=m.options;var e=function(n){if(m.$form.is(":visible")&&(!a.contains(m.element[0],n.target))){m.$control.triggerHandler("click");m.$control.trigger("mouseleave",n)}};var k=function(n){m.$control.fadeTo(100,1)};var c=function(n){if((n&&n.type==="mouseleave")&&m.$form.is(":visible")){return}m.$control.fadeTo(100,0.5)};var g=function(n){m.$form.toggle();m.$button.toggleClass("ui-state-active")};var j=function(n){n.preventDefault()};var d=function(n){m.$submit.removeClass("ui-state-disabled").removeAttr("disabled").addClass("ui-state-default")};var f=function(q){var p=m.$form.serializeArray();var n={};var o=a.registry("cookiePath");if(o){n.path=o}a(p).each(function(){a.log("connexions.dropdownForm: Delete Cookie: name[%s]",this.name);a.cookie(this.name,null,n)});if(!m._trigger("apply",q)){q.stopImmediatePropagation();q.preventDefault();q.stopPropagation();return false}};var l=function(q){var p=m.$form.serializeArray();var n={};var o=a.registry("cookiePath");if(o){n.path=o}a(p).each(function(){a.cookie(this.name,this.value,n)});if(!m._trigger("apply",q)){q.stopImmediatePropagation();q.preventDefault();q.stopPropagation();return false}};var h=function(n){n.preventDefault();m.$form.trigger("submit")};a("body").bind("click.uidropdownform",e);m.$control.bind("mouseenter.uidroppdownform",k).bind("mouseleave.uidroppdownform",c).bind("click.uidropdownform",g);m.$form.bind("change.uidropdownform",d).bind("submit.uidropdownform",l);m.$submit.bind("click.uidropdownform",h);m.$reset.bind("click.uidropdownform",f)},getGroup:function(){return this.element.find(".displayStyle").optionGroups("getGroup")},setGroup:function(b){return this.element.find(".displayStyle").optionGroups("setGroup",b)},getGroupInfo:function(){return this.element.find(".displayStyle").optionGroups("getGroupInfo")},setApplyCb:function(b){this.options.apply=b},open:function(){if(this.element.find("form:first").is(":visible")){return}this.element.find(".control:first").click()},close:function(){if(!this.element.find("form:first").is(":visible")){return}this.element.find(".control:first").click()},enable:function(b){var c=this;c.$form.find("input,select").removeAttr("disabled");if(b!==true){c.$submit.removeClass("ui-state-default ui-state-highlight").addClass("ui-state-disabled").attr("disabled",true)}else{c.$submit.removeClass("ui-state-disabled").removeAttr("disabled").addClass("ui-state-default")}},disable:function(){var b=this;b.$form.find("input,select").attr("disabled",true);b.$submit.removeClass("ui-state-default ui-state-highlight").addClass("ui-state-disabled").attr("disabled",true)},destroy:function(){var b=this;a("body").unbind(".uidropdownform");b.$control.unbind(".uidropdownform");b.$control.find("a:first, .ui-icon:first").unbind(".uidropdownform");b.$form.unbind(".uidropdownform");b.$submit.unbind(".uidropdownform");b.$reset.unbind(".uidropdownform");b.$button.button("destroy");b.$control.remove();b.element.find(".displayStyle").optionGroups("destroy")}})}(jQuery));(function(a){a.widget("connexions.optionGroups",{version:"0.1.1",options:{namespace:null,form:null},_create:function(){var b=this;var g=this.options;if(g.namespace===null){var e=b.element.data("namespace");if(e!==undefined){g.namespace=e}else{var d=b.element.attr("class");e=d.replace(/^(?:.* )?(.*?)OptionGroups(?: .*)?$/,"$1");if((e!==undefined)&&(e.length>0)){g.namespace=e}}}if(g.form===null){var f=b.element.data("form");if(f!==undefined){g.form=f}else{g.form=b.element.closest("form")}}var c=b.element.find("ul.groups");c.find("li").removeClass("ui-state-active").addClass("ui-state-default").filter(":first").addClass("ui-corner-left").end().find(":radio").hide();c.find(":checked").parent().addClass("ui-state-active");c.find("li.isCustom").addClass("control").button({icons:{secondary:"ui-icon-triangle-1-s"}}).removeClass("ui-corner-all").addClass("ui-corner-right");b._bindEvents()},_bindEvents:function(){var l=this;var b=this.options;var h=l.element.find("ul.groups");var g=l.element.find("fieldset:first");var c=h.find(".control:first");var f=function(m){m.preventDefault()};var j=function(m){m.preventDefault();m.stopPropagation();l.toggleFieldset()};var d=function(n){n.preventDefault();n.stopPropagation();var m=c.find(":radio");l.setGroup(m.val());return false};var e=function(n){n.preventDefault();n.stopPropagation();var m=a(this).find(":radio");l.setGroup(m.val())};var k=function(o){var m={};var n=a.registry("cookiePath");if(n){m.path=n}g.find(":checkbox").each(function(){a.cookie(a(this).attr("name"),null,m)});if(!h.find("li.ui-state-active").hasClass("isCustom")){g.find(":checkbox").attr("disabled",true)}};c.bind("click.uioptiongroups",j);g.bind("change.uioptiongroups",d);h.find("li:not(.control)").bind("change.uioptiongroups",e).bind("click.uioptiongroups",e);b.form.bind("submit.uioptiongroups",k)},getGroup:function(){return this.element.find("ul.groups :checked").val()},setGroup:function(h){var k=this;var f=k.element.find("ul.groups");var e=k.element.find("fieldset:first");var g=f.find(":radio[value="+h+"]");if(g.length!==1){return}f.find(":checked").attr("checked",false).removeAttr("checked");g.attr("checked","checked");f.find("li.ui-state-active").removeClass("ui-state-active");var d=g.parents("li:first");d.addClass("ui-state-active");if(!d.hasClass("control")){e.find("input").removeAttr("checked");e.find(".inGroup-"+h).attr("checked","checked")}var c=[];var j=[];e.find("input:checked").each(function(){c.push("."+a(this).attr("name").replace(/^.*?\[(.*?)\]$/,"$1").replace(/:/g," ."))});e.find("input:not(:checked)").each(function(){j.push("."+a(this).attr("name").replace(/^.*?\[(.*?)\]$/,"$1").replace(/:/g," ."))});var b={group:h,selected:c,deSelected:j};k.element.data("groupInfo",b);k.options.form.trigger("change",b)},getGroupInfo:function(){return this.element.data("groupInfo")},getForm:function(){return this.options.form},enable:function(){this.find(":input").removeAttr("disabled")},disable:function(){this.find(":input").attr("disabled",true)},toggleFieldset:function(){this.element.find("fieldset:first").toggleClass("ui-state-active").toggle()},destroy:function(){var c=this;c.element.find("a.option,div.option a:first").removeData("group");var d=c.element.find(".control:first");var b=c.element.find("input[name="+c.options.namespace+"Group]");d.unbind(".uioptiongroups");d.find("> a, .control > a, .control > .ui-icon").unbind(".uioptiongroups");c.element.find("fieldset:first").unbind(".uioptiongroups");c.element.find("a.option").unbind(".uioptiongroups");c.options.form.unbind(".uioptiongroups")}})}(jQuery));(function(a){a.widget("connexions.itemScope",{options:{namespace:"",termName:"tag",weightName:"userItemCount",jsonRpc:null,separator:",",minLength:2},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$input=b.element.find(".scopeEntry :text");b.$curItems=b.element.find(".scopeItem");b.$submit=b.element.find(".scopeEntry :submit");b.$input.input();if(d.jsonRpc!==null){b.$input.autocomplete({source:function(f,e){return b._autocomplete(f,e)},minLength:d.minLength})}b._bindEvents()},_autocomplete:function(f,c){var b=this;var e=b.options;var g=e.jsonRpc.params;g.term=b.$input.autocomplete("option","term");var d=new RegExp(g.term,"gi");a.jsonRpc(e.jsonRpc,e.jsonRpc.method,g,{success:function(h,j,k){if(h.error!==null){b.element.trigger("error",[j,k,h.error]);return}c(a.map(h.result,function(l){var o="";var m=(l[e.weightName]===undefined?"":l[e.weightName]);if(a.isArray(e.termName)){var n=[];a.each(e.termName,function(){if(l[this]===undefined){return}o=l[this].replace(d,"<b>"+g.term+"</b>");n.push(o)});o=n.join(", ")}else{o=l[e.termName].replace(d,"<b>"+g.term+"</b>")}return{label:'<span class="name">'+o+'</span> <span class="count">'+m+"</span>",value:l.tag}}));b.element.trigger("success",[h,j,k])},error:function(j,h,k){b.element.trigger("error",[h,j])}})},_bindEvents:function(){var b=this;var c=b.options;var d=b.element.find(".deletable a.delete");d.bind("mouseenter.itemScope",function(f){a(this).css("opacity",1).addClass("ui-icon-circle-close").removeClass("ui-icon-close")}).bind("mouseleave.itemScope",function(f){a(this).css("opacity",0.25).addClass("ui-icon-close").removeClass("ui-icon-circle-close")}).trigger("mouseleave");b.$submit.bind("click.itemScope",function(f){f.preventDefault();f.stopPropagation();f.stopImmediatePropagation();b.element.submit()});b.element.bind("submit.itemScope",function(h){h.preventDefault();h.stopPropagation();h.stopImmediatePropagation();var j=window.location;var f=j.toString();var g=b.$input.val().replace(/\s*,\s*/g,",").replace(/,$/,"");if(f[f.length-1]!=="/"){f+="/"}if(g.length>0){if(b.$curItems.length>0){f+=","}f+=g}window.location.assign(f)})},destroy:function(){var b=this;var c=b.options;if(c.jsonRpc!==null){b.$input.autocomplete("destroy")}b.$input.input("destroy");b.element.find(".deletable a.delete").unbind(".itemScope");b.$submit.unbind(".itemScope");b.element.unbind(".itemScope")}})}(jQuery));(function(a){a.widget("connexions.paginator",{version:"0.1.1",options:{namespace:"",disableHover:false,page:1,pageVar:"Page"},_init:function(){var b=this;var d=b.options;if(d.namespace===null){d.namespace=""}if(d.form===null){var c=b.element.data("form");if(c!==undefined){d.form=c}else{d.form=b.element.closest("form")}}d.page=b.element.find("button.ui-state-active").text();d.pageVar=b.element.find("button:submit:first").attr("name");b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;if(!c.disableHover){b.element.fadeTo(100,0.5).hover(function(){a(this).fadeTo(100,1)},function(){a(this).fadeTo(100,0.5)})}b.element.find(".perPage select").bind("change.paginator",function(g){var d={};var f=a.registry("cookiePath");if(f){d.path=f}a.log("connexions.paginator: Add Cookie: path[%s], name[%s], value[%s]",f,this.name,this.value);a.cookie(this.name,this.value,d);b.element.submit()});b.element.find(":submit").bind("click.paginator",function(d){c.page=a(this).val()})},_setOption:function(c,e){var b=this;var d=b.options;switch(c){case"disableHover":if(d.disableHover!=e){if(!e){b.element.fadeTo(100,0.5).bind("mouseenter.paginator",function(){a(this).fadeTo(100,1)}).bind("mouseleave.paginator",function(){a(this).fadeTo(100,0.5)})}else{b.element.fadeTo(100,1).unbind("mouseenter.paginator").unbind("mouseleave.paginator")}}break}a.Widget.prototype._setOption.apply(this,arguments)},getPage:function(){return this.options.page},getPageVar:function(){return this.options.pageVar},getForm:function(){return this.options.form},enable:function(){this.element.find(":button").removeAttr("disabled")},disable:function(){this.element.find(":button").attr("disabled",true);this.element.fadeTo(100,1).unbind(".paginator")},destroy:function(){}})}(jQuery));(function(a){a.widget("connexions.pane",{version:"0.0.1",options:{namespace:"",partial:null,pageCur:null,pageVar:null,page:null,hiddenVars:null,paginator:{},displayOptions:{}},_init:function(){this._init_paginators();this._init_displayOptions()},_init_paginators:function(){var b=this;var c=b.options;b.$paginators=b.element.find("form.paginator");b.$paginators.each(function(e){var d=a(this);if(d.data("paginator")===undefined){d.paginator({namespace:c.namespace,form:d,disableHover:(e!==0)})}else{if(e!==0){d.paginator("option","disableHover",true)}}if(c.pageCur===null){c.pageCur=d.paginator("getPage");c.pageVar=d.paginator("getPageVar")}});b.$paginators.bind("submit.uipane",function(f){var d=a(this);f.preventDefault(true);f.stopPropagation(true);f.stopImmediatePropagation(true);c.page=d.paginator("getPage");b.reload()})},_init_displayOptions:function(){var b=this;b.$displayOptions=b.element.find("div.displayOptions");if(b.$displayOptions.length<1){return}var c=b.options;if(b.$displayOptions.data("dropdownForm")===undefined){var d=(c.displayOptions===undefined?{}:c.displayOptions);if(d.namespace===undefined){d.namespace=c.namespace}b.$displayOptions.dropdownForm(d)}b.$displayOptions.bind("submit.uipane",function(f){f.preventDefault();f.stopPropagation();f.stopImmediatePropagation()});b.$displayOptions.bind("apply.uipane",function(f){b.reload()})},_paneDestroy:function(){var b=this;b.$paginators.unbind(".uipane");b.$displayOptions.unbind(".uipane");b.$paginators.paginator("destroy");b.$displayOptions.dropdownForm("destroy")},reload:function(h){var b=this;var e=b.options;var d=new RegExp(e.pageVar+"="+e.pageCur);var f=e.pageVar+"="+(e.page!==null?e.page:e.pageCur);var g=window.location;var c=g.toString();if(g.search.length===0){c+="?"+f}else{if(!c.match(d)){c+="&"+f}else{c=c.replace(d,f)}}if(e.hiddenVars!==null){a.each(e.hiddenVars,function(j,k){c+="&"+j+"="+k})}if(e.partial!==null){c+="&format=partial&part="+e.partial;a.ajax({url:c,dataType:"html",beforeSend:function(){b.element.mask()},error:function(l,j,k){a.notify({title:'Reload pane "'+e.partial+'" failed',text:'<p class="error">'+j+"</p>"})},success:function(l,j,k){b.destroy();b.element.replaceWith(l)},complete:function(){b.element.unmask();if(a.isFunction(h)){h.call(b.element)}}})}else{window.location.assign(c)}},destroy:function(){this._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.itemsPane",a.connexions.pane,{version:"0.0.1",options:{namespace:""},_init:function(){var b=this;var c=b.options;a.connexions.pane.prototype._init.apply(this,arguments);b.element.delegate("form","saved.itemsPane",function(){setTimeout(function(){b.reload()},50)});b._init_itemList()},_init_itemList:function(){var c=this;c.$itemList=c.element.find("ul.items");if(c.$itemList.length<1){return}var d=c.options;var b=(d.itemList===undefined?{}:d.itemList);if(b.namespace===undefined){b.namespace=d.namespace}c.$itemList.itemList(b)},destroy:function(){var b=this;b.element.undelegate("form",".itemsPane");b.$itemList.itemList("destroy");a.connexions.pane.prototype.destroy.apply(this,arguments)}})}(jQuery));(function(a){a.widget("connexions.cloudPane",a.connexions.pane,{version:"0.0.1",options:{namespace:"",jsonRpc:null,apiKey:null},_init:function(){var b=this;var d=b.options;a.connexions.pane.prototype._init.apply(this,arguments);if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$doForm=b.$displayOptions.find("form:first");b._bindEvents()},_bindEvents:function(){var b=this;this.$doForm.bind("change.cloudPane",function(f,d){var c=a(this).find(".field.highlightCount");if((d===undefined)||(d.group===undefined)||(d.group==="cloud")){c.removeClass("ui-state-disabled");c.find("select").removeAttr("disabled")}else{c.addClass("ui-state-disabled");c.find("select").attr("disabled",true)}});this.element.delegate(".item-edit, .item-delete, .item-add","click",function(d){var c=a(this);d.preventDefault();d.stopPropagation();d.stopImmediatePropagation();if(c.hasClass("item-edit")){b._edit_item(c)}else{if(c.hasClass("item-add")){b._add_user(c)}else{b._delete_confirm(c)}}})},_edit_item:function(p){var o=this;var d=p.parents(".control:first");if(d.attr("disabled")!==undefined){return}d.attr("disabled",true);var b=o.options;var m=p.parents("li:first");var f=m.find(".item:first");var q=f.data("id");var g='<div class="edit-item"><input type="text" class="text" value="'+q+'" /><div class="buttons"><span class="item-save" title="save"><span class="title">Save</span><span class="icon connexions_sprites status-ok"></span></span><span class="item-cancel" title="cancel"><span class="title">Cancel</span><span class="icon connexions_sprites star_0_off"></span></span></div></div>';var l=a(g);d.hide();var e=parseInt(f.width(),10);var n=l.find("input");n.input().css("font-size",f.css("font-size")).width(e+16);l.appendTo(m).position({of:f,my:"center top",at:"center top",offset:"0 -5"});n.focus();function c(r){r.preventDefault();r.stopPropagation();r.stopImmediatePropagation();setTimeout(function(){d.removeAttr("disabled").show();l.remove()},100)}function k(r){}var j=l.find(".item-save");var h=l.find(".item-cancel");j.click(function(r){if(n.input("hasChanged")!==true){c(r);return}o._perform_rename(p,function(s){if(s!==false){var u=n.input("getOrigValue");var t=f.attr("href").replace(/\/([^\/]+)$/,"/"+s);f.attr("href",t).text(s).data("id",s);c(r)}})});h.click(function(r){c(r)});n.keydown(function(r){if(r.keyCode===13){j.click()}else{if(r.keyCode===27){h.click()}}})},_perform_rename:function(m,l){var j=this;var b=j.options;var f=m.parents("li:first");var g=f.find(".edit-item input");var c=f.find(".item:first");var e=c.data("id");var h=g.val();var k=false;var d={renames:e+":"+h};if(b.apiKey!==null){d.apiKey=b.apiKey}a.jsonRpc(b.jsonRpc,"user.renameTags",d,{success:function(o,p,n){if((!o)||(o.error!==null)){a.notify({title:"Tag rename failed",text:'<p class="error">'+(o?o.error.message:"")+"</p>"});return}if(o.result===null){return}if(o.result[e]!==true){a.notify({title:"Tag rename failed",text:'<p class="error">'+(o?o.result[e]:"")+"</p>"});return}a.notify({title:"Tag renamed",text:e+" renamed to "+h});k=h},error:function(o,p,n){a.notify({title:"Tag rename failed",text:'<p class="error">'+p+"</p>"})},complete:function(n,o){l(k)}})},_delete_confirm:function(d){var b=this;var c=d.parents(".control:first");if(c.attr("disabled")!==undefined){return}c.attr("disabled",true);c.confirmation({question:"Really delete?",confirmed:function(){b._perform_delete(d)},closed:function(){c.removeAttr("disabled")}})},_perform_delete:function(d){var b=this;var f=b.options;var c=d.parents("ul:first");var e=c.data("type");switch(e){case"user":b._remove_user(d);break;case"tag":default:b._delete_tag(d);break}},_delete_tag:function(d){var c=this;var e=c.options;var h=d.parents("li:first");var f=h.find(".item:first");var b=f.data("id");var g={tags:b};if(e.apiKey!==null){g.apiKey=e.apiKey}a.jsonRpc(e.jsonRpc,"user.deleteTags",g,{success:function(k,l,j){if((!k)||(k.error!==null)){a.notify({title:"Tag deletion failed",text:'<p class="error">'+(k?k.error.message:"")+"</p>"});return}if(k.result===null){return}if(k.result[b]!==true){a.notify({title:"Tag deletion failed",text:'<p class="error">'+(k?k.result[b]:"")+"</p>"});return}a.notify({title:"Tag deleted",text:b});h.hide("fast",function(){h.remove()})},error:function(k,l,j){a.notify({title:"Tag deletion failed",text:'<p class="error">'+l+"</p>"})},complete:function(j,k){}})},_add_user:function(d){var c=this;var e=c.options;var h=d.parents("li:first");var f=h.find(".item:first");var b=f.data("id");var g={users:b};if(e.apiKey!==null){g.apiKey=e.apiKey}a.jsonRpc(e.jsonRpc,"user.addToNetwork",g,{success:function(k,l,j){if((!k)||(k.error!==null)){a.notify({title:"User addition failed",text:'<p class="error">'+(k?k.error.message:"")+"</p>"});return}if(k.result===null){return}if(k.result[b]!==true){a.notify({title:"User addition failed",text:'<p class="error">'+(k?k.result[b]:"")+"</p>"});return}a.notify({title:"User added",text:b})},error:function(k,l,j){a.notify({title:"User addition failed",text:'<p class="error">'+l+"</p>"})},complete:function(j,k){}})},_remove_user:function(d){var c=this;var e=c.options;var h=d.parents("li:first");var f=h.find(".item:first");var b=f.data("id");var g={users:b};if(e.apiKey!==null){g.apiKey=e.apiKey}a.jsonRpc(e.jsonRpc,"user.removeFromNetwork",g,{success:function(k,l,j){if((!k)||(k.error!==null)){a.notify({title:"User removal failed",text:'<p class="error">'+(k?k.error.message:"")+"</p>"});return}if(k.result===null){return}if(k.result[b]!==true){a.notify({title:"User removal failed",text:'<p class="error">'+(k?k.result[b]:"")+"</p>"});return}a.notify({title:"User removed",text:b});h.hide("fast",function(){h.remove()})},error:function(k,l,j){a.notify({title:"User removal failed",text:'<p class="error">'+l+"</p>"})},complete:function(j,k){}})},_confirmationPosition:function(d,e){var g=d.parents("li:first");var b=d.offset();var c=g.offset();var f={of:d};if(b.top<=c.top){f.my="right bottom";f.at="right bottom"}else{f.my="center top";f.at="center top"}if(e!==undefined){e.appendTo(g).position(f)}return f},destroy:function(){var b=this;b.$doForm.unbind(".cloudPane");a.connexions.pane.prototype.destroy.apply(this,arguments)}})}(jQuery));(function(a){a.widget("connexions.sidebar",{version:"0.0.1",options:{namespace:""},_create:function(){var b=this;var c=b.options;c.namespace=b.element.attr("id");b.element.tabs({cache:true,cookie:c.namespace,ajaxOptions:{beforeSend:function(){var d=b.element.tabs("option","selected");b.$tab=b.element.find(".ui-tabs-panel").eq(d);b.$tab.mask()},complete:function(){b._bindReload(b.$tab);b.$tab.unmask()}}});b.element.find("ul:first li a:first").each(function(e){var d=a.data(this,"load.tabs");if(d){var f=b.element.find(".ui-tabs-panel").eq(e);b._bindReload(f)}});b._bindReload(b.element)},_bindReload:function(c){var b=this;c.find(".displayOptions").dropdownForm("setApplyCb",function(d){d.preventDefault();d.stopPropagation();d.stopImmediatePropagation();b.element.tabs("load",b.element.tabs("option","selected"))})},destroy:function(){this.element.tabs("destroy")}})}(jQuery));(function(a){a.widget("connexions.itemList",{version:"0.0.1",widgetEventPrefix:"",options:{namespace:"",objClass:null,dimOpacity:0.5,ignoreDeleted:false},_create:function(){var b=this;var c=b.options;b.$items=b.element.find("li > form");b.$headers=b.element.find(".groupHeader .groupType");if(c.objClass===null){c.objClass=b.$items.attr("class")}if(b.$items.length>0){b.$items[c.objClass]()}b.$headers.fadeTo(100,c.dimOpacity).hover(function(){b.$headers.fadeTo(100,1)},function(){b.$headers.fadeTo(100,c.dimOpacity)});b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;if(c.ignoreDeleted!==true){b.element.delegate("li > form","deleted.itemList",function(d){b._itemDeleted(a(this))})}},_itemDeleted:function(d){var c=this;var f=d.parent(".item");var e=f.prev(".groupHeader");var b=f.next();d.slideUp("fast",function(){f.slideUp("normal",function(){if(d.item){d.item("destroy")}if(d.user){d.user("destroy")}c.element.trigger("itemDeleted",[d]);f.remove();if((e.length>0)&&(!b.hasClass("item"))){e.slideUp("normal",function(){e.remove()})}})})},destroy:function(){var b=this;var c=b.options;b.$headers.unbind("hover");b.element.undelegate("li > form",".itemList");if(b.$items.length>0){b.$items[c.objClass]("destroy")}}})}(jQuery));(function(a){a.widget("connexions.search",{options:{},_create:function(){var b=this;var c=b.options;b.$input=b.element.find("input[name=terms]");b.$submit=b.element.find("button.submit");b.$context=b.element.find("input[name=searchContext]");b.$choices=b.element.find(".choices .list");b.contextLabel=b.$choices.find("li.active").text();b.$submit.addClass("ui-state-disabled").attr("disabled",true);b.$input.input({validation:function(d){if(d.length>0){b.$submit.removeClass("ui-state-disabled").removeAttr("disabled")}else{b.$submit.addClass("ui-state-disabled").attr("disabled",true)}return true}});b.$input.input("setLabel",b.contextLabel);b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;b.$choices.find("li").bind("mousedown.search",function(d){b.$input.input("setLabel",null)}).bind("click.search",function(f){var g=a(this);var d=g.attr("id").replace(/search-choice-/,"");b.$context.val(d);a.cookie("searchContext",d);b.contextLabel=g.text();g.siblings(".active").removeClass("active");g.addClass("active");b.$input.input("setLabel",b.contextLabel)})},destroy:function(){var b=this;b.$input.input("destroy");b.$choices.find("li").unbind(".search")}})}(jQuery));(function(a){a.widget("connexions.bookmarkPost",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,tags:null,url:null,$status:null,jsonRpc:null,apiKey:null,isEdit:true,enabled:true},_init:function(){var b=this;var d=b.options;b.element.hide();b.element.addClass("ui-form");if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}if((d.$status!==null)&&(d.$status.jquery===undefined)){d.$status=a(d.$status)}d.$required=b.element.find(".required");d.$userId=b.element.find("input[name=userId]");d.$itemId=b.element.find("input[name=itemId]");d.$name=b.element.find("input[name=name]");d.$url=b.element.find("input[name=url]");d.$description=b.element.find("textarea[name=description]");d.$tags=b.element.find("textarea[name=tags]");d.$favorite=b.element.find("input[name=isFavorite]");d.$private=b.element.find("input[name=isPrivate]");d.$rating=b.element.find(".userRating .stars-wrapper");d.$save=b.element.find("button[name=submit]");d.$cancel=b.element.find("button[name=cancel]");d.$reset=b.element.find("button[name=reset]");d.$inputs=b.element.find("input[type=text],input[type=password],textarea");d.$cte=b.element.find(".click-to-edit");d.$suggestions=b.element.find(".suggestions");d.$collapsable=b.element.find(".collapsable");d.$tags.autocomplete({source:function(f,e){a.log("connexions.bookmarkPost::$tags.source("+f.term+")");return b._autocomplete(f,e)},change:function(g,f){a.log('connexions.bookmarkPost::$tags.change( "'+d.$tags.val()+'" )');b._highlightTags()},close:function(g,f){a.log("connexions.bookmarkPost::$tags.close()");b._highlightTags()}});d.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});d.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});d.$rating.stars({});d.$save.addClass("ui-priority-primary").button({disabled:true});d.$cancel.addClass("ui-priority-secondary").button({disabled:false});d.$reset.addClass("ui-priority-secondary").button({disabled:false});d.$suggestions.tabs();d.$collapsable.collapsable();d.$inputs.input();d.$required.after('<div class="ui-field-info"><div class="ui-field-status"></div><div class="ui-field-requirements">required</div></div>');d.$required.filter("[name=tags]").next(".ui-field-info").find(".ui-field-requirements").text("comma-separated, 30 characters per tag - required");d.$required.each(function(){var e=a(this);e.next().css("width",e.css("width"))});b._setStateFromForm();b._bindEvents();b.element.show()},_setStateFromForm:function(){var b=this;var d=b.options;d.name=d.$name.val();d.description=d.$description.val();d.tags=d.$tags.val();d.isFavorite=d.$favorite.checkbox("isChecked");d.isPrivate=d.$private.checkbox("isChecked");d.url=d.$url.val();if(d.$userId.length>0){d.userId=d.$userId.val()}if(d.$userId.length>0){d.itemId=d.$itemId.val()}if(d.$rating.length>0){d.rating=d.$rating.stars("value")}if(d.tags.length>0){b._highlightTags()}var c=d.isEdit;d.isEdit=(d.userId===null?false:true);if(c!==d.isEdit){b.element.trigger("isEditChanged",d.isEdit)}},_setFormFromState:function(){var b=this;var d=b.options;d.$name.val(d.name).input("val",d.name);d.$description.val(d.description).input("val",d.description);d.$tags.val(d.tags).input("val",d.tags);d.$favorite.checkbox(d.isFavorite?"check":"uncheck");d.$private.checkbox(d.isPrivate?"check":"uncheck");d.$url.val(d.url);if(d.$userId.length>0){d.$userId.val(d.userId)}if(d.$userId.length>0){d.$itemId.val(d.itemId)}if(d.$rating.length>0){d.$rating.stars("option","value",d.rating).stars("select",d.rating)}var c=d.isEdit;d.isEdit=(d.userId===null?false:true);if(c!==d.isEdit){b.element.trigger("isEditChanged",d.isEdit)}},_bindEvents:function(){var j=this;var b=j.options;var c=function(m,l){m.stopImmediatePropagation();m.preventDefault();m.stopPropagation();a.log("connexions.bookmarkPost::_save_click("+l+")");j._performUpdate();return false};var h=function(m,l){m.stopImmediatePropagation();m.preventDefault();m.stopPropagation();j._trigger("canceled",null,l);j._trigger("complete")};var e=function(m,l){m.stopImmediatePropagation();m.preventDefault();m.stopPropagation();j.reset()};var g=function(n,m){var l=a(this);if(l.data("validationInitialized")!==true){l.data("validationInitialized",true);return}l.removeClass("click-to-edit").unbind("validationChange")};var f=function(n,m){var l=a(this);if(l.hasClass("ui-state-valid")){j._url_changed()}};var d=function(){j.validate()};var k=function(l){var m=a.ui.keyCode;if(l.keyCode===a.ui.keyCode.COMMA){var n=b.$tags.autocomplete("widget");b.$tags.autocomplete("close")}};j._tagClick=function(p){p.preventDefault();p.stopPropagation();var q=a(this);var m=q.find("a:first");var l=m.data("id");var n=b.$tags.val();if(q.hasClass("user")){l="for:"+l}if(m.hasClass("selected")){var o=new RegExp("\\s*"+l+"\\s*[,]?");n=n.replace(o,"")}else{if(!n.match(/,\s*$/)){n+=", "}n+=l}b.$tags.val(n);j._highlightTags()};b.$inputs.bind("validation_change.bookmarkPost",d);b.$favorite.bind("change.bookmarkPost",d);b.$private.bind("change.bookmarkPost",d);b.$rating.bind("change.bookmarkPost",d);b.$cte.bind("validation_change.bookmarkPost",g);b.$save.bind("click.bookmarkPost",c);b.$cancel.bind("click.bookmarkPost",h);b.$reset.bind("click.bookmarkPost",e);b.$url.bind("validation_change.bookmarkPost",f);b.$tags.bind("keydown.bookmarkPost",k);b.$suggestions.delegate(".cloud .cloudItem,.cloud .Item_List li:not(.header)","click.bookmarkPost",j._tagClick);d()},_performUpdate:function(){var c=this;var d=c.options;if(d.enabled!==true){return}var b=false;var f={id:{userId:d.userId,itemId:d.itemId}};if(d.isEdit!==true){f.id.userId=null}if((d.isEdit!==true)||(d.$name.val()!==d.name)){f.name=d.$name.val();b=true}if((d.isEdit!==true)||(d.$description.val()!==d.description)){f.description=d.$description.val();b=true}if((d.isEdit!==true)||((d.$tags.length>0)&&(d.$tags.val()!==d.tags))){f.tags=d.$tags.val();b=true}if((d.isEdit!==true)||(d.$favorite.checkbox("isChecked")!==d.isFavorite)){f.isFavorite=d.$favorite.checkbox("isChecked");b=true}if((d.isEdit!==true)||(d.$private.checkbox("isChecked")!==d.isPrivate)){f.isPrivate=d.$private.checkbox("isChecked");b=true}if((d.isEdit!==true)||((d.$rating.length>0)&&(d.$rating.stars("value")!==d.rating))){f.rating=d.$rating.stars("value");b=true}if((d.isEdit!==true)||(d.$url.val()!==d.url)){f.url=d.$url.val();b=true}if(b!==true){c._trigger("complete");return}if(d.apiKey!==null){f.apiKey=d.apiKey}c.element.mask();var e=(d.isEdit===true?"update":"save");a.jsonRpc(d.jsonRpc,"bookmark.update",f,{success:function(j,k,h){if(j.error!==null){c._status(false,"Bookmark "+e+" failed",j.error.message);return}c._status(true,"Bookmark "+e+" succeeded","Bookmark "+e+"d");if(j.result===null){return}c.options=a.extend(c.options,j.result);d=c.options;if(a.isArray(d.tags)){var g=[];a.each(d.tags,function(){g.push(this.tag)});d.tags=g.join(",")}if(a.isPlainObject(d.item)){d.url=d.item.url}c._trigger("saved",null,j.result);c._setFormFromState();c._trigger("complete")},error:function(h,j,g){c._status(false,"Bookmark "+e+" failed",j)},complete:function(g,h){c.element.unmask()}})},_url_changed:function(){var b=this;var d=b.options;if(d.enabled!==true){return}var c=d.$url.val();var e={id:{userId:d.userId,itemId:c}};if(d.apiKey!==null){e.apiKey=d.apiKey}b.element.mask();var f=false;a.jsonRpc(d.jsonRpc,"bookmark.find",e,{success:function(j,k,h){if(j.error!==null){a.notify({title:"Cannot retrieve bookmark",text:j.error.message});return}if(j.result===null){return}f=true;b.options=a.extend(b.options,j.result);d=b.options;if(a.isArray(d.tags)){var g=[];a.each(d.tags,function(){g.push(this.tag)});d.tags=g.join(",")}if(a.isPlainObject(d.item)){d.url=d.item.url}b._setFormFromState();b.validate();b.element.trigger("urlChanged")},error:function(h,j,g){a.notify({title:"Cannot retrieve bookmark",text:j})},complete:function(g,h){b.element.unmask();if(f===false){a.notify({title:"Pulling information",text:"Performing a HEAD request on URL<br /><tt>'"+c+"'</tt>"});b._headers(c)}else{b._update_recommendedTags(c)}}})},_headers_success:function(f){var c=this;var e=c.options;if(!e.$name.input("hasChanged")){if(f.title.length>0){e.$name.val(f.title);e.$name.trigger("blur")}}if(!e.$name.input("hasChanged")){var d=f.meta.filter("meta[name=description]");if(d.length>0){e.$description.val(d.attr("content"));e.$description.trigger("blur")}}if(!e.$tags.input("hasChanged")){var b=f.meta.filter("meta[name=keywords]");if(b.length>0){e.$tags.val(b.attr("content"));e.$tags.trigger("blur")}}},_headers:function(c,f){var b=this;var d=b.options;if(b.headersUrl===c){return}b.headersUrl=c;var e={url:c,keepTags:"title,meta"};a.jsonRpc(d.jsonRpc,"util.getHead",e,{success:function(j,l,h){if(j.error!==null){return}if(j.result===null){return}var g=a("<div />");g.html(j.result.html);var k={title:g.find("title").text(),meta:g.find("meta")};if(a.isFunction(f)){f(k)}else{b._headers_success(k)}},error:function(h,j,g){},complete:function(g,h){}});b._update_recommendedTags(c)},_update_recommendedTags:function(c){var b=this;var d=b.options;a.ajax({url:(a.registry("urls")).base+"/post/",data:{format:"partial",part:"main-tags-recommended",url:c},success:function(f){var e=d.$suggestions.find("#suggestions-tags .tags-recommended .content");e.html(f);b._highlightTags()}})},_highlightTags:function(){var d=this;var j=d.options;if(j.$suggestions.length<1){return}var g=j.$suggestions.find(".cloud .cloudItem a,.cloud .Item_List li a");g.filter(".selected").removeClass("selected");var e=j.$tags.val();var c=e.length;var b=null;if(c<1){return}e=e.split(/\s*,\s*/);c=e.length;var h=/^for:/;for(var f=0;f<c;f++){b=e[f];if(b.length<1){continue}b=b.replace('"','"');if(h.test(b)){b=b.replace(h,"")}else{b=b.toLowerCase()}g.filter('.item[data-id="'+b+'"]').addClass("selected")}},_autocomplete:function(e,c){var b=this;var d=b.options;var f={id:{userId:d.userId,itemId:d.itemId}};if((f.id.itemId===null)||(d.$url.val()!==d.url)){f.id.itemId=d.$url.val()}f.term=d.$tags.autocomplete("option","term");a.jsonRpc(d.jsonRpc,"bookmark.autocompleteTag",f,{success:function(g,h,j){if(g.error!==null){b.element.trigger("error",[h,j,g.error]);return}c(a.map(g.result,function(k){var l=k.tag.replace(f.term,"<b>"+f.term+"</b>");return{label:'<span class="name">'+l+'</span> <span class="count">'+k.userItemCount+"</span>",value:k.tag}}));b.element.trigger("success",[g,h,j])},error:function(h,g,j){b.element.trigger("error",[g,h])}})},_status:function(b,g,f){var c=this;var d=c.options;if(d.$status===null){if((g!==undefined)&&(f!==undefined)){a.notify({title:g,text:f})}}else{var e="";if(f!==undefined){e+=f}d.$status.html(e);if(b){d.$status.removeClass("error").addClass("success")}else{d.$status.removeClass("success").addClass("error")}}},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!c.enabled){c.enabled=true;b.element.removeClass("ui-state-disabled");c.$favorite.checkbox("enable");c.$private.checkbox("enable");c.$rating.stars("enable");c.$inputs.input("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(c.enabled){c.enabled=false;b.element.addClass("ui-state-disabled");c.$favorite.checkbox("disable");c.$private.checkbox("disable");c.$rating.stars("disable");c.$inputs.input("disable");b._trigger("disabled",null,true)}},reset:function(){var b=this;var c=b.options;c.$favorite.checkbox("reset");c.$private.checkbox("reset");c.$rating.stars("reset");c.$inputs.input("reset");b._trigger("reset");b.headersUrl=undefined;b.validate()},validate:function(){var b=this;var d=b.options;var e=true;var c=b.hasChanged();if(c){d.$required.each(function(){if(!a(this).hasClass("ui-state-valid")){e=false;return false}});if(e){b._status(true)}else{b._status(false)}}if(e&&((d.isEdit!==true)||c)){d.$save.button("enable")}else{d.$save.button("disable")}},hasChanged:function(){var b=this;var d=b.options;var c=false;d.$inputs.each(function(){if(a(this).input("hasChanged")){c=true;return false}});if((!c)&&(d.$favorite.checkbox("hasChanged")||d.$private.checkbox("hasChanged")||d.$rating.stars("hasChanged"))){c=true}return c},destroy:function(){var b=this;var c=b.options;c.$save.removeClass("ui-priority-primary");c.$cancel.removeClass("ui-priority-secondary");c.$reset.removeClass("ui-priority-secondary");c.$required.next(".ui-field-info").remove();b.element.removeClass("ui-form");c.$inputs.unbind(".bookmarkPost");c.$favorite.unbind(".bookmarkPost");c.$private.unbind(".bookmarkPost");c.$rating.unbind(".bookmarkPost");c.$cte.unbind(".bookmarkPost");c.$save.unbind(".bookmarkPost");c.$cancel.unbind(".bookmarkPost");c.$reset.unbind(".bookmarkPost");c.$url.unbind(".bookmarkPost");c.$tags.unbind(".bookmarkPost");c.$suggestions.undelegate(".cloud .cloudItem,.cloud .Item_List li:not(.header)",".bookmarkPost");c.$favorite.checkbox("destroy");c.$private.checkbox("destroy");c.$rating.stars("destroy");c.$inputs.input("destroy");c.$save.button("destroy");c.$cancel.button("destroy");c.$reset.button("destroy");c.$suggestions.tabs("destroy");c.$collapsable.collapsable("destroy")}})}(jQuery));(function(a){a.widget("connexions.autocomplete",a.ui.autocomplete,{version:"0.0.1",options:{delay:200,minLength:2,separator:","},_init:function(){var b=this;var c=b.options;a.each(["search","focus","select"],function(){var e=this;var f=b["_do_"+e];var d=(a.isFunction(c[e])?c[e]:null);c[this]=function(h,j){var g=f.call(b,h,j);if(g!==false){if(d!==null){g=d.call(b.element[0],h,j)}}return g}})},_do_search:function(){var b=this._curTerm();if(b.length<this.options.minLength){return false}},_do_focus:function(){return false},_do_select:function(d,e){var c=this.options;var b=new RegExp("(\\s*"+c.separator+"\\s*)+","g");var f=c.val.substring(0,c.start)+e.item.value+c.val.substring(c.end)+c.separator+" ";f=f.replace(b,c.separator+" ");this.element.val(f);return false},_curTerm:function(){var b=this;var d=b.options;d.start=b._selectionStart();d.end=b._selectionEnd();d.val=b.element.val();if(d.start===d.end){d.end=d.val.indexOf(d.separator,d.start);if(d.end<0){d.end=d.val.length}var c=d.val.indexOf(d.separator,0);var e=0;while((c>=0)&&(c<d.start)){while((c<d.end)&&(d.val.substr(++c,1).match(/\s/))){}e=c;c=d.val.indexOf(d.separator,c)}d.start=e}d.term=d.val.substring(d.start,d.end);return d.term},_selectionStart:function(){var d=this;var e=0;if(d.element[0].createTextRange){var c=document.selection.createRange().duplicate();var b=d.element.val();c.moveEnd("character",b.length);if(c.text===""){e=b.length}else{e=b.lastIndexOf(c.text)}}else{e=d.element.attr("selectionStart")}return e},_selectionEnd:function(){var d=this;var e=0;if(d.element[0].createTextRange){var c=document.selection.createRange().duplicate();var b=d.element.val();c.moveEnd("character",-(b.length));e=c.text.length}else{e=d.element.attr("selectionEnd")}return e}})}(jQuery));(function(a){a.widget("connexions.bookmark",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,tags:null,url:null,change:null,jsonRpc:null,apiKey:null,enabled:true},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$userId=b.element.find("input[name=userId]");b.$itemId=b.element.find("input[name=itemId]");b.$name=b.element.find(".itemName a");b.$description=b.element.find(".description");b.$rating=b.element.find(".rating .stars .owner");b.$favorite=b.element.find("input[name=isFavorite]");b.$private=b.element.find("input[name=isPrivate]");b.$dates=b.element.find(".dates");b.$dateTagged=b.$dates.find(".tagged");b.$dateUpdated=b.$dates.find(".updated");b.$tags=b.element.find(".tags");b.tagTmpl=b.$tags.find(".tag-template").html();b.$edit=b.element.find(".control .item-edit");b.$delete=b.element.find(".control .item-delete");b.$save=b.element.find(".control .item-save");b.$url=b.element.find(".itemName a,.url a");b._localizeDates();b.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});b.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});b.$rating.stars({});b._setState();b._bindEvents()},_bindEvents:function(){var b=this;var e=b.options;b._squelch=false;var g=function(j,h){j.stopImmediatePropagation();j.preventDefault();j.stopPropagation();b._performUpdate()};var d=function(j){if(b.options.enabled===true){var h=b.$edit.attr("href")+"&format=partial&part=main";a.get(h,function(k){b._showBookmarkDialog(k,true)})}j.preventDefault();j.stopPropagation()};var f=function(h){h.stopImmediatePropagation();h.preventDefault();h.stopPropagation();if(b.options.enabled!==true){return}b.disable();b.$delete.confirmation({question:"Really delete?",confirmed:function(){b._performDelete()},closed:function(){b.enable()}})};var c=function(j){if(b.options.enabled===true){var h=b.$save.attr("href")+"&format=partial&part=main";a.get(h,function(k){b._showBookmarkDialog(k)})}j.preventDefault();j.stopPropagation()};b.element.bind("change.bookmark",g);b.$edit.bind("click.bookmark",d);b.$delete.bind("click.bookmark",f);b.$save.bind("click.bookmark",c)},_localizeDate:function(d,c){var b=this;c=(c===undefined?b.$dates.data("groupBy"):c);var e=((c===undefined)||(c.indexOf(d.substr(0,10))<0)?false:true);return a.date2str(a.str2date(d),e)},_localizeDates:function(){var c=this;var b=c.$dates.data("groupBy");var e;var d;var f;if(c.$dateTagged.length>0){d=c._localizeDate(c.$dateTagged.data("utcDate"),b);c.$dateTagged.html(d)}if(c.$dateUpdated.length>0){d=c._localizeDate(c.$dateUpdated.data("utcDate"),b);c.$dateUpdated.html(d)}},_performDelete:function(){var b=this;var c=b.options;var d={id:{userId:c.userId,itemId:c.itemId}};if(c.apiKey!==null){d.apiKey=c.apiKey}a.jsonRpc(c.jsonRpc,"bookmark.delete",d,{success:function(f,g,e){if((!f)||(f.error!==null)){a.notify({title:"Bookmark delete failed",text:'<p class="error">'+(f?f.error.message:"")+"</p>"});return}b._trigger("deleted")},error:function(f,g,e){a.notify({title:"Bookmark delete failed",text:'<p class="error">'+g+"</p>"})},complete:function(e,f){}})},_performUpdate:function(){var c=this;var d=c.options;if((d.enabled!==true)||(c._squelch===true)){return}var b=false;var e={id:{userId:d.userId,itemId:d.itemId}};if(c.$name.text()!==d.name){e.name=c.$name.text();b=true}if(c.$description.text()!==d.description){e.description=c.$description.text();b=true}if(c.$favorite.checkbox("isChecked")!==d.isFavorite){e.isFavorite=c.$favorite.checkbox("isChecked");b=true}if(c.$private.checkbox("isChecked")!==d.isPrivate){e.isPrivate=c.$private.checkbox("isChecked");b=true}if((c.$rating.length>0)&&(c.$rating.stars("value")!==d.rating)){e.rating=c.$rating.stars("value");b=true}if(c.$url.attr("href")!==d.url){e.url=c.$url.attr("href");b=true}if(b!==true){return}a.log("connexions.bookmark::_performUpdate()");if(a.isFunction(c.options.change)){if(!c.options.change(e)){c._resetState();return}}if(d.apiKey!==null){e.apiKey=d.apiKey}a.jsonRpc(d.jsonRpc,"bookmark.update",e,{success:function(g,h,f){if((!g)||(g.error!==null)){a.notify({title:"Bookmark update failed",text:'<p class="error">'+(g?g.error.message:"")+"</p>"});c._resetState();return}if(g.result===null){return}c._refreshBookmark(g.result)},error:function(g,h,f){a.notify({title:"Bookmark update failed",text:'<p class="error">'+h+"</p>"});c._resetState()},complete:function(f,g){}})},_refreshBookmark:function(g){var b=this;var e=b.options;b._squelch=true;b.$itemId.val(g.itemId);b.$name.text(g.name);var h=b.$description.find(".full");var f=b.$description.find(".summary");if(f.length>0){f.html("&mdash; "+a.summarize(g.description))}if(h.length>0){h.html(a.esc(g.description))}if(a.isArray(g.tags)&&(b.tagTmpl.length>0)){var d="";a.each(g.tags,function(){d+=b.tagTmpl.replace(/%tag%/g,this.tag)});b.$tags.html(d)}b.$rating.stars("select",g.rating);b.$favorite.checkbox((g.isFavorite?"check":"uncheck"));b.$private.checkbox((g.isPrivate?"check":"uncheck"));b.$url.attr("href",g.url);b.$dateTagged.data("utcDate",g.taggedOn);b.$dateUpdated.data("utcDate",g.updatedOn);b._localizeDates();var c=b.element.parent();if(g.isPrivate){c.addClass("private")}else{c.removeClass("private")}b._squelch=false;b._setState();b.element.effect("highlight",{},2000)},_showBookmarkDialog:function(g,f){var k=this;var b=k.options;var j=(f===true?"Edit":"Save")+" bookmark";var h='<div><div class="ui-validation-form"><div class="userInput lastUnit"></div></div></div>';var c=k.element.parents(".pane:first");var e=a(h).hide().appendTo("body");var d=e.first();d.delegate("form","isEditChanged.bookmark",function(){f=d.find("form:first").bookmarkPost("option","isEdit");j=(f===true?"Edit YOUR":"Save")+" bookmark";if(d.data("dialog")){d.dialog("option","title",j)}});d.find(".userInput").html(g);var l=d.find("form:first");k.disable();d.dialog({autoOpen:true,title:j,dialogClass:"ui-dialog-bookmarkPost",width:480,resizable:false,modal:true,open:function(m,n){l.bind("saved.bookmark",function(p,o){if(f===true){k._refreshBookmark(o);p.stopPropagation()}else{if(c.length>0){k.element.trigger("saved",o)}}});l.bind("complete.bookmark",function(){d.dialog("close")})},close:function(m,n){l.unbind(".bookmark").bookmarkPost("destroy");d.dialog("destroy");e.remove();k.enable()}})},_setState:function(){var b=this;var c=b.options;c.userId=b.$userId.val();c.itemId=b.$itemId.val();c.name=b.$name.text();c.description=b.$description.text();if(b.$rating.length>0){c.rating=b.$rating.stars("value")}c.isFavorite=b.$favorite.checkbox("isChecked");c.isPrivate=b.$private.checkbox("isChecked");c.url=b.$url.attr("href")},_resetState:function(){var b=this;var c=b.options;b._squelch=true;b.$name.text(c.name);b.$description.text(c.description);if(b.$rating.length>0){b.$rating.stars("select",c.rating)}b.$favorite.checkbox((c.isFavorite?"check":"uncheck"));b.$private.checkbox((c.isPrivate?"check":"uncheck"));b.$url.attr("href",c.url);b._squelch=false},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!b.options.enabled){b.options.enabled=true;b.element.removeClass("ui-state-disabled");b.$favorite.checkbox("enable");b.$private.checkbox("enable");b.$rating.stars("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(b.options.enabled){b.options.enabled=false;b.element.addClass("ui-state-disabled");b.$favorite.checkbox("disable");b.$private.checkbox("disable");b.$rating.stars("disable");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$favorite.unbind(".bookmark");b.$private.unbind(".bookmark");b.$rating.unbind(".bookmark");b.$edit.unbind(".bookmark");b.$delete.unbind(".bookmark");b.$save.unbind(".bookmark");b.$favorite.checkbox("destroy");b.$private.checkbox("destroy");b.$rating.stars("destroy")}})}(jQuery));(function(a){a.widget("connexions.user",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,name:null,fullName:null,email:null,apiKey:null,pictureUrl:null,profile:null,lastVisit:null,change:null,jsonRpc:null,enabled:true},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$userId=b.element.find("input[name=userId]");b.$name=b.element.find(".userId a");b.$fullName=b.element.find(".fullName");b.$email=b.element.find(".email a");b.$relation=b.element.find(".relation");b.$add=b.element.find(".control > .item-add");b.$remove=b.element.find(".control > .item-delete");b._setState();b._bindEvents()},_bindEvents:function(){var b=this;var f=b.options;b._squelch=false;var e=function(h,g){h.stopImmediatePropagation();h.preventDefault();h.stopPropagation();b._performUpdate()};var c=function(g){g.stopImmediatePropagation();g.preventDefault();g.stopPropagation();if(b.options.enabled!==true){return}b.disable();b._performAdd();b.enable()};var d=function(g){g.stopImmediatePropagation();g.preventDefault();g.stopPropagation();if(b.options.enabled!==true){return}b.disable();b.$remove.confirmation({question:"Really delete?",confirmed:function(){b._performDelete()},closed:function(){b.enable()}})};b.element.bind("change.user",e);b.$add.bind("click.user",c);b.$remove.bind("click.user",d)},_performAdd:function(){var b=this;var c=b.options;var d={users:c.name};a.jsonRpc(c.jsonRpc,"user.addToNetwork",d,{success:function(f,g,e){if((!f)||(f.error!==null)){a.notify({title:"User addition failed",text:'<p class="error">'+(f?f.error.message:"")+"</p>"});return}if(f.result===null){return}if(f.result[c.name]!==true){a.notify({title:"User addition failed",text:'<p class="error">'+(f?f.result[c.name]:"")+"</p>"});return}a.notify({title:"User added",text:c.name});b._updateRelation("add")},error:function(f,g,e){a.notify({title:"User addition failed",text:'<p class="error">'+g+"</p>"})},complete:function(e,f){}})},_performDelete:function(){var b=this;var c=b.options;var d={users:c.name};a.jsonRpc(c.jsonRpc,"user.removeFromNetwork",d,{success:function(f,g,e){if((!f)||(f.error!==null)){a.notify({title:"User removal failed",text:'<p class="error">'+(f?f.error.message:"")+"</p>"});return}if(f.result===null){return}if(f.result[c.name]!==true){a.notify({title:"User removal failed",text:'<p class="error">'+(f?f.result[c.name]:"")+"</p>"});return}a.notify({title:"User removed",text:c.name});b._updateRelation("remove");b._trigger("deleted")},error:function(f,g,e){a.notify({title:"User removal failed",text:'<p class="error">'+g+"</p>"})},complete:function(e,f){}})},_performUpdate:function(){var c=this;var d=c.options;if((d.enabled!==true)||(c._squelch===true)){return}var b=false;var e={id:{userId:d.userId}};if(c.$name.text()!==d.name){e.name=c.$name.text();b=true}if(c.$fullName.text()!==d.fullName){e.fullName=c.$fullName.text();b=true}if(c.$email.text()!==d.email){e.email=c.$email.text();b=true}if(b!==true){return}a.log("connexions.user::_performUpdate()");if(a.isFunction(c.options.change)){if(!c.options.change(e)){c._resetState();return}}a.jsonRpc(d.jsonRpc,"user.update",e,{success:function(g,h,f){if((!g)||(g.error!==null)){a.notify({title:"User update failed",text:'<p class="error">'+(g?g.error.message:"")+"</p>"});c._resetState();return}if(g.result===null){return}c._squelch=true;c.$name.text(g.result.name);c.$fullName.text(g.result.fullName);c.$email.text(g.result.email);c.$email.attr("href","mailto:"+g.result.email);c._squelch=false;c._setState()},error:function(g,h,f){a.notify({title:"User update failed",text:'<p class="error">'+h+"</p>"});c._resetState()},complete:function(f,g){}})},_updateRelation:function(f){var b=this;var d=b.options;var c=b.$relation.data("relation");if(f==="add"){if(c==="none"){var e="following";b.$relation.attr("title",e).data("relation","isIn");b.$relation.find(".relation-none").removeClass("relation-none").addClass("relation-isIn").text(e)}else{if(c==="amIn"){var e="mutual followers";b.$relation.attr("title",e).data("relation","mutual");b.$relation.find(".relation-amIn").removeClass("relation-amIn").addClass("relation-mutual").text(e)}}b.$add.attr("disabled",true).hide();b.$remove.removeAttr("disabled").show()}else{if(c==="mutual"){var e="follower";b.$relation.attr("title",e).data("relation","amIn");b.$relation.find(".relation-mutual").removeClass("relation-mutual").addClass("relation-amIn").text(e)}else{if(c==="isIn"){var e="no relation";b.$relation.attr("title",e).data("relation","none");b.$relation.find(".relation-isIn").removeClass("relation-isIn").addClass("relation-none").text(e)}}b.$remove.attr("disabled",true).hide();b.$add.removeAttr("disabled").show()}},_setState:function(){var b=this;var c=b.options;c.userId=b.$userId.val();c.name=b.$name.text();c.fullName=b.$fullName.text();c.email=b.$email.text()},_resetState:function(){var b=this;var c=b.options;b._squelch=true;b.$name.text(c.name);b.$fullName.text(c.fullName);b.$email.text(c.email);b.$email.attr("href","mailto:"+c.email);b._squelch=false},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!b.options.enabled){b.options.enabled=true;b.element.removeClass("ui-state-disabled");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(b.options.enabled){b.options.enabled=false;b.element.addClass("ui-state-disabled");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$add.unbind(".user");b.$remove.unbind(".user")}})}(jQuery));(function(b){b.color={};b.color.make=function(f,e,c,d){var h={};h.r=f||0;h.g=e||0;h.b=c||0;h.a=d!=null?d:1;h.add=function(k,j){for(var g=0;g<k.length;++g){h[k.charAt(g)]+=j}return h.normalize()};h.scale=function(k,j){for(var g=0;g<k.length;++g){h[k.charAt(g)]*=j}return h.normalize()};h.toString=function(){if(h.a>=1){return"rgb("+[h.r,h.g,h.b].join(",")+")"}else{return"rgba("+[h.r,h.g,h.b,h.a].join(",")+")"}};h.normalize=function(){function g(k,l,j){return l<k?k:(l>j?j:l)}h.r=g(0,parseInt(h.r),255);h.g=g(0,parseInt(h.g),255);h.b=g(0,parseInt(h.b),255);h.a=g(0,h.a,1);return h};h.clone=function(){return b.color.make(h.r,h.b,h.g,h.a)};return h.normalize()};b.color.extract=function(e,d){var f;do{f=e.css(d).toLowerCase();if(f!=""&&f!="transparent"){break}e=e.parent()}while(!b.nodeName(e.get(0),"body"));if(f=="rgba(0, 0, 0, 0)"){f="transparent"}return b.color.parse(f)};b.color.parse=function(f){var e,c=b.color.make;if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(f)){return c(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10))}if(e=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(f)){return c(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4]))}if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(f)){return c(parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55)}if(e=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(f)){return c(parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55,parseFloat(e[4]))}if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(f)){return c(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))}if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(f)){return c(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16))}var d=b.trim(f).toLowerCase();if(d=="transparent"){return c(255,255,255,0)}else{e=a[d]||[0,0,0];return c(e[0],e[1],e[2])}};var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function(b){b.color={};b.color.make=function(d,e,g,f){var c={};c.r=d||0;c.g=e||0;c.b=g||0;c.a=f!=null?f:1;c.add=function(h,j){for(var k=0;k<h.length;++k){c[h.charAt(k)]+=j}return c.normalize()};c.scale=function(h,j){for(var k=0;k<h.length;++k){c[h.charAt(k)]*=j}return c.normalize()};c.toString=function(){if(c.a>=1){return"rgb("+[c.r,c.g,c.b].join(",")+")"}else{return"rgba("+[c.r,c.g,c.b,c.a].join(",")+")"}};c.normalize=function(){function h(k,j,l){return j<k?k:(j>l?l:j)}c.r=h(0,parseInt(c.r),255);c.g=h(0,parseInt(c.g),255);c.b=h(0,parseInt(c.b),255);c.a=h(0,c.a,1);return c};c.clone=function(){return b.color.make(c.r,c.b,c.g,c.a)};return c.normalize()};b.color.extract=function(d,e){var c;do{c=d.css(e).toLowerCase();if(c!=""&&c!="transparent"){break}d=d.parent()}while(!b.nodeName(d.get(0),"body"));if(c=="rgba(0, 0, 0, 0)"){c="transparent"}return b.color.parse(c)};b.color.parse=function(c){var d,f=b.color.make;if(d=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c)){return f(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10))}if(d=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c)){return f(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),parseFloat(d[4]))}if(d=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c)){return f(parseFloat(d[1])*2.55,parseFloat(d[2])*2.55,parseFloat(d[3])*2.55)}if(d=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c)){return f(parseFloat(d[1])*2.55,parseFloat(d[2])*2.55,parseFloat(d[3])*2.55,parseFloat(d[4]))}if(d=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c)){return f(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16))}if(d=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c)){return f(parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16))}var e=b.trim(c).toLowerCase();if(e=="transparent"){return f(255,255,255,0)}else{d=a[e];return f(d[0],d[1],d[2])}};var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function(b){function a(ar,af,I,ad){var P=[],N={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,autoscaleMax:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,labelAngle:0,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:false},yaxis:{autoscaleMargin:0.02,labelAngle:0,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false},shadowSize:3},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},hooks:{}},aw=null,ab=null,w=null,G=null,y=null,n=[],at=[],o={left:0,right:0,top:0,bottom:0},F=0,H=0,h=0,u=0,g=false,ah={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[]},ao=this;ao.setData=ag;ao.setupGrid=r;ao.draw=U;ao.getPlaceholder=function(){return ar};ao.getCanvas=function(){return aw};ao.getPlotOffset=function(){return o};ao.width=function(){return h};ao.height=function(){return u};ao.offset=function(){var az=w.offset();az.left+=o.left;az.top+=o.top;return az};ao.getData=function(){return P};ao.getAxis=function(aA,aB){var az=(aA=="x"?n:at)[aB-1];if(az&&!az.used){az=null}return az};ao.getAxes=function(){var aA={},az;for(az=0;az<n.length;++az){aA["x"+(az?(az+1):"")+"axis"]=n[az]||{}}for(az=0;az<at.length;++az){aA["y"+(az?(az+1):"")+"axis"]=at[az]||{}}if(!aA.x2axis){aA.x2axis={n:2}}if(!aA.y2axis){aA.y2axis={n:2}}return aA};ao.getXAxes=function(){return n};ao.getYAxes=function(){return at};ao.getUsedAxes=J;ao.c2p=A;ao.p2c=ap;ao.getOptions=function(){return N};ao.highlight=v;ao.unhighlight=S;ao.triggerRedrawOverlay=f;ao.pointOffset=function(az){return{left:parseInt(n[ay(az,"x")-1].p2c(+az.x)+o.left),top:parseInt(at[ay(az,"y")-1].p2c(+az.y)+o.top)}};ao.hooks=ah;E(ao);X(I);z();ag(af);r();U();ae();function ak(aB,az){az=[ao].concat(az);for(var aA=0;aA<aB.length;++aA){aB[aA].apply(this,az)}}function E(){for(var az=0;az<ad.length;++az){var aA=ad[az];aA.init(ao);if(aA.options){b.extend(true,N,aA.options)}}}function X(aA){var az;b.extend(true,N,aA);if(N.xaxis.color==null){N.xaxis.color=N.grid.color}if(N.yaxis.color==null){N.yaxis.color=N.grid.color}if(N.xaxis.tickColor==null){N.xaxis.tickColor=N.grid.tickColor}if(N.yaxis.tickColor==null){N.yaxis.tickColor=N.grid.tickColor}if(N.grid.borderColor==null){N.grid.borderColor=N.grid.color}if(N.grid.tickColor==null){N.grid.tickColor=b.color.parse(N.grid.color).scale("a",0.22).toString()}for(az=0;az<Math.max(1,N.xaxes.length);++az){N.xaxes[az]=b.extend(true,{},N.xaxis,N.xaxes[az])}for(az=0;az<Math.max(1,N.yaxes.length);++az){N.yaxes[az]=b.extend(true,{},N.yaxis,N.yaxes[az])}if(N.xaxis.noTicks&&N.xaxis.ticks==null){N.xaxis.ticks=N.xaxis.noTicks}if(N.yaxis.noTicks&&N.yaxis.ticks==null){N.yaxis.ticks=N.yaxis.noTicks}if(N.x2axis){N.x2axis.position="top";N.xaxes[1]=N.x2axis}if(N.y2axis){if(N.y2axis.autoscaleMargin===undefined){N.y2axis.autoscaleMargin=0.02}N.y2axis.position="right";N.yaxes[1]=N.y2axis}if(N.grid.coloredAreas){N.grid.markings=N.grid.coloredAreas}if(N.grid.coloredAreasColor){N.grid.markingsColor=N.grid.coloredAreasColor}if(N.lines){b.extend(true,N.series.lines,N.lines)}if(N.points){b.extend(true,N.series.points,N.points)}if(N.bars){b.extend(true,N.series.bars,N.bars)}if(N.shadowSize!=null){N.series.shadowSize=N.shadowSize}for(az=0;az<N.xaxes.length;++az){T(n,az+1).options=N.xaxes[az]}for(az=0;az<N.yaxes.length;++az){T(at,az+1).options=N.yaxes[az]}for(var aB in ah){if(N.hooks[aB]&&N.hooks[aB].length){ah[aB]=ah[aB].concat(N.hooks[aB])}}ak(ah.processOptions,[N])}function ag(az){P=W(az);au();x()}function W(aC){var aA=[];for(var az=0;az<aC.length;++az){var aB=b.extend(true,{},N.series);if(aC[az].data!=null){aB.data=aC[az].data;delete aC[az].data;b.extend(true,aB,aC[az]);aC[az].data=aB.data}else{aB.data=aC[az]}aA.push(aB)}return aA}function ay(aA,aB){var az=aA[aB+"axis"];if(typeof az=="object"){az=az.n}if(typeof az!="number"){az=1}return az}function A(aC){var aA={},az,aB;for(az=0;az<n.length;++az){aB=n[az];if(aB&&aB.used){aA["x"+aB.n]=aB.c2p(aC.left)}}for(az=0;az<at.length;++az){aB=at[az];if(aB&&aB.used){aA["y"+aB.n]=aB.c2p(aC.top)}}if(aA.x1!==undefined){aA.x=aA.x1}if(aA.y1!==undefined){aA.y=aA.y1}return aA}function ap(aD){var aB={},aA,aC,az;for(aA=0;aA<n.length;++aA){aC=n[aA];if(aC&&aC.used){az="x"+aC.n;if(aD[az]==null&&aC.n==1){az="x"}if(aD[az]!=null){aB.left=aC.p2c(aD[az]);break}}}for(aA=0;aA<at.length;++aA){aC=at[aA];if(aC&&aC.used){az="y"+aC.n;if(aD[az]==null&&aC.n==1){az="y"}if(aD[az]!=null){aB.top=aC.p2c(aD[az]);break}}}return aB}function J(){var aA=[],az,aB;for(az=0;az<n.length;++az){aB=n[az];if(aB&&aB.used){aA.push(aB)}}for(az=0;az<at.length;++az){aB=at[az];if(aB&&aB.used){aA.push(aB)}}return aA}function T(aA,az){if(!aA[az-1]){aA[az-1]={n:az,direction:aA==n?"x":"y",options:b.extend(true,{},aA==n?N.xaxis:N.yaxis)}}return aA[az-1]}function au(){var aE;var aK=P.length,az=[],aC=[];for(aE=0;aE<P.length;++aE){var aH=P[aE].color;if(aH!=null){--aK;if(typeof aH=="number"){aC.push(aH)}else{az.push(b.color.parse(P[aE].color))}}}for(aE=0;aE<aC.length;++aE){aK=Math.max(aK,aC[aE]+1)}var aA=[],aD=0;aE=0;while(aA.length<aK){var aG;if(N.colors.length==aE){aG=b.color.make(100,100,100)}else{aG=b.color.parse(N.colors[aE])}var aB=aD%2==1?-1:1;aG.scale("rgb",1+aB*Math.ceil(aD/2)*0.2);aA.push(aG);++aE;if(aE>=N.colors.length){aE=0;++aD}}var aF=0,aL;for(aE=0;aE<P.length;++aE){aL=P[aE];if(aL.color==null){aL.color=aA[aF].toString();++aF}else{if(typeof aL.color=="number"){aL.color=aA[aL.color].toString()}}if(aL.lines.show==null){var aJ,aI=true;for(aJ in aL){if(aL[aJ]&&aL[aJ].show){aI=false;break}}if(aI){aL.lines.show=true}}aL.xaxis=T(n,ay(aL,"x"));aL.yaxis=T(at,ay(aL,"y"))}}function x(){var aM=Number.POSITIVE_INFINITY,aG=Number.NEGATIVE_INFINITY,aS,aQ,aP,aL,aB,aH,aR,aN,aF,aE,aA,aY,aV,aJ;function az(aZ,a0){if(!aZ){return}aZ.datamin=aM;aZ.datamax=aG;aZ.used=false}function aD(a1,a0,aZ){if(a0<a1.datamin){a1.datamin=a0}if(aZ>a1.datamax){a1.datamax=aZ}}for(aS=0;aS<n.length;++aS){az(n[aS])}for(aS=0;aS<at.length;++aS){az(at[aS])}for(aS=0;aS<P.length;++aS){aH=P[aS];aH.datapoints={points:[]};ak(ah.processRawData,[aH,aH.data,aH.datapoints])}for(aS=0;aS<P.length;++aS){aH=P[aS];var aX=aH.data,aU=aH.datapoints.format;if(!aU){aU=[];aU.push({x:true,number:true,required:true});aU.push({y:true,number:true,required:true});if(aH.bars.show||(aH.lines.show&&aH.lines.fill)){aU.push({y:true,number:true,required:false,defaultValue:0});if(aH.bars.horizontal){delete aU[aU.length-1].y;aU[aU.length-1].x=true}}aH.datapoints.format=aU}if(aH.datapoints.pointsize!=null){continue}aH.datapoints.pointsize=aU.length;aN=aH.datapoints.pointsize;aR=aH.datapoints.points;insertSteps=aH.lines.show&&aH.lines.steps;aH.xaxis.used=aH.yaxis.used=true;for(aQ=aP=0;aQ<aX.length;++aQ,aP+=aN){aJ=aX[aQ];var aC=aJ==null;if(!aC){for(aL=0;aL<aN;++aL){aY=aJ[aL];aV=aU[aL];if(aV){if(aV.number&&aY!=null){aY=+aY;if(isNaN(aY)){aY=null}}if(aY==null){if(aV.required){aC=true}if(aV.defaultValue!=null){aY=aV.defaultValue}}}aR[aP+aL]=aY}}if(aC){for(aL=0;aL<aN;++aL){aY=aR[aP+aL];if(aY!=null){aV=aU[aL];if(aV.x){aD(aH.xaxis,aY,aY)}if(aV.y){aD(aH.yaxis,aY,aY)}}aR[aP+aL]=null}}else{if(insertSteps&&aP>0&&aR[aP-aN]!=null&&aR[aP-aN]!=aR[aP]&&aR[aP-aN+1]!=aR[aP+1]){for(aL=0;aL<aN;++aL){aR[aP+aN+aL]=aR[aP+aL]}aR[aP+1]=aR[aP-aN+1];aP+=aN}}}}for(aS=0;aS<P.length;++aS){aH=P[aS];ak(ah.processDatapoints,[aH,aH.datapoints])}for(aS=0;aS<P.length;++aS){aH=P[aS];aR=aH.datapoints.points,aN=aH.datapoints.pointsize;var aI=aM,aO=aM,aK=aG,aT=aG;for(aQ=0;aQ<aR.length;aQ+=aN){if(aR[aQ]==null){continue}for(aL=0;aL<aN;++aL){aY=aR[aQ+aL];aV=aU[aL];if(!aV){continue}if(aV.x){if(aY<aI){aI=aY}if(aY>aK){aK=aY}}if(aV.y){if(aY<aO){aO=aY}if(aY>aT){aT=aY}}}}if(aH.bars.show){if(aH.bars.barLeft==undefined){aH.bars.barLeft=aH.bars.align=="left"?0:-aH.bars.barWidth/2}var aW=aH.bars.barLeft;if(aH.bars.horizontal){aO+=aW;aT+=aW+aH.bars.barWidth}else{aI+=aW;aK+=aW+aH.bars.barWidth}}aD(aH.xaxis,aI,aK);aD(aH.yaxis,aO,aT)}b.each(J(),function(aZ,a0){if(a0.datamin==aM){a0.datamin=null}if(a0.datamax==aG){a0.datamax=null}})}function z(){F=ar.width();H=ar.height();if(window.G_vmlCanvasManager){ar.find("canvas").each(function(){this.context_=null})}ar.html("");if(ar.css("position")=="static"){ar.css("position","relative")}if(F<=0||H<=0){throw"Invalid dimensions for plot, width = "+F+", height = "+H}function az(aA){var aB=document.createElement("canvas");aB.width=F;aB.height=H;if(!aA){b(aB).css({position:"absolute",left:0,top:0})}b(aB).appendTo(ar);if(!aB.getContext){aB=window.G_vmlCanvasManager.initElement(aB)}return aB}aw=az(true);G=aw.getContext("2d");ab=az();y=ab.getContext("2d")}function ae(){w=b([ab,aw]);if(N.grid.hoverable){w.mousemove(Y);w.mouseleave(k)}if(N.grid.clickable){w.click(Q)}ak(ah.bindEvents,[w])}function p(aE){function aA(aF){return aF}var aD,az,aB=aE.options.transform||aA,aC=aE.options.inverseTransform;if(aE.direction=="x"){aD=aE.scale=h/(aB(aE.max)-aB(aE.min));az=aB(aE.min);if(aB==aA){aE.p2c=function(aF){return(aF-az)*aD}}else{aE.p2c=function(aF){return(aB(aF)-az)*aD}}if(!aC){aE.c2p=function(aF){return az+aF/aD}}else{aE.c2p=function(aF){return aC(az+aF/aD)}}}else{aD=aE.scale=u/(aB(aE.max)-aB(aE.min));az=aB(aE.max);if(aB==aA){aE.p2c=function(aF){return(az-aF)*aD}}else{aE.p2c=function(aF){return(az-aB(aF))*aD}}if(!aC){aE.c2p=function(aF){return az-aF/aD}}else{aE.c2p=function(aF){return aC(az-aF/aD)}}}}function C(aJ,aI,aN){if(!aN){return{}}var aS=aN*Math.PI/180,az=Math.sin(aS),aA=Math.cos(aS);var aM=aA*aJ,aD=az*aJ;var aL=-az*aI,aC=aA*aI;var aK=aA*aJ-az*aI,aB=az*aJ+aA*aI;var aR=Math.min(0,aM,aL,aK),aQ=Math.max(0,aM,aL,aK),aP=Math.min(0,aD,aC,aB),aO=Math.max(0,aD,aC,aB);var aF={x:aI/2*az,y:aI/2*aA};var aT={x:(aJ*aA+aI/2*az),y:(aJ*az-aI/2*aA)};var aG,aH,aE;if(aN<0){aH={x:(aJ*aA+aI*az),y:(aJ*az-aI*aA)};aE={x:aI*az,y:aI*aA}}else{aG={x:aM,y:aD};aH={x:aI*az,y:-aI*aA}}return{width:(aQ-aR),height:(aO-aP),a_left:aF,a_right:aT,topmost:aG,bottommost:aH,leftmost:aE}}function al(aA){var aB=aA.options.labelAngle;if(aB==undefined||aB==0){return{}}var aC=aA.box;var aF=C(aA.options.origWidth,aA.options.origHeight,aB);var aD="left";var aH=0,aG=0,aE,az;if(aA.position=="bottom"){aE=aC.top+aC.padding;if(aB<0){if(g){aH=-aF.a_left.x}else{aH=aF.a_left.x}}else{aD="right";aH=-aF.a_right.x;if(g){aE+=aF.topmost.y}}}else{if(aA.position=="top"){aE=aC.top;if(g&&aB>0){aE+=aC.height-aC.padding+aF.bottommost.y}if(aB<0){aD="right"}if(!g&&aB<0){aH=-aF.width-aF.a_left.x}else{if(aB<0){aH=-aF.a_right.x}else{aH=-aF.a_left.x}}}else{if(aA.position=="left"){aD="right";az=aC.left;if(aB<0){aG=aF.a_right.y;if(g){az-=aF.leftmost.x}}else{if(!g){aG=-aF.a_left.y}else{aG=aF.a_right.y}}}else{if(aA.position=="right"){aD="left";az=aC.left+aC.padding;if(aB<0){if(g){az-=aF.leftmost.x}aG=-aF.a_left.y}else{if(!g){aG=-aF.height+aF.a_left.y}else{aG=-aF.a_left.y}}}}}}return{top:aE,left:az,oTop:aG,oLeft:aH,align:aD}}function K(aB){if(!aB){return}var az=aB.options,aD,aI=aB.ticks||[],aG=[],aC,aJ=az.labelWidth,aE=az.labelHeight,aA;function aF(aL,aK){return b('<div style="position:absolute;top:-10000px;'+aK+'"><div class="'+aB.direction+"Axis "+aB.direction+aB.n+'Axis">'+aL.join("")+"</div></div>").appendTo(ar)}if(aB.direction=="x"&&aB.options.labelAngle==0){if(aJ==null){aJ=Math.floor(F/(aI.length>0?aI.length:1))}if(aE==null){aG=[];for(aD=0;aD<aI.length;++aD){aC=aI[aD].label;if(aC){aG.push('<div class="tickLabel" style="float:left;width:'+aJ+'px">'+aC+"</div>")}}if(aG.length>0){aG.push('<div style="clear:left"></div>');aA=aF(aG,"width:10000px;");aE=aA.height();aA.remove()}}}else{if(aJ==null||aE==null){for(aD=0;aD<aI.length;++aD){aC=aI[aD].label;if(aC){aG.push('<div class="tickLabel">'+aC+"</div>")}}if(aG.length>0){aA=aF(aG,"");if(aB.options.labelAngle!=0){var aH=C(aA.children().width(),aA.find("div.tickLabel").height(),aB.options.labelAngle);aB.options.origHeight=aA.find("div.tickLabel").height();aB.options.origWidth=aA.children().width();if(aE==null){aE=aH.height}if(aJ==null){aJ=aH.width}}else{if(aJ==null){aJ=aA.children().width()}if(aE==null){aE=aA.find("div.tickLabel").height()}}aA.remove()}}}if(aJ==null){aJ=0}if(aE==null){aE=0}aB.labelWidth=aJ;aB.labelHeight=aE}function V(aB){if(!aB||!aB.labelWidth||!aB.labelHeight){return}var aA=aB.labelWidth,aJ=aB.labelHeight,aF=aB.options.position,aD=aB.options.tickLength,aE=N.grid.axisMargin,aH=N.grid.labelMargin,aI=aB.direction=="x"?n:at,aC;var az=b.grep(aI,function(aL){return aL&&aL.options.position==aF&&(aL.labelHeight||aL.labelWidth)});if(b.inArray(aB,az)==az.length-1){aE=0}if(aD==null){aD="full"}var aG=b.grep(aI,function(aL){return aL&&(aL.labelHeight||aL.labelWidth)});var aK=b.inArray(aB,aG)==0;if(!aK&&aD=="full"){aD=5}if(!isNaN(+aD)){aH+=+aD}if(aB.direction=="x"){aJ+=aH;if(aF=="bottom"){o.bottom+=aJ+aE;aB.box={top:H-o.bottom,height:aJ}}else{aB.box={top:o.top+aE,height:aJ};o.top+=aJ+aE}}else{aA+=aH;if(aF=="left"){aB.box={left:o.left+aE,width:aA};o.left+=aA+aE}else{o.right+=aA+aE;aB.box={left:F-o.right,width:aA}}}aB.position=aF;aB.tickLength=aD;aB.box.padding=aH;aB.innermost=aK}function c(az){if(!az||!az.labelWidth||!az.labelHeight){return}if(az.direction=="x"){az.box.left=o.left;az.box.width=h}else{az.box.top=o.top;az.box.height=u}}function r(){var aE=J(),aB,aA;for(aA=0;aA<aE.length;++aA){l(aE[aA])}o.left=o.right=o.top=o.bottom=0;if(N.grid.show){for(aA=0;aA<aE.length;++aA){R(aE[aA]);O(aE[aA]);an(aE[aA],aE[aA].ticks)}for(aB=0;aB<n.length;++aB){K(n[aB])}for(aB=0;aB<at.length;++aB){K(at[aB])}for(aB=n.length-1;aB>=0;--aB){V(n[aB])}for(aB=at.length-1;aB>=0;--aB){V(at[aB])}var aD=0;for(var aC=0;aC<P.length;++aC){aD=Math.max(aD,2*(P[aC].points.radius+P[aC].points.lineWidth/2))}for(var az in o){o[az]+=N.grid.borderWidth;o[az]=Math.max(aD,o[az])}}h=F-o.left-o.right;u=H-o.bottom-o.top;for(aA=0;aA<aE.length;++aA){p(aE[aA])}if(N.grid.show){for(aA=0;aA<aE.length;++aA){c(aE[aA])}j()}m()}function l(aD){var aE=aD.options,aC=+(aE.min!=null?aE.min:aD.datamin),az=+(aE.max!=null?aE.max:aD.datamax),aG=az-aC;if(aG==0){var aA=az==0?1:0.01;if(aE.min==null){aC-=aA}if(aE.max==null||aE.min!=null){az+=aA}}else{var aF=aE.autoscaleMargin;var aB=aE.autoscaleMax;if(aF!=null){if(aE.min==null){aC-=aG*aF;if(aC<0&&aD.datamin!=null&&aD.datamin>=0){aC=0}}if(aE.max==null){az+=aG*aF;az=aB&&(az>aB)?aB:az;if(az>0&&aD.datamax!=null&&aD.datamax<=0){az=0}}}}aD.min=aC;aD.max=az}function R(aE){var aK=aE.options;var aF;if(typeof aK.ticks=="number"&&aK.ticks>0){aF=aK.ticks}else{if(aE.direction=="x"){aF=0.3*Math.sqrt(F)}else{aF=0.3*Math.sqrt(H)}}var aR=(aE.max-aE.min)/aF,aM,az,aL,aP,aQ,aO,aG;if(aK.mode=="time"){var aH={second:1000,minute:60*1000,hour:60*60*1000,day:24*60*60*1000,month:30*24*60*60*1000,year:365.2425*24*60*60*1000};var aI=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];var aA=0;if(aK.minTickSize!=null){if(typeof aK.tickSize=="number"){aA=aK.tickSize}else{aA=aK.minTickSize[0]*aH[aK.minTickSize[1]]}}for(var aQ=0;aQ<aI.length-1;++aQ){if(aR<(aI[aQ][0]*aH[aI[aQ][1]]+aI[aQ+1][0]*aH[aI[aQ+1][1]])/2&&aI[aQ][0]*aH[aI[aQ][1]]>=aA){break}}aM=aI[aQ][0];aL=aI[aQ][1];if(aL=="year"){aO=Math.pow(10,Math.floor(Math.log(aR/aH.year)/Math.LN10));aG=(aR/aH.year)/aO;if(aG<1.5){aM=1}else{if(aG<3){aM=2}else{if(aG<7.5){aM=5}else{aM=10}}}aM*=aO}aE.tickSize=aK.tickSize||[aM,aL];az=function(aV){var a0=[],aY=aV.tickSize[0],a1=aV.tickSize[1],aZ=new Date(aV.min);var aU=aY*aH[a1];if(a1=="second"){aZ.setUTCSeconds(b.plot.floorInBase(aZ.getUTCSeconds(),aY))}if(a1=="minute"){aZ.setUTCMinutes(b.plot.floorInBase(aZ.getUTCMinutes(),aY))}if(a1=="hour"){aZ.setUTCHours(b.plot.floorInBase(aZ.getUTCHours(),aY))}if(a1=="month"){aZ.setUTCMonth(b.plot.floorInBase(aZ.getUTCMonth(),aY))}if(a1=="year"){aZ.setUTCFullYear(b.plot.floorInBase(aZ.getUTCFullYear(),aY))}aZ.setUTCMilliseconds(0);if(aU>=aH.minute){aZ.setUTCSeconds(0)}if(aU>=aH.hour){aZ.setUTCMinutes(0)}if(aU>=aH.day){aZ.setUTCHours(0)}if(aU>=aH.day*4){aZ.setUTCDate(1)}if(aU>=aH.year){aZ.setUTCMonth(0)}var a3=0,a2=Number.NaN,aW;do{aW=a2;a2=aZ.getTime();a0.push(a2);if(a1=="month"){if(aY<1){aZ.setUTCDate(1);var aT=aZ.getTime();aZ.setUTCMonth(aZ.getUTCMonth()+1);var aX=aZ.getTime();aZ.setTime(a2+a3*aH.hour+(aX-aT)*aY);a3=aZ.getUTCHours();aZ.setUTCHours(0)}else{aZ.setUTCMonth(aZ.getUTCMonth()+aY)}}else{if(a1=="year"){aZ.setUTCFullYear(aZ.getUTCFullYear()+aY)}else{aZ.setTime(a2+aU)}}}while(a2<aV.max&&a2!=aW);return a0};aP=function(aT,aW){var aY=new Date(aT);if(aK.timeformat!=null){return b.plot.formatDate(aY,aK.timeformat,aK.monthNames)}var aU=aW.tickSize[0]*aH[aW.tickSize[1]];var aV=aW.max-aW.min;var aX=(aK.twelveHourClock)?" %p":"";if(aU<aH.minute){fmt="%h:%M:%S"+aX}else{if(aU<aH.day){if(aV<2*aH.day){fmt="%h:%M"+aX}else{fmt="%b %d %h:%M"+aX}}else{if(aU<aH.month){fmt="%b %d"}else{if(aU<aH.year){if(aV<aH.year){fmt="%b"}else{fmt="%b %y"}}else{fmt="%y"}}}}return b.plot.formatDate(aY,fmt,aK.monthNames)}}else{var aS=aK.tickDecimals;var aN=-Math.floor(Math.log(aR)/Math.LN10);if(aS!=null&&aN>aS){aN=aS}aO=Math.pow(10,-aN);aG=aR/aO;if(aG<1.5){aM=1}else{if(aG<3){aM=2;if(aG>2.25&&(aS==null||aN+1<=aS)){aM=2.5;++aN}}else{if(aG<7.5){aM=5}else{aM=10}}}aM*=aO;if(aK.minTickSize!=null&&aM<aK.minTickSize){aM=aK.minTickSize}aE.tickDecimals=Math.max(0,aS!=null?aS:aN);aE.tickSize=aK.tickSize||aM;az=function(aV){var aX=[];var aY=b.plot.floorInBase(aV.min,aV.tickSize),aU=0,aT=Number.NaN,aW;do{aW=aT;aT=aY+aU*aV.tickSize;aX.push(aT);++aU}while(aT<aV.max&&aT!=aW);return aX};aP=function(aT,aU){return aT.toFixed(aU.tickDecimals)}}if(aK.alignTicksWithAxis!=null){var aD=(aE.direction=="x"?n:at)[aK.alignTicksWithAxis-1];if(aD&&aD.used&&aD!=aE){var aJ=az(aE);if(aJ.length>0){if(aK.min==null){aE.min=Math.min(aE.min,aJ[0])}if(aK.max==null&&aJ.length>1){aE.max=Math.max(aE.max,aJ[aJ.length-1])}}az=function(aV){var aW=[],aT,aU;for(aU=0;aU<aD.ticks.length;++aU){aT=(aD.ticks[aU].v-aD.min)/(aD.max-aD.min);aT=aV.min+aT*(aV.max-aV.min);aW.push(aT)}return aW};if(aE.mode!="time"&&aK.tickDecimals==null){var aC=Math.max(0,-Math.floor(Math.log(aR)/Math.LN10)+1),aB=az(aE);if(!(aB.length>1&&/\..*0$/.test((aB[1]-aB[0]).toFixed(aC)))){aE.tickDecimals=aC}}}}aE.tickGenerator=az;if(b.isFunction(aK.tickFormatter)){aE.tickFormatter=function(aT,aU){return""+aK.tickFormatter(aT,aU)}}else{aE.tickFormatter=aP}}function O(aD){aD.ticks=[];var aF=aD.options.ticks,aE=[];if(aF==null||(typeof aF=="number"&&aF>0)){aE=aD.tickGenerator(aD)}else{if(aF){if(b.isFunction(aF)){aE=aF({min:aD.min,max:aD.max})}else{aE=aF}}}var aC,az;for(aC=0;aC<aE.length;++aC){var aA=null;var aB=aE[aC];if(typeof aB=="object"){az=aB[0];if(aB.length>1){aA=aB[1]}}else{az=aB}if(aA==null){aA=aD.tickFormatter(az,aD)}aD.ticks[aC]={v:az,label:aA}}}function an(az,aA){if(az.options.autoscaleMargin&&aA.length>0){if(az.options.min==null){az.min=Math.min(az.min,aA[0].v)}if(az.options.max==null&&aA.length>1){az.max=Math.max(az.max,aA[aA.length-1].v);if(az.options.autoscaleMax){az.max=Math.min(az.max,az.options.autoscaleMax)}}}}function U(){G.clearRect(0,0,F,H);var aA=N.grid;if(aA.show&&aA.backgroundColor){M()}if(aA.show&&!aA.aboveData){aa()}for(var az=0;az<P.length;++az){ak(ah.drawSeries,[G,P[az]]);d(P[az])}ak(ah.draw,[G]);if(aA.show&&aA.aboveData){aa()}}function B(az,aG){var aC,aF,aE,aD,aB;aD=J();for(i=0;i<aD.length;++i){aC=aD[i];if(aC.direction==aG){aB=aG+aC.n+"axis";if(!az[aB]&&aC.n==1){aB=aG+"axis"}if(az[aB]){aF=az[aB].from;aE=az[aB].to;break}}}if(!az[aB]){aC=aG=="x"?n[0]:at[0];aF=az[aG+"1"];aE=az[aG+"2"]}if(aF!=null&&aE!=null&&aF>aE){var aA=aF;aF=aE;aE=aA}return{from:aF,to:aE,axis:aC}}function M(){G.save();G.translate(o.left,o.top);G.fillStyle=aj(N.grid.backgroundColor,u,0,"rgba(255, 255, 255, 0)");G.fillRect(0,0,h,u);G.restore()}function aa(){var aD;G.save();G.translate(o.left,o.top);var aF=N.grid.markings;if(aF){if(b.isFunction(aF)){var aI=ao.getAxes();aI.xmin=aI.xaxis.min;aI.xmax=aI.xaxis.max;aI.ymin=aI.yaxis.min;aI.ymax=aI.yaxis.max;aF=aF(aI)}for(aD=0;aD<aF.length;++aD){var aB=aF[aD],aA=B(aB,"x"),aG=B(aB,"y");if(aA.from==null){aA.from=aA.axis.min}if(aA.to==null){aA.to=aA.axis.max}if(aG.from==null){aG.from=aG.axis.min}if(aG.to==null){aG.to=aG.axis.max}if(aA.to<aA.axis.min||aA.from>aA.axis.max||aG.to<aG.axis.min||aG.from>aG.axis.max){continue}aA.from=Math.max(aA.from,aA.axis.min);aA.to=Math.min(aA.to,aA.axis.max);aG.from=Math.max(aG.from,aG.axis.min);aG.to=Math.min(aG.to,aG.axis.max);if(aA.from==aA.to&&aG.from==aG.to){continue}aA.from=aA.axis.p2c(aA.from);aA.to=aA.axis.p2c(aA.to);aG.from=aG.axis.p2c(aG.from);aG.to=aG.axis.p2c(aG.to);if(aA.from==aA.to||aG.from==aG.to){G.beginPath();G.strokeStyle=aB.color||N.grid.markingsColor;G.lineWidth=aB.lineWidth||N.grid.markingsLineWidth;G.moveTo(aA.from,aG.from);G.lineTo(aA.to,aG.to);G.stroke()}else{G.fillStyle=aB.color||N.grid.markingsColor;G.fillRect(aA.from,aG.to,aA.to-aA.from,aG.from-aG.to)}}}var aI=J(),aK=N.grid.borderWidth;for(var aC=0;aC<aI.length;++aC){var az=aI[aC],aE=az.box,aO=az.tickLength,aL,aJ,aN,aH;if(az.ticks.length==0){continue}G.strokeStyle=az.options.tickColor||b.color.parse(az.options.color).scale("a",0.22).toString();G.lineWidth=1;if(az.direction=="x"){aL=0;if(aO=="full"){aJ=(az.position=="top"?0:u)}else{aJ=aE.top-o.top+(az.position=="top"?aE.height:0)}}else{aJ=0;if(aO=="full"){aL=(az.position=="left"?0:h)}else{aL=aE.left-o.left+(az.position=="left"?aE.width:0)}}if(!az.innermost){G.beginPath();aN=aH=0;if(az.direction=="x"){aN=h}else{aH=u}if(G.lineWidth==1){aL=Math.floor(aL)+0.5;aJ=Math.floor(aJ)+0.5}G.moveTo(aL,aJ);G.lineTo(aL+aN,aJ+aH);G.stroke()}G.beginPath();for(aD=0;aD<az.ticks.length;++aD){var aM=az.ticks[aD].v;aN=aH=0;if(aM<az.min||aM>az.max||(aO=="full"&&aK>0&&(aM==az.min||aM==az.max))){continue}if(az.direction=="x"){aL=az.p2c(aM);aH=aO=="full"?-u:aO;if(az.position=="top"){aH=-aH}}else{aJ=az.p2c(aM);aN=aO=="full"?-h:aO;if(az.position=="left"){aN=-aN}}if(G.lineWidth==1){if(az.direction=="x"){aL=Math.floor(aL)+0.5}else{aJ=Math.floor(aJ)+0.5}}G.moveTo(aL,aJ);G.lineTo(aL+aN,aJ+aH)}G.stroke()}if(aK){G.lineWidth=aK;G.strokeStyle=N.grid.borderColor;G.strokeRect(-aK/2,-aK/2,h+aK,u+aK)}G.restore()}function j(){var aB=undefined,aD=function(){},aN=["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"],aK=["","-webkit-","-moz-","-o-","-ms-"],aE=document.createElement("flotelement");for(var aG in aN){if(aE.style[aN[aG]]!==undefined){aB=aK[aG];break}}if(aB!=undefined){g=true;aD=function(aR,aQ){aR.push(aB+"transform:rotate("+-aQ.options.labelAngle+"deg)");aR.push(aB+"transform-origin:top left")}}else{if(typeof aE.style.filter=="string"||typeof aE.style.filters=="object"){aD=function(aT,aS){var aQ=aS.options.labelAngle*Math.PI/180,aU=Math.cos(aQ),aR=Math.sin(aQ);aT.push("filter:progid:DXImageTransform.Microsoft.Matrix(M11="+aU+", M12="+aR+", M21="+(-aR)+", M22="+aU+",sizingMethod='auto expand'")}}}ar.find(".tickLabels").remove();var aJ=['<div class="tickLabels">'];var aM=J();for(var aF=0;aF<aM.length;++aF){var aC=aM[aF],aI=aC.box;var aA=al(aC);aJ.push('<div class="'+aC.direction+"Axis "+aC.direction+aC.n+'Axis" style="color:'+aC.options.color+'">');for(var aG=0;aG<aC.ticks.length;++aG){var aH=aC.ticks[aG];if(!aH.label||aH.v<aC.min||aH.v>aC.max){continue}var aO={},aL;if(aC.direction=="x"){if(aC.options.labelAngle!=0){aL=aA.align;aO.left=Math.round(o.left+aC.p2c(aH.v));aO.left+=aA.oLeft;aO.top=aA.top}else{aL="center";aO.left=Math.round(o.left+aC.p2c(aH.v)-aC.labelWidth/2);if(aC.position=="bottom"){aO.top=aI.top+aI.padding}else{aO.bottom=H-(aI.top+aI.height-aI.padding)}}}else{if(aC.options.labelAngle!=0){aL=aA.align;aO.top=Math.round(o.top+aC.p2c(aH.v));aO.top+=aA.oTop;aO.left=aA.left}else{aO.top=Math.round(o.top+aC.p2c(aH.v)-aC.labelHeight/2);if(aC.position=="left"){aO.right=F-(aI.left+aI.width-aI.padding);aL="right"}else{aO.left=aI.left+aI.padding;aL="left"}}}aO.width=(aC.options.labelAngle!=0)?aC.options.origWidth:aC.labelWidth;var az=["position:absolute","text-align:"+aL];for(var aP in aO){az.push(aP+":"+aO[aP]+"px")}if(aC.options.labelAngle!=0){aD(az,aC)}aJ.push('<div class="tickLabel" style="'+az.join(";")+'">'+aH.label+"</div>")}aJ.push("</div>")}aJ.push("</div>");ar.append(aJ.join(""))}function d(az){if(az.lines.show){aq(az)}if(az.bars.show){e(az)}if(az.points.show){am(az)}}function aq(aC){function aB(aN,aO,aG,aS,aR){var aT=aN.points,aH=aN.pointsize,aL=null,aK=null;G.beginPath();for(var aM=aH;aM<aT.length;aM+=aH){var aJ=aT[aM-aH],aQ=aT[aM-aH+1],aI=aT[aM],aP=aT[aM+1];if(aJ==null||aI==null){continue}if(aQ<=aP&&aQ<aR.min){if(aP<aR.min){continue}aJ=(aR.min-aQ)/(aP-aQ)*(aI-aJ)+aJ;aQ=aR.min}else{if(aP<=aQ&&aP<aR.min){if(aQ<aR.min){continue}aI=(aR.min-aQ)/(aP-aQ)*(aI-aJ)+aJ;aP=aR.min}}if(aQ>=aP&&aQ>aR.max){if(aP>aR.max){continue}aJ=(aR.max-aQ)/(aP-aQ)*(aI-aJ)+aJ;aQ=aR.max}else{if(aP>=aQ&&aP>aR.max){if(aQ>aR.max){continue}aI=(aR.max-aQ)/(aP-aQ)*(aI-aJ)+aJ;aP=aR.max}}if(aJ<=aI&&aJ<aS.min){if(aI<aS.min){continue}aQ=(aS.min-aJ)/(aI-aJ)*(aP-aQ)+aQ;aJ=aS.min}else{if(aI<=aJ&&aI<aS.min){if(aJ<aS.min){continue}aP=(aS.min-aJ)/(aI-aJ)*(aP-aQ)+aQ;aI=aS.min}}if(aJ>=aI&&aJ>aS.max){if(aI>aS.max){continue}aQ=(aS.max-aJ)/(aI-aJ)*(aP-aQ)+aQ;aJ=aS.max}else{if(aI>=aJ&&aI>aS.max){if(aJ>aS.max){continue}aP=(aS.max-aJ)/(aI-aJ)*(aP-aQ)+aQ;aI=aS.max}}if(aJ!=aL||aQ!=aK){G.moveTo(aS.p2c(aJ)+aO,aR.p2c(aQ)+aG)}aL=aI;aK=aP;G.lineTo(aS.p2c(aI)+aO,aR.p2c(aP)+aG)}G.stroke()}function aD(aG,aO,aN){var aU=aG.points,aT=aG.pointsize,aL=Math.min(Math.max(0,aN.min),aN.max),aV=0,aS,aR=false,aK=1,aJ=0,aP=0;while(true){if(aT>0&&aV>aU.length+aT){break}aV+=aT;var aX=aU[aV-aT],aI=aU[aV-aT+aK],aW=aU[aV],aH=aU[aV+aK];if(aR){if(aT>0&&aX!=null&&aW==null){aP=aV;aT=-aT;aK=2;continue}if(aT<0&&aV==aJ+aT){G.fill();aR=false;aT=-aT;aK=1;aV=aJ=aP+aT;continue}}if(aX==null||aW==null){continue}if(aX<=aW&&aX<aO.min){if(aW<aO.min){continue}aI=(aO.min-aX)/(aW-aX)*(aH-aI)+aI;aX=aO.min}else{if(aW<=aX&&aW<aO.min){if(aX<aO.min){continue}aH=(aO.min-aX)/(aW-aX)*(aH-aI)+aI;aW=aO.min}}if(aX>=aW&&aX>aO.max){if(aW>aO.max){continue}aI=(aO.max-aX)/(aW-aX)*(aH-aI)+aI;aX=aO.max}else{if(aW>=aX&&aW>aO.max){if(aX>aO.max){continue}aH=(aO.max-aX)/(aW-aX)*(aH-aI)+aI;aW=aO.max}}if(!aR){G.beginPath();G.moveTo(aO.p2c(aX),aN.p2c(aL));aR=true}if(aI>=aN.max&&aH>=aN.max){G.lineTo(aO.p2c(aX),aN.p2c(aN.max));G.lineTo(aO.p2c(aW),aN.p2c(aN.max));continue}else{if(aI<=aN.min&&aH<=aN.min){G.lineTo(aO.p2c(aX),aN.p2c(aN.min));G.lineTo(aO.p2c(aW),aN.p2c(aN.min));continue}}var aM=aX,aQ=aW;if(aI<=aH&&aI<aN.min&&aH>=aN.min){aX=(aN.min-aI)/(aH-aI)*(aW-aX)+aX;aI=aN.min}else{if(aH<=aI&&aH<aN.min&&aI>=aN.min){aW=(aN.min-aI)/(aH-aI)*(aW-aX)+aX;aH=aN.min}}if(aI>=aH&&aI>aN.max&&aH<=aN.max){aX=(aN.max-aI)/(aH-aI)*(aW-aX)+aX;aI=aN.max}else{if(aH>=aI&&aH>aN.max&&aI<=aN.max){aW=(aN.max-aI)/(aH-aI)*(aW-aX)+aX;aH=aN.max}}if(aX!=aM){G.lineTo(aO.p2c(aM),aN.p2c(aI))}G.lineTo(aO.p2c(aX),aN.p2c(aI));G.lineTo(aO.p2c(aW),aN.p2c(aH));if(aW!=aQ){G.lineTo(aO.p2c(aW),aN.p2c(aH));G.lineTo(aO.p2c(aQ),aN.p2c(aH))}}}G.save();G.translate(o.left,o.top);G.lineJoin="round";var aE=aC.lines.lineWidth,az=aC.shadowSize;if(aE>0&&az>0){G.lineWidth=az;G.strokeStyle="rgba(0,0,0,0.1)";var aF=Math.PI/18;aB(aC.datapoints,Math.sin(aF)*(aE/2+az/2),Math.cos(aF)*(aE/2+az/2),aC.xaxis,aC.yaxis);G.lineWidth=az/2;aB(aC.datapoints,Math.sin(aF)*(aE/2+az/4),Math.cos(aF)*(aE/2+az/4),aC.xaxis,aC.yaxis)}G.lineWidth=aE;G.strokeStyle=aC.color;var aA=ac(aC.lines,aC.color,0,u);if(aA){G.fillStyle=aA;aD(aC.datapoints,aC.xaxis,aC.yaxis)}if(aE>0){aB(aC.datapoints,0,0,aC.xaxis,aC.yaxis)}G.restore()}function am(aC){function aF(aL,aK,aS,aI,aQ,aR,aO,aH){var aP=aL.points,aG=aL.pointsize;for(var aJ=0;aJ<aP.length;aJ+=aG){var aN=aP[aJ],aM=aP[aJ+1];if(aN==null||aN<aR.min||aN>aR.max||aM<aO.min||aM>aO.max){continue}G.beginPath();aN=aR.p2c(aN);aM=aO.p2c(aM)+aI;if(aH=="circle"){G.arc(aN,aM,aK,0,aQ?Math.PI:Math.PI*2,false)}else{aH(G,aN,aM,aK,aQ)}G.closePath();if(aS){G.fillStyle=aS;G.fill()}G.stroke()}}G.save();G.translate(o.left,o.top);var aE=aC.points.lineWidth,aA=aC.shadowSize,az=aC.points.radius,aD=aC.points.symbol;if(aE>0&&aA>0){var aB=aA/2;G.lineWidth=aB;G.strokeStyle="rgba(0,0,0,0.1)";aF(aC.datapoints,az,null,aB+aB/2,true,aC.xaxis,aC.yaxis,aD);G.strokeStyle="rgba(0,0,0,0.2)";aF(aC.datapoints,az,null,aB/2,true,aC.xaxis,aC.yaxis,aD)}G.lineWidth=aE;G.strokeStyle=aC.color;aF(aC.datapoints,az,ac(aC.points,aC.color),0,false,aC.xaxis,aC.yaxis,aD);G.restore()}function D(aL,aK,aT,aG,aO,aD,aB,aJ,aI,aS,aP,aA){var aC,aR,aH,aN,aE,az,aM,aF,aQ;if(aP){aF=az=aM=true;aE=false;aC=aT;aR=aL;aN=aK+aG;aH=aK+aO;if(aR<aC){aQ=aR;aR=aC;aC=aQ;aE=true;az=false}}else{aE=az=aM=true;aF=false;aC=aL+aG;aR=aL+aO;aH=aT;aN=aK;if(aN<aH){aQ=aN;aN=aH;aH=aQ;aF=true;aM=false}}if(aR<aJ.min||aC>aJ.max||aN<aI.min||aH>aI.max){return}if(aC<aJ.min){aC=aJ.min;aE=false}if(aR>aJ.max){aR=aJ.max;az=false}if(aH<aI.min){aH=aI.min;aF=false}if(aN>aI.max){aN=aI.max;aM=false}aC=aJ.p2c(aC);aH=aI.p2c(aH);aR=aJ.p2c(aR);aN=aI.p2c(aN);if(aB){aS.beginPath();aS.moveTo(aC,aH);aS.lineTo(aC,aN);aS.lineTo(aR,aN);aS.lineTo(aR,aH);aS.fillStyle=aB(aH,aN);aS.fill()}if(aA>0&&(aE||az||aM||aF)){aS.beginPath();aS.moveTo(aC,aH+aD);if(aE){aS.lineTo(aC,aN+aD)}else{aS.moveTo(aC,aN+aD)}if(aM){aS.lineTo(aR,aN+aD)}else{aS.moveTo(aR,aN+aD)}if(az){aS.lineTo(aR,aH+aD)}else{aS.moveTo(aR,aH+aD)}if(aF){aS.lineTo(aC,aH+aD)}else{aS.moveTo(aC,aH+aD)}aS.stroke()}}function e(aB){function aA(aH,aG,aJ,aE,aI,aL,aK){var aM=aH.points,aD=aH.pointsize;for(var aF=0;aF<aM.length;aF+=aD){if(aM[aF]==null){continue}D(aM[aF],aM[aF+1],aM[aF+2],aG,aJ,aE,aI,aL,aK,G,aB.bars.horizontal,aB.bars.lineWidth)}}G.save();G.translate(o.left,o.top);G.lineWidth=aB.bars.lineWidth;G.strokeStyle=aB.color;var az=aB.bars.barLeft;var aC=aB.bars.fill?function(aD,aE){return ac(aB.bars,aB.color,aD,aE)}:null;aA(aB.datapoints,az,az+aB.bars.barWidth,0,aC,aB.xaxis,aB.yaxis);G.restore()}function ac(aB,az,aA,aD){var aC=aB.fill;if(!aC){return null}if(aB.fillColor){return aj(aB.fillColor,aA,aD,az)}var aE=b.color.parse(az);aE.a=typeof aC=="number"?aC:0.4;aE.normalize();return aE.toString()}function m(){ar.find(".legend").remove();if(!N.legend.show){return}var aF=[],aD=false,aL=N.legend.labelFormatter,aK,aH;for(var aC=0;aC<P.length;++aC){aK=P[aC];aH=aK.label;if(!aH){continue}if(aC%N.legend.noColumns==0){if(aD){aF.push("</tr>")}aF.push("<tr>");aD=true}if(aL){aH=aL(aH,aK)}aF.push('<td class="legendColorBox"><div style="border:1px solid '+N.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+aK.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+aH+"</td>")}if(aD){aF.push("</tr>")}if(aF.length==0){return}var aJ='<table style="color:'+N.grid.color+'">'+aF.join("")+"</table>";if(N.legend.container!=null){b(N.legend.container).html(aJ)}else{var aG="",aA=N.legend.position,aB=N.legend.margin;if(aB[0]==null){aB=[aB,aB]}if(aA.charAt(0)=="n"){aG+="top:"+(aB[1]+o.top)+"px;"}else{if(aA.charAt(0)=="s"){aG+="bottom:"+(aB[1]+o.bottom)+"px;"}}if(aA.charAt(1)=="e"){aG+="right:"+(aB[0]+o.right)+"px;"}else{if(aA.charAt(1)=="w"){aG+="left:"+(aB[0]+o.left)+"px;"}}var aI=b('<div class="legend">'+aJ.replace('style="','style="position:absolute;'+aG+";")+"</div>").appendTo(ar);if(N.legend.backgroundOpacity!=0){var aE=N.legend.backgroundColor;if(aE==null){aE=N.grid.backgroundColor;if(aE&&typeof aE=="string"){aE=b.color.parse(aE)}else{aE=b.color.extract(aI,"background-color")}aE.a=1;aE=aE.toString()}var az=aI.children();b('<div style="position:absolute;width:'+az.width()+"px;height:"+az.height()+"px;"+aG+"background-color:"+aE+';"> </div>').prependTo(aI).css("opacity",N.legend.backgroundOpacity)}}}var Z=[],L=null;function ax(aI,aG,aC){var aP=N.grid.mouseActiveRadius,a3=aP*aP+1,a0=null,aS=false,aY,aW,a2=[];for(aY=P.length-1;aY>=0;--aY){if(!aC(P[aY])){continue}var aQ=P[aY],aH=aQ.xaxis,aF=aQ.yaxis,aX=aQ.datapoints.points,aU=aQ.datapoints.pointsize,aR=aH.c2p(aI),aO=aF.c2p(aG),aB=aP/aH.scale,az=aP/aF.scale;if(aQ.lines.show||aQ.points.show){for(aW=0;aW<aX.length;aW+=aU){var aL=aX[aW],aJ=aX[aW+1];if(aL==null){continue}if(aL-aR>aB||aL-aR<-aB||aJ-aO>az||aJ-aO<-az){continue}var aA=[aY,aW/aU];a2.push(aA);var aN=Math.abs(aH.p2c(aL)-aI),aM=Math.abs(aF.p2c(aJ)-aG),aT=aN*aN+aM*aM;if(aT<a3){a3=aT;a0=aA}}}if(aQ.bars.show&&!a0){var aE=aQ.bars.barLeft,aZ=aE+aQ.bars.barWidth;for(aW=0;aW<aX.length;aW+=aU){var aL=aX[aW],aJ=aX[aW+1],a1=aX[aW+2];if(aL==null){continue}if(P[aY].bars.horizontal?(aR<=Math.max(a1,aL)&&aR>=Math.min(a1,aL)&&aO>=aJ+aE&&aO<=aJ+aZ):(aR>=aL+aE&&aR<=aL+aZ&&aO>=Math.min(a1,aJ)&&aO<=Math.max(a1,aJ))){a0=[aY,aW/aU]}}}}if(a0){if(a2.length==0){a2.push(a0)}var aD={item:null,all:[]};var aK=null;for(var aV=0;aV<a2.length;aV+=1){aK=a2[aV];aY=aK[0];aW=aK[1];aU=P[aY].datapoints.pointsize;return_item={datapoint:P[aY].datapoints.points.slice(aW*aU,(aW+1)*aU),dataIndex:aW,series:P[aY],seriesIndex:aY};if(aK==a0){aD.item=return_item}else{aD.all.push(return_item)}}return aD}return null}function Y(az){if(N.grid.hoverable){s("plothover",az,function(aA){return aA.hoverable!=false})}}function k(az){if(N.grid.hoverable){s("plothover",az,function(aA){return false})}}function Q(az){s("plotclick",az,function(aA){return aA.clickable!=false})}function s(aB,aA,aC){var aD=w.offset(),aG=aA.pageX-aD.left-o.left,aE=aA.pageY-aD.top-o.top,aI=A({left:aG,top:aE});aI.pageX=aA.pageX;aI.pageY=aA.pageY;var az=ax(aG,aE,aC);var aJ=az&&az.item;az=az&&az.all;if(aJ){aJ.pageX=parseInt(aJ.series.xaxis.p2c(aJ.datapoint[0])+aD.left+o.left);aJ.pageY=parseInt(aJ.series.yaxis.p2c(aJ.datapoint[1])+aD.top+o.top)}if(N.grid.autoHighlight){for(var aF=0;aF<Z.length;++aF){var aH=Z[aF];if(aH.auto==aB&&!(aJ&&aH.series==aJ.series&&aH.point[0]==aJ.datapoint[0]&&aH.point[1]==aJ.datapoint[1])){S(aH.series,aH.point)}}if(aJ){v(aJ.series,aJ.datapoint,aB)}}ar.trigger(aB,[aI,aJ,az])}function f(){if(!L){L=setTimeout(q,30)}}function q(){L=null;y.save();y.clearRect(0,0,F,H);y.translate(o.left,o.top);var aA,az;for(aA=0;aA<Z.length;++aA){az=Z[aA];if(az.series.bars.show){t(az.series,az.point)}else{av(az.series,az.point)}}y.restore();ak(ah.drawOverlay,[y])}function v(aB,az,aD){if(typeof aB=="number"){aB=P[aB]}if(typeof az=="number"){var aC=aB.datapoints.pointsize;az=aB.datapoints.points.slice(aC*az,aC*(az+1))}var aA=ai(aB,az);if(aA==-1){Z.push({series:aB,point:az,auto:aD});f()}else{if(!aD){Z[aA].auto=false}}}function S(aB,az){if(aB==null&&az==null){Z=[];f()}if(typeof aB=="number"){aB=P[aB]}if(typeof az=="number"){az=aB.data[az]}var aA=ai(aB,az);if(aA!=-1){Z.splice(aA,1);f()}}function ai(aB,aC){for(var az=0;az<Z.length;++az){var aA=Z[az];if(aA.series==aB&&aA.point[0]==aC[0]&&aA.point[1]==aC[1]){return az}}return -1}function av(aC,aB){var aA=aB[0],aG=aB[1],aF=aC.xaxis,aE=aC.yaxis;if(aA<aF.min||aA>aF.max||aG<aE.min||aG>aE.max){return}var aD=aC.points.radius+aC.points.lineWidth/2;y.lineWidth=aD;y.strokeStyle=b.color.parse(aC.color).scale("a",0.5).toString();var az=1.5*aD,aA=aF.p2c(aA),aG=aE.p2c(aG);y.beginPath();if(aC.points.symbol=="circle"){y.arc(aA,aG,az,0,2*Math.PI,false)}else{aC.points.symbol(y,aA,aG,az,false)}y.closePath();y.stroke()}function t(aB,az){y.lineWidth=aB.bars.lineWidth;y.strokeStyle=b.color.parse(aB.color).scale("a",0.5).toString();var aA=b.color.parse(aB.color).scale("a",0.5).toString();D(az[0],az[1],az[2]||0,aB.bars.barLeft,aB.bars.barLeft+aB.bars.barWidth,0,function(){return aA},aB.xaxis,aB.yaxis,y,aB.bars.horizontal,aB.bars.lineWidth)}function aj(aH,az,aF,aA){if(typeof aH=="string"){return aH}else{var aG=G.createLinearGradient(0,aF,0,az);for(var aC=0,aB=aH.colors.length;aC<aB;++aC){var aD=aH.colors[aC];if(typeof aD!="string"){var aE=b.color.parse(aA);if(aD.brightness!=null){aE=aE.scale("rgb",aD.brightness)}if(aD.opacity!=null){aE.a*=aD.opacity}aD=aE.toString()}aG.addColorStop(aC/(aB-1),aD)}return aG}}}b.plot=function(f,d,c){var e=new a(b(f),d,c,b.plot.plugins);return e};b.plot.plugins=[];b.plot.formatDate=function(l,f,h){var o=function(c){c=""+c;return c.length==1?"0"+c:c};var e=[];var p=false,j=false;var n=l.getUTCHours();var k=n<12;if(h==null){h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}if(f.search(/%p|%P/)!=-1){if(n>12){n=n-12}else{if(n==0){n=12}}}for(var g=0;g<f.length;++g){var m=f.charAt(g);if(p){switch(m){case"h":m=""+n;break;case"H":m=o(n);break;case"M":m=o(l.getUTCMinutes());break;case"S":m=o(l.getUTCSeconds());break;case"d":m=""+l.getUTCDate();break;case"m":m=""+(l.getUTCMonth()+1);break;case"y":m=""+l.getUTCFullYear();break;case"b":m=""+h[l.getUTCMonth()];break;case"p":m=(k)?("am"):("pm");break;case"P":m=(k)?("AM"):("PM");break;case"0":m="";j=true;break}if(m&&j){m=o(m);j=false}e.push(m);if(!j){p=false}}else{if(m=="%"){p=true}else{e.push(m)}}}return e.join("")};b.plot.floorInBase=function(d,c){return c*Math.floor(d/c)}})(jQuery);(function(e){function a(f){f=""+f;return f.length===1?"0"+f:f}var c=/^[0-9]+(\.[0-9]*)?$/;var d="^([0-9]{4})(0[0-9]|1[0-2])?([0-2][0-9]|3[01])?([0-1][0-9]|2[0-3])?([0-5][0-9])?([0-5][0-9])?$";var b=new RegExp(d);e.widget("connexions.timeline",{version:"0.0.1",options:{xDataHint:null,css:null,annotation:null,rawData:null,data:[],width:null,height:null,hwRatio:9/16,hideLegend:false,valueInLegend:true,valueInTips:false,replaceLegend:false,jsonRpc:null,rpcMethod:"bookmark.getTimeline",rpcParams:null,hours:["12a"," 1a"," 2a"," 3a"," 4a"," 5a"," 6a"," 7a"," 8a"," 9a","10a","11a","12p"," 1p"," 2p"," 3p"," 4p"," 5p"," 6p"," 7p"," 8p"," 9p","10p","11p"],months:["January","Febrary","March","April","May","June","July","August","September","October","November","December"],days:["Su","Mo","Tu","We","Th","Fr","Sa"],groupingFmt:{YM:"fmt:%Y %b",YMD:"fmt:%Y.%M.%d",MD:"fmt:%b %d",MH:"fmt:%b %h",MDH:"fmt:%b %d %h","Y:M":"mon","Y:D":"day","Y:d":"day-of-week","Y:H":"hour","M:D":"day","M:d":"day-of-week","M:H":"hour","w:d":"day-of-week","w:H":"hour","D:H":"hour","d:H":"hour"}},_init:function(){var g=this;var k=g.options;if(e.isFunction(e.registry)){if(k.jsonRpc===null){var j=e.registry("api");if(j&&j.jsonRpc){k.jsonRpc=e.extend({},j.jsonRpc,k.jsonRpc)}}}g.element.data("orig-position",g.element.css("position"));g.element.css("position","relative").addClass("ui-timeline");if(k.hideLegend!==true){g.element.addClass("ui-timeline-labeled")}if(e.type(k.css)==="string"){g.element.addClass(k.css)}g.$legend=g.element.find(".timeline-legend");if((g.$legend.length<1)&&(k.hideLegend!==true)){g.$legend=e('<div class="timeline-legend"></div>');g.$legend.data("remove-on-destroy",true);g.element.append(g.$legend)}else{if(k.hideLegend===true){g.$legend.hide()}}g.$timeline=g.element.find(".timeline-plot");if(g.$timeline.length<1){g.$timeline=e('<div class="timeline-plot"></div>');g.$timeline.data("remove-on-destroy",true);g.element.append(g.$timeline)}g.$controls=g.element.find(".timeline-controls");g.$grouping=g.$controls.find(':input[name="timeline.grouping"]').input();if(k.annotation){g.$annotation=g.element.find(".timeline-annotation");if(g.$annotation.length<1){g.$annotation=e('<div class="timeline-annotation"></div>');g.$annotation.data("remove-on-destroy",true);g.element.append(g.$annotation)}g.$annotation.html(k.annotation)}g.hlTimer=null;var h=g.$timeline.width();var f=g.$timeline.height();if(k.width!==null){g.$timeline.css("width",k.width);h=g.$timeline.width()}if(k.height!==null){g.$timeline.css("height",k.height);f=g.$timeline.height()}if(h<1){g.$timeline.width(g.element.width());h=g.$timeline.width()}if(f<1){f=h*k.hwRatio;g.$timeline.css("height",f)}g._bindEvents();window.setTimeout(function(){g._createPlot()},50)},_bindEvents:function(){var f=this;var g=f.options;f.$timeline.bind("plothover",function(j,k,h){if(!f.hlTimer){f.hlTimer=window.setTimeout(function(){f._updateHighlights(k)},50)}});f.$controls.delegate("input,select","change",function(h){f._reload(f.$grouping.val())})},_reload:function(j){var g=this;var h=g.options;var k=h.rpcParams;k.grouping=j;var f=h.groupingFmt[j];if(f!==undefined){h.xDataHint=f}g.element.mask();e.jsonRpc(h.jsonRpc,h.rpcMethod,k,{success:function(l){if((!l)||(l.error!==null)){e.notify({title:"Timeline Update failed",text:'<p class="error">'+(l?l.error.message:"")+"</p>"});return}h.data=g._convertData(l.result);g._draw()},error:function(m,n,l){e.notify({title:"Timeline Update failed",text:'<p class="error">'+n+"</p>"})},complete:function(l,m){g.element.unmask()}})},_draw:function(){var g=this;var j=g.options;var f=g.$timeline.height();var h=g.$timeline.width();if((f===0)||(h===0)){if(f===0){f}}g.$plot=e.plot(g.$timeline,j.data,g.flotOpts);g.plotBox=g.$plot.getPlotOffset();g.plotBox.width=g.$plot.width();g.plotBox.height=g.$plot.height();g.plotBox.right=g.plotBox.left+g.plotBox.width;g.plotBox.bottom=g.plotBox.top+g.plotBox.height;g.$legends=g.$legend.find(".legendLabel");g.$legends.each(function(){var k=e(this);if(k.find(".timeline-text").length<1){k.html('<span class="timeline-text">'+k.html()+"</span>")}})},_createPlot:function(){var g=this;var h=g.options;var j={grid:{hoverable:true,autoHighlight:false},points:{show:true},lines:{show:true},legend:{container:g.$legend},xaxis:{tickFormatter:function(l,k){return g._xTickFormatter(l,k)}}};g.flotOpts=e.extend(true,{},j,h.flot);if(h.rpcParams!==null){var f=h.groupingFmt[h.rpcParams.grouping];if(f!==undefined){h.xDataHint=f}}if(e.isArray(h.rawData)||e.isPlainObject(h.rawData)){h.data=g._convertData(h.rawData)}g._draw()},_convertData:function(j){var f=this;var g=f.options;var h=[];g.xDataType=undefined;g.xDateFmt=undefined;e.each(j,function(k,l){var m={label:k,data:[]};e.each(l,function(n,q){q=(c.test(q)?parseInt(q,10):q);var o=b.exec(n);if(o!==null){o[2]=(o[2]===undefined?0:o[2]-1);o[3]=(o[3]===undefined?1:o[3]);o[4]=(o[4]===undefined?0:o[4]);o[5]=(o[5]===undefined?0:o[5]);o[6]=(o[6]===undefined?0:o[6]);var p=new Date(o[1],o[2],o[3],o[4],o[5],o[6]);m.data.push([p,q]);g.xDataType="date";if((e.type(g.xDataHint)==="string")&&(g.xDataHint.substr(0,4)==="fmt:")){g.xDateFmt=g.xDataHint.substr(4);g.xDataHint="fmt"}}else{n=(c.test(n)?parseInt(n,10):n);m.data[n]=[n,q]}});h.push(m)});return h},_formatDate:function(h,f){var g=this;var l=g.options;if(f===undefined){f=l.xDateFmt}var m=false;var k=[];for(var j=0;j<f.length;j++){var n=f.charAt(j);if(m){m=false;switch(n){case"Y":n=h.getFullYear();break;case"m":n=a(h.getMonth()+1);break;case"d":n=a(h.getDate());break;case"w":n=h.getDay();break;case"H":n=a(h.getHours());break;case"M":n=a(h.getMinutes());break;case"S":n=a(h.getSeconds());break;case"z":n=h.getTimezoneOffset();break;case"B":n=l.months[h.getMonth()];break;case"b":n=l.months[h.getMonth()].substr(0,3);break;case"A":n=l.days[h.getDay()];break;case"a":n=l.days[h.getDay()].substr(0,2);break;case"h":n=l.hours[h.getHours()];break;default:break}k.push(n)}else{if(n==="%"){m=true}else{k.push(n)}}}return k.join("")},_xTickFormatter:function(j,h){var f=this;var g=f.options;if(g.xDataType==="date"){j=new Date(j)}switch(g.xDataHint){case"hour":if(j instanceof Date){j=j.getHours()}j=g.hours[j];break;case"day-of-week":if(j instanceof Date){j=j.getDay()}j=g.days[j];break;case"month":if(j instanceof Date){j=j.getMonth()+1}j=g.months[(j>0?j-1:j)];break;case"mon":if(j instanceof Date){j=j.getMonth()+1}j=g.months[(j>0?j-1:j)];if(j!==undefined){j=j.substr(0,3)}break;case"day":if(j instanceof Date){j=j.getDate()}break;case"year":if(j instanceof Date){j=j.getFullYear()}break;case"fmt":if(j instanceof Date){j=f._formatDate(j)}break;case"week":}return(j===undefined?"":j)},_showTip:function(t,j,g){if(g===null){return}var r=this;var f=r.options;var o=(j.points.radius+j.points.lineWidth);var s={top:j.yaxis.p2c(g[1]),left:j.xaxis.p2c(g[0])};var n=j.yaxis.tickFormatter(g[1],j.yaxis);var k=n;var q='<div class="timeline-tooltip">'+k+"</div>";var m=j.yaxis;var h=e(q).css({position:"absolute",top:s.top-o-5,left:s.left+(o*2)+5,"text-align":"left",width:m.labelWidth+"px",height:m.labelHeight+"px",color:j.yaxis.options.color});r.$timeline.append(h);var l=h.position();l.width=h.outerWidth();l.height=h.outerHeight();l.left+=l.width;l.right=l.left+l.width;l.bottom=l.top+l.height;if(l.top<r.plotBox.top){l.top=s.top+o+o+5}else{if(l.bottom>r.plotBox.bottom){l.top=r.plotBox.bottom-l.height-5}}if(l.left<r.plotBox.left){l.left=r.plotBox.left+5}else{if(l.right>r.plotBox.right){l.left=r.plotBox.right-l.width-10}}h.css({top:l.top,left:l.left})},_updateLegend:function(r,k,g){if(g===null){return}var q=this;var f=q.options;var j=q.$legends.eq(r);var h=j.find(".timeline-stat");var o=k.xaxis.tickFormatter(g[0],k.xaxis);var n=k.yaxis.tickFormatter(g[1],k.yaxis);var m=(f.replaceLegend?"":": ")+o+": "+n;if(h.length>0){h.text(m).show()}else{var l='<span class="timeline-stat">'+m+"</span>";j.append(l)}if(f.replaceLegend){j.find(".timeline-text").hide()}},_updateHighlights:function(l){var q=this;var f=q.options;q.$plot.unhighlight();q.$timeline.find(".timeline-tooltip").remove();q.$legends.find(".timeline-stat").hide().end().find(".timeline-text").show();var k=q.$plot.getAxes();if((l.x<k.xaxis.min)||(l.x>k.xaxis.max)||(l.y<k.yaxis.min)||(l.y>k.yaxis.max)){q.hlTimer=null;return}var s,m,h=q.$plot.getData();for(s=0;s<h.length;s++){var j=h[s];var g=null;var o=null;var n=null;for(m=0;m<j.data.length;m++){if(j.data[m]===undefined){continue}var r=j.data[m];if(r[0]>l.x){if((n===null)||(r[0]<n[0])){n=r}}else{if(r[0]<l.x){if((o===null)||(r[0]>o[0])){o=r}}}}if(o===null){g=n}else{if(n===null){g=o}else{if(Math.abs(l.x-o[0])<Math.abs(l.x-n[0])){g=o}else{g=n}}}q.$plot.highlight(j,g,false);if(f.valueInLegend){q._updateLegend(s,j,g)}if(f.valueInTips){q._showTip(s,j,g)}}q.hlTimer=null},destroy:function(){var f=this;var g=f.options;f.$plot.shutdown();f.$timeline.find(".timeline-tooltip").remove();if(f.$annotation.data("remove-on-destroy")===true){f.$annotation.remove()}if(f.$legend.data("remove-on-destroy")===true){f.$legend.remove()}else{f.$legends.each(function(){var h=e(this);h.html(h.find(".timeline-text").html())})}if(f.$timeline.data("remove-on-destroy")===true){f.$timeline.remove()}f.element.css("position",f.element.data("orig-position")).removeData("orig-position").removeClass("ui-timeline");if(g.hideLegend!==true){f.element.removeClass("ui-timeline-labeled")}if(e.type(g.css)==="string"){f.element.removeClass(g.css)}}})}(jQuery));