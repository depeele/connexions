(function(c){function b(){c.log=function(e){if((window.console!==undefined)&&c.isFunction(window.console.log)){var g=e;for(var f=1;f<arguments.length;f++){g=g.replace(/%s/,arguments[f])}window.console.log(g)}};c.log("Logging enabled")}if((window.console===undefined)||(!c.isFunction(window.console.log))){c(document).ready(b)}else{b()}if(c.browser.msie){try{document.execCommand("BackgroundImageCache",false,true)}catch(d){}}if(false){if(c.browser.mozilla||c.browser.opera){document.removeEventListener("DOMContentLoaded",c.ready,false);document.addEventListener("DOMContentLoaded",function(){c.ready()},false)}c.event.remove(window,"load",c.ready);c.event.add(window,"load",function(){c.ready()});function a(e,f){c.includeScripts[f]=true;c.each(c.includeCallbacks[f],function(g,h){h.call(e)})}c.extend({includeScripts:{},includeCallbacks:{},includeTimer:null,include:function(f,g){if(c.includeScripts[f]!==undefined){if(typeof g==="function"){if(c.includeScripts[f]!==false){g(c.includeScripts[f])}else{c.includeCallbacks[f].push(g)}}return}var e=document.createElement("script");e.type="text/javascript";e.onload=function(){a(e,f)};e.onreadystatechange=function(){if((e.readyState!=="complete")&&(e.readyState!=="loaded")){return}a(e,f)};e.src=f;c.includeScripts[f]=false;c.includeCallbacks[f]=[];if(typeof g==="function"){c.includeCallbacks[f].push(g)}document.getElementsByTagName("head")[0].appendChild(e)},_ready:c.ready,ready:function(){var e=true;c.each(c.includeScripts,function(f,g){if(g===false){return(e=false)}});if(e){c._ready.apply(c,arguments)}else{setTimeout(c.ready,10)}}})}c.fn.mask=function(){return this.each(function(){var h=c("#pageHeader h1 a img");var g=c(this);var i=g.css("z-index");if(i==="auto"){i=99999}else{i++}var e=c("<div></div>").addClass("ui-widget-overlay").appendTo(g).css({width:g.width(),height:g.height(),"z-index":i});var f=h.attr("src");h.attr("src",f.replace(".gif","-spinner.gif"));if(c.fn.bgiframe){e.bgiframe()}})};c.fn.unmask=function(){return this.each(function(){var h=c("#pageHeader h1 a img");var g=c(this);var e=g.find(".ui-widget-overlay");e.remove();var f=h.attr("src");h.attr("src",f.replace("-spinner.gif",".gif"))})}}(jQuery));(function(a){a.registry=function(b,c){if(c!==undefined){a.data(document,b,c)}else{return a.data(document,b)}}}(jQuery));jQuery.cookie=function(b,j,m){if(typeof j!=="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires==="number"||m.expires.toUTCString)){var f;if(typeof m.expires==="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!==""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)===(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};(function(a){jQuery.fn.pngFix=function(d){d=jQuery.extend({blankgif:"blank.gif"},d);var c=(navigator.appName=="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)==4&&navigator.appVersion.indexOf("MSIE 5.5")!=-1);var b=(navigator.appName=="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)==4&&navigator.appVersion.indexOf("MSIE 6.0")!=-1);if(jQuery.browser.msie&&(c||b)){jQuery(this).find("img[src$=.png]").each(function(){jQuery(this).attr("width",jQuery(this).width());jQuery(this).attr("height",jQuery(this).height());var l="";var g="";var f=(jQuery(this).attr("id"))?'id="'+jQuery(this).attr("id")+'" ':"";var m=(jQuery(this).attr("class"))?'class="'+jQuery(this).attr("class")+'" ':"";var i=(jQuery(this).attr("title"))?'title="'+jQuery(this).attr("title")+'" ':"";var j=(jQuery(this).attr("alt"))?'alt="'+jQuery(this).attr("alt")+'" ':"";var h=(jQuery(this).attr("align"))?"float:"+jQuery(this).attr("align")+";":"";var e=(jQuery(this).parent().attr("href"))?"cursor:hand;":"";if(this.style.border){l+="border:"+this.style.border+";";this.style.border=""}if(this.style.padding){l+="padding:"+this.style.padding+";";this.style.padding=""}if(this.style.margin){l+="margin:"+this.style.margin+";";this.style.margin=""}var k=(this.style.cssText);g+="<span "+f+m+i+j;g+='style="position:relative;white-space:pre-line;display:inline-block;background:transparent;'+h+e;g+="width:"+jQuery(this).width()+"px;height:"+jQuery(this).height()+"px;";g+="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+jQuery(this).attr("src")+"', sizingMethod='scale');";g+=k+'"></span>';if(l!=""){g='<span style="position:relative;display:inline-block;'+l+e+"width:"+jQuery(this).width()+"px;height:"+jQuery(this).height()+'px;">'+g+"</span>"}jQuery(this).hide();jQuery(this).after(g)});jQuery(this).find("*").each(function(){var f=jQuery(this).css("background-image");if(f.indexOf(".png")!=-1){var e=f.split('url("')[1].split('")')[0];jQuery(this).css("background-image","none");jQuery(this).get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"',sizingMethod='scale')"}});jQuery(this).find("input[src$=.png]").each(function(){var e=jQuery(this).attr("src");jQuery(this).get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale');";jQuery(this).attr("src",d.blankgif)})}return jQuery}})(jQuery);(function(a){a.widget("ui.checkbox",{version:"0.1.1",widgetEventPrefix:"",options:{css:"checkbox",cssOn:"on",cssOff:"off",titleOn:"click to turn off",titleOff:"click to turn on",useElTitle:true,hideLabel:false},_create:function(){var b=this;var d=this.options;d.enabled=b.element.attr("disabled")?false:true;d.checked=b.element.attr("checked")?true:false;d.title="";var c=b.element.attr("name");var f=b.element.attr("id");b.$label=false;if(f){b.$label=a("label[for="+f+"]")}if((!b.$label)&&c){b.$label=a("label[for="+c+"]")}if(d.useElTitle===true){d.title=b.element.attr("title");if(((!d.title)||(d.title.length<1))&&(b.$label.length>0)){d.title=b.$label.text()}}var e=d.title+(d.checked?d.titleOn:d.titleOff);b.$el=a('<span class="checkbox"><div class="'+d.css+(d.enabled?" ":" diabled ")+(d.checked?d.cssOn:d.cssOff)+'"'+(e&&e.length>0?' title="'+e+'"':"")+">&nbsp;</div></span>");b.img=b.$el.find("div");b.$el.insertAfter(b.element);b.element.hide();b.$value=a('<input type="hidden" '+(f?'id="'+f+'" ':"")+'name="'+c+'" />');b.$value.attr("value",d.checked);b.$value.insertBefore(b.$el);if(b.$label&&(b.$label.length>0)){if(d.hideLabel===true){b.$label.hide()}else{b.$label.click(function(g){g.preventDefault();g.stopPropagation();b.$el.trigger("click",[g]);return false})}}b._bindEvents()},_bindEvents:function(){var d=this;var c=function(h){if(d.options.enabled===true){d.$el.addClass("ui-state-hover")}};var g=function(h){d.$el.removeClass("ui-state-hover")};var f=function(h){if(d.options.enabled===true){d.$el.addClass("ui-state-focus")}};var e=function(h){d.$el.removeClass("ui-state-focus")};var b=function(h){d.toggle()};d.$el.bind("mouseenter.uicheckbox",c).bind("mouseleave.uicheckbox",g).bind("focus.uicheckbox",f).bind("blur.uicheckbox",e).bind("click.uicheckbox",b)},isChecked:function(){return this.options.checked},isEnabled:function(){return this.options.enabled},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.$el.removeClass("ui-state-disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.$el.addClass("ui-state-disabled");this._trigger("disabled")}},toggle:function(){if(!this.options.enabled){return}if(this.options.checked){this.uncheck()}else{this.check()}},check:function(){if(this.options.enabled&&(!this.options.checked)){this.options.checked=true;this.$value.attr("value",this.options.checked);this.img.removeClass(this.options.cssOff).addClass(this.options.cssOn).attr("title",this.options.title+this.options.titleOn);this._trigger("change",null,"check")}},uncheck:function(){if(this.options.enabled&&this.options.checked){this.options.checked=false;this.$value.attr("value",this.options.checked);this.img.removeClass(this.options.cssOn).addClass(this.options.cssOff).attr("title",this.options.title+this.options.titleOff);this._trigger("change",null,"uncheck")}},destroy:function(){if(this.$label){this.$label.show()}this.$el.unbind(".uicheckbox");this.$value.remove();this.$el.remove();this.element.show()}})}(jQuery));(function(a){a.widget("ui.input",{version:"0.1.1",widgetEventPrefix:"",options:{priority:"normal",$label:null,$validation:null,validation:null,},_create:function(){var b=this;var c=this.options;c.enabled=b.element.attr("disabled")?false:true;if(c.$validation){if(c.$validation.jquery===undefined){c.$validation=a(c.$validation)}}else{c.$validation=b.element.parent().find(".ui-field-status:first")}if((!c.validation)&&(b.element.hasClass("required"))){c.validation="!empty"}b.element.addClass("ui-input ui-corner-all ");b.keyTimer=null;if(c.priority==="primary"){b.element.addClass("ui-priority-primary")}else{if(c.priority==="secondary"){b.element.addClass("ui-priority-secondary")}}b.element.addClass("ui-state-default");if(!c.enabled){b.element.addClass("ui-state-disabled")}var d=b.element.attr("id");if((d===undefined)||(d.length<1)){d=b.element.attr("name")}if((d!==undefined)&&(d.length>0)){c.$label=b.element.parent().find("label[for="+d+"]")}else{c.$label=b.element.closest("label")}c.$label.addClass("ui-input-over").hide();b._bindEvents()},_bindEvents:function(){var d=this;var e=d.options;var c=function(i){if(d.options.enabled===true){d.element.addClass("ui-state-hover")}};var h=function(j){var i=a(this);i.removeClass("ui-state-hover")};var b=function(i){if(d.options.enabled!==true){return}if(d.keyTimer!==null){clearTimeout(d.keyTimer)}if(i.keyCode===9){return}d.valid(undefined);d.keyTimer=setTimeout(function(){d.validate()},1000)};var g=function(i){if(d.options.enabled===true){e.$label.hide();d.element.removeClass("ui-state-empty").addClass("ui-state-focus ui-state-active")}};var f=function(i){d.element.removeClass("ui-state-focus ui-state-active");if(!d.element.hasClass("ui-state-valid")){d.validate()}if(a.trim(d.val())===""){d.element.addClass("ui-state-empty");e.$label.show()}};d.element.bind("mouseenter.uiinput",c).bind("mouseleave.uiinput",h).bind("keydown.uiinput",b).bind("focus.uiinput",g).bind("blur.uiinput",f);e.$label.bind("click.uiinput",function(){d.element.focus()});if(a.trim(d.val())!==""){d.validate()}else{e.$label.show()}},isEnabled:function(){return this.options.enabled},isValid:function(){return this.options.valid},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.element.removeClass("ui-state-disabled").removeAttr("disabled");this.options.$label.removeClass("ui-state-disabled").removeAttr("disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.element.attr("disabled",true).addClass("ui-state-disabled");this.options.$label.attr("disabled",true).addClass("ui-state-disabled");this._trigger("disabled")}},valid:function(b){if(b===this.options.valid){return}this.element.removeClass("ui-state-error ui-state-valid");this.options.$validation.html("&nbsp;").removeClass("ui-state-invalid ui-state-valid");if(b===true){this.element.addClass("ui-state-valid");this.options.$validation.addClass("ui-state-valid")}else{if(b!==undefined){this.element.addClass("ui-state-error");this.options.$validation.addClass("ui-state-invalid");if(typeof b==="string"){this.options.$validation.html(b)}}}this.options.valid=b;this._trigger("validation_change",null,[b])},getLabel:function(){return this.options.$label.text()},setLabel:function(b){this.options.$label.text(b)},val:function(b){return this.element.val()},validate:function(){var d=[];var c;if(this.options.validation===null){return}if(a.isFunction(this.options.validation)){var b=this.options.validation.apply(this.element,[this.val()]);if(typeof b==="string"){c=false;d.push(b)}else{c=b}}else{if(this.options.validation==="!empty"){c=((this.val().length>0)?true:false);d.push("Cannot be empty")}}this.valid(((c===false)&&(d.length>0)?d.join("<br />"):c))},destroy:function(){this.options.$validation.removeClass("ui-state-valid ui-state-invalid ");this.options.$label.unbind(".uiinput");this.element.removeClass("ui-state-default ui-state-disabled ui-state-hover ui-state-valid ui-state-error ui-state-focus ui-state-active ui-priority-primary ui-priority-secondary ").unbind(".uiinput")}})}(jQuery));
/*
 * jQuery UI Stars v2.1.1
 * http://plugins.jquery.com/project/Star_Rating_widget
 *
 * Copyright (c) 2009 Orkan (orkans@gmail.com)
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * $Rev: 114 $
 * $Date:: 2009-06-12 #$
 * $Build: 32 (2009-06-12)
 *
 * Take control of pre-assembled HTML:
 *  <div >
 *    <input class='ui-stars-rating' type='hidden' name='rating' value='...' />
 *    <div class='ui-stars ui-stars-cancel ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    ...
 *  </div>
 *
 * Depends:
 *      ui.core.js
 *      ui.widget.js
 *
 */
(function(a){a.widget("ui.stars",{version:"2.1.1b",widgetEventPrefix:"",options:{inputType:"div",split:0,disabled:false,cancelTitle:"Cancel Rating",cancelValue:0,cancelShow:true,oneVoteOnly:false,showTitles:false,captionEl:null,callback:null,starWidth:16,baseClass:"ui-stars",cancelClass:"ui-stars-cancel",starClass:"ui-stars-star",starOnClass:"ui-stars-star-on",starHoverClass:"ui-stars-star-hover",starDisabledClass:"ui-stars-star-disabled",cancelHoverClass:"ui-stars-cancel-hover",cancelDisabledClass:"ui-stars-cancel-disabled"},_create:function(){var b=this,e=this.options,f=0;this.$stars=a("."+e.starClass,this.element);this.$cancel=a("."+e.cancelClass,this.element);this.$input=a("input[type=hidden]:first",this.element);e.items=this.$stars.filter("."+e.starClass).length;e.value=this.$stars.filter("."+e.starOnClass).length;if(e.value>0){e.checked=e.defaultValue=e.value}else{e.value=e.cancelValue}if(e.disabled){this.$cancel.addClass(e.cancelDisabledClass)}e.cancelShow&=!e.oneVoteOnly;function d(){b.$stars.removeClass(e.starOnClass+" "+e.starHoverClass);b._showCap("")}function c(g,i){if(g>=0){var j=i?e.starHoverClass:e.starOnClass;var h=i?e.starOnClass:e.starHoverClass;b.$stars.eq(g).removeClass(h).addClass(j).prevAll("."+e.starClass).removeClass(h).addClass(j);b.$stars.eq(g).nextAll("."+e.starClass).removeClass(e.starHoverClass+" "+e.starOnClass);b._showCap(b.$stars.eq(g).find("a").attr("title"))}else{d()}}this.$stars.bind("click.stars",function(h){if(!e.forceSelect&&e.disabled){return false}var g=b.$stars.index(this);e.checked=g;e.value=g+1;e.title=a(this).find("a").attr("title");b.$input.val(e.value);c(e.checked,false);b._disableCancel();!e.forceSelect&&b.callback(h,"star");b._trigger("change",null,e.value)}).bind("mouseover.stars",function(){if(e.disabled){return false}var g=b.$stars.index(this);c(g,true)}).bind("mouseout.stars",function(){if(e.disabled){return false}c(e.checked,false)});this.$cancel.bind("click.stars",function(g){if(!e.forceSelect&&(e.disabled||e.value===e.cancelValue)){return false}e.checked=-1;e.value=e.cancelValue;b.$input.val(e.cancelValue);d();b._disableCancel();!e.forceSelect&&b.callback(g,"cancel")}).bind("mouseover.stars",function(){if(b._disableCancel()){return false}b.$cancel.addClass(e.cancelHoverClass);d();b._showCap(e.cancelTitle)}).bind("mouseout.stars",function(){if(b._disableCancel()){return false}b.$cancel.removeClass(e.cancelHoverClass);b.$stars.triggerHandler("mouseout.stars")});a(window).unload(function(){b.$cancel.unbind(".stars");b.$stars.unbind(".stars");b.$stars=b.$cancel=null});this.select(e.value);e.disabled&&this.disable()},_disableCancel:function(){var c=this.options,b=c.disabled||c.oneVoteOnly||(c.value===c.cancelValue);if(b){this.$cancel.removeClass(c.cancelHoverClass).addClass(c.cancelDisabledClass)}else{this.$cancel.removeClass(c.cancelDisabledClass)}this.$cancel.css("opacity",b?0.5:1);return b},_disableAll:function(){var b=this.options;this._disableCancel();if(b.disabled){this.$stars.filter("div").addClass(b.starDisabledClass)}else{this.$stars.filter("div").removeClass(b.starDisabledClass)}},_showCap:function(b){var c=this.options;if(c.captionEl){c.captionEl.text(b)}},value:function(){return this.options.value},select:function(d){var c=this.options,b=(d===c.cancelValue)?this.$cancel:this.$stars.eq(d-1);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},selectID:function(d){var c=this.options,b=(d===-1)?this.$cancel:this.$stars.eq(d);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},enable:function(){this.options.disabled=false;this._disableAll()},disable:function(){this.options.disabled=true;this._disableAll()},destroy:function(){this.$cancel.unbind(".stars");this.$stars.unbind(".stars");this.element.unbind(".stars").removeData("stars")},callback:function(c,b){var d=this.options;d.callback&&d.callback(this,b,d.value,c);d.oneVoteOnly&&!d.disabled&&this.disable()}})}(jQuery));(function(a){a.widget("ui.notify",{options:{speed:500,expires:5000,stack:"below"},_create:function(){var b=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message").each(function(d){var c=this.id||d;b.keys.push(c);b.templates[c]=a(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty()},create:function(b,d,c){if(typeof b==="object"){c=d;d=b;b=null}return new a.ui.notify.instance(this)._create(d,a.extend({},this.options,c),this.templates[b||this.keys[0]])}});a.extend(a.ui.notify,{instance:function(b){this.parent=b;this.isOpen=false}});a.extend(a.ui.notify.instance.prototype,{_create:function(h,e,g){this.options=e;var d=this,f=g.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(i,j){return(j in h)?h[j]:""}),c=(this.element=a(f)),b=c.find("a.ui-notify-close");if(this._trigger("beforeopen")===false){return}if(typeof this.options.click==="function"){c.addClass("ui-notify-click").bind("click",function(i){d._trigger("click",i,d)})}if(b.length&&!!e.expires){b.remove()}else{if(b.length){b.bind("click",function(){d.close();return false})}}this.open();if(typeof e.expires==="number"){window.setTimeout(function(){d.close()},e.expires)}return this},close:function(){var b=this,c=this.options.speed;this.isOpen=false;this.element.fadeTo(c,0).slideUp(c,function(){b._trigger("close")});return this},open:function(){if(this.isOpen){return this}var b=this;this.isOpen=true;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.parent.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){b._trigger("open")});return this},widget:function(){return this.element},_trigger:function(c,d,b){return this.parent._trigger.call(this,c,d,b)}})}(jQuery));(function(a){a.widget("connexions.dropdownForm",{version:"0.1.1",widgetEventPrefix:"",options:{namespace:null,form:null,groups:null},_create:function(){var b=this;var c=b.options;b.$form=b.element.find("form:first");b.$submit=b.element.find(":submit");b.$control=a("<div class='control'><button>Display Options</button></div>");b.$control.prependTo(b.element);b.$button=b.$control.find("button");b.$button.button({icons:{secondary:"ui-icon-triangle-1-s"}});b.$control.fadeTo(100,0.5);b.element.find(".ui-optionGroups").optionGroups();b.$form.hide();b._bindEvents()},_bindEvents:function(){var j=this;var d=function(k){if(j.$form.is(":visible")&&(!a.contains(j.$form[0],k.target))){j.$control.trigger("click");j._trigger("mouseleave",k)}};var h=function(k){j.$control.fadeTo(100,1)};var b=function(k){if(j.$form.is(":visible")){return}j.$control.fadeTo(100,0.5)};var e=function(k){k.preventDefault();k.stopPropagation();j.$form.toggle();j.$button.toggleClass("ui-state-active");return false};var g=function(k){k.preventDefault()};var c=function(k){j.$submit.removeClass("ui-state-disabled").removeAttr("disabled").addClass("ui-state-default")};var i=function(l){var k=j.$form.serializeArray();a(k).each(function(){a.cookie(this.name,this.value)});if(!j._trigger("apply",l)){l.stopImmediatePropagation();l.preventDefault();l.stopPropagation();return false}};var f=function(k){k.preventDefault();j.$form.trigger("submit")};a("body").bind("click.uidropdownform",d);j.$control.bind("mouseenter.uidroppdownform",h).bind("mouseleave.uidroppdownform",b).bind("click.uidropdownform",e);j.$form.bind("change.uidropdownform",c).bind("submit.uidropdownform",i);j.$submit.bind("click.uidropdownform",f)},getGroup:function(){return this.element.find(".displayStyle").optionGroups("getGroup")},setGroup:function(b){return this.element.find(".displayStyle").optionGroups("setGroup",b)},getGroupInfo:function(){return this.element.find(".displayStyle").optionGroups("getGroupInfo")},setApplyCb:function(b){this.options.apply=b},open:function(){if(this.element.find("form:first").is(":visible")){return}this.element.find(".control:first").click()},close:function(){if(!this.element.find("form:first").is(":visible")){return}this.element.find(".control:first").click()},enable:function(b){self.$form.find("input,select").removeAttr("disabled");if(b!==true){self.$submit.removeClass("ui-state-default ui-state-highlight").addClass("ui-state-disabled").attr("disabled",true)}else{self.$submit.removeClass("ui-state-disabled").removeAttr("disabled").addClass("ui-state-default")}},disable:function(){self.$form.find("input,select").attr("disabled",true);self.$submit.removeClass("ui-state-default ui-state-highlight").addClass("ui-state-disabled").attr("disabled",true)},destroy:function(){var b=this;a("body").unbind(".uidropdownform");b.$control.unbind(".uidropdownform");b.$control.find("a:first, .ui-icon:first").unbind(".uidropdownform");b.$form.unbind(".uidropdownform");b.$button.button("destroy");b.$control.remove();b.element.find(".displayStyle").optionGroups("destroy")}})}(jQuery));(function(a){a.widget("connexions.optionGroups",{version:"0.1.1",options:{namespace:null,form:null},_create:function(){var b=this;var g=this.options;if(g.namespace===null){var e=b.element.data("namespace");if(e!==undefined){g.namespace=e}else{var d=b.element.attr("class");e=d.replace(/^(?:.* )?(.*?)OptionGroups(?: .*)?$/,"$1");if((e!==undefined)&&(e.length>0)){g.namespace=e}}}if(g.form===null){var f=b.element.data("form");if(f!==undefined){g.form=f}else{g.form=b.element.closest("form")}}var c=b.element.find("ul.groups");c.find("li").removeClass("ui-state-active").addClass("ui-state-default").filter(":first").addClass("ui-corner-left").end().find(":radio").hide();c.find(":checked").parent().addClass("ui-state-active");c.find("li.isCustom").addClass("control").button({icons:{secondary:"ui-icon-triangle-1-s"}}).removeClass("ui-corner-all").addClass("ui-corner-right");b._bindEvents();if(!c.find("li.ui-state-active").hasClass("isCustom")){b.toggleFieldset()}},_bindEvents:function(){var j=this;var g=j.element.find("ul.groups");var f=j.element.find("fieldset:first");var b=g.find(".control:first");var e=function(k){k.preventDefault()};var h=function(k){k.preventDefault();k.stopPropagation();j.toggleFieldset()};var c=function(l){l.preventDefault();l.stopPropagation();var k=b.find(":radio");j.setGroup(k.val());return false};var d=function(l){l.preventDefault();l.stopPropagation();var k=a(this).find(":radio");j.setGroup(k.val())};var i=function(k){f.find(":checkbox").each(function(){a.cookie(a(this).attr("name"),null)});if(!g.find("li.ui-state-active").hasClass("isCustom")){f.find(":checkbox").attr("disabled",true)}};b.bind("click.uioptiongroups",h);f.bind("change.uioptiongroups",c);g.find("li:not(.control)").bind("change.uioptiongroups",d).bind("click.uioptiongroups",d);j.options.form.bind("submit.uioptiongroups",i)},getGroup:function(){return this.element.find("ul.groups :checked").val()},setGroup:function(h){var j=this;var f=j.element.find("ul.groups");var e=j.element.find("fieldset:first");var g=f.find(":radio[value="+h+"]");if(g.length!==1){return}f.find(":checked").attr("checked",false).removeAttr("checked");g.attr("checked","checked");f.find("li.ui-state-active").removeClass("ui-state-active");var d=g.parents("li:first");d.addClass("ui-state-active");if(!d.hasClass("control")){e.find("input").removeAttr("checked");e.find(".inGroup-"+h).attr("checked","checked")}var c=[];var i=[];e.find("input:checked").each(function(){c.push("."+a(this).attr("name").replace(/^.*?\[(.*?)\]$/,"$1").replace(/:/g," ."))});e.find("input:not(:checked)").each(function(){i.push("."+a(this).attr("name").replace(/^.*?\[(.*?)\]$/,"$1").replace(/:/g," ."))});var b={group:h,selected:c,deSelected:i};j.element.data("groupInfo",b);j.options.form.trigger("change",b)},getGroupInfo:function(){return this.element.data("groupInfo")},getForm:function(){return this.options.form},enable:function(){this.find(":input").removeAttr("disabled")},disable:function(){this.find(":input").attr("disabled",true)},toggleFieldset:function(){this.element.find("fieldset:first").toggleClass("ui-state-active").toggle()},destroy:function(){var c=this;c.element.find("a.option,div.option a:first").removeData("group");var d=c.element.find(".control:first");var b=c.element.find("input[name="+c.options.namespace+"Group]");d.unbind(".uioptiongroups");d.find("> a, .control > a, .control > .ui-icon").unbind(".uioptiongroups");c.element.find("fieldset:first").unbind(".uioptiongroups");c.element.find("a.option").unbind(".uioptiongroups");c.options.form.unbind(".uioptiongroups")}})}(jQuery));(function(a){a.widget("connexions.itemScope",{options:{namespace:"",jsonRpc:null,rpcId:1,separator:",",minLength:2},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$input=b.element.find(".scopeEntry :text");b.$curItems=b.element.find(".scopeItem");b.$submit=b.element.find(".scopeEntry :submit");b.$input.input();if(d.jsonRpc!==null){b.$input.autocomplete({source:function(f,e){return b._autocomplete(f,e)},minLength:d.minLength})}b._bindEvents()},_autocomplete:function(e,c){var b=this;var d=b.options;var g=d.rpcId++;var f={version:d.jsonRpc.version,id:g,method:d.jsonRpc.method,params:d.jsonRpc.params};f.params.str=b.$input.autocomplete("option","term");a.ajax({type:d.jsonRpc.transport,url:d.jsonRpc.target,dataType:"json",data:JSON.stringify(f),success:function(h,i,j){if(h.error!==null){b.element.trigger("error",[i,j,h.error]);return}c(a.map(h.result,function(k){return{label:'<span class="name">'+k.tag+'</span> <span class="count">'+k.userItemCount+"</span>",value:k.tag}}));b.element.trigger("success",[h,i,j])},error:function(i,h,j){b.element.trigger("error",[h,i])}})},_bindEvents:function(){var b=this;var c=b.options;var d=b.element.find(".deletable a.delete");d.bind("mouseenter.itemScope",function(f){a(this).css("opacity",1).addClass("ui-icon-circle-close").removeClass("ui-icon-close")}).bind("mouseleave.itemScope",function(f){a(this).css("opacity",0.25).addClass("ui-icon-close").removeClass("ui-icon-circle-close")}).trigger("mouseleave");b.$submit.bind("click.itemScope",function(f){f.preventDefault();f.stopPropagation();f.stopImmediatePropagation();b.element.submit()});b.element.bind("submit.itemScope",function(h){h.preventDefault();h.stopPropagation();h.stopImmediatePropagation();var i=window.location;var f=i.toString();var g=b.$input.val().replace(/\s*,\s*/g,",").replace(/,$/,"");if(f[f.length-1]!=="/"){f+="/"}if(g.length>0){if(b.$curItems.length>0){f+=","}f+=g}window.location.assign(f)})},destroy:function(){var b=this;var c=b.options;if(c.jsonRpc!==null){b.$input.autocomplete("destroy")}b.$input.input("destroy");b.element.find(".deletable a.delete").unbind(".itemScope");b.$submit.unbind(".itemScope");b.element.unbind(".itemScope")}})}(jQuery));(function(a){a.widget("connexions.paginator",{version:"0.1.1",options:{namespace:"",disableHover:false,page:1,pageVar:"Page"},_create:function(){var b=this;var d=b.options;if(d.form===null){var c=b.element.data("form");if(c!==undefined){d.form=c}else{d.form=b.element.closest("form")}}d.page=b.element.find("button.ui-state-active").text();d.pageVar=b.element.find("button:submit:first").attr("name");b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;if(!c.disableHover){b.element.fadeTo(100,0.5).hover(function(){a(this).fadeTo(100,1)},function(){a(this).fadeTo(100,0.5)})}b.element.find("select[name="+c.namespace+"PerPage]").bind("change.paginator",function(d){b.element.submit()});b.element.find(":submit").bind("click.paginator",function(d){c.page=a(this).val()});b.element.bind("submit.paginator",function(f){var d=b.element.serializeArray();a(d).each(function(){a.log("Add Cookie: name[%s], value[%s]",this.name,this.value);a.cookie(this.name,this.value)})})},getPage:function(){return this.options.page},getPageVar:function(){return this.options.pageVar},getForm:function(){return this.options.form},enable:function(){this.find(":button").removeAttr("disabled")},disable:function(){this.find(":button").attr("disabled",true)},destroy:function(){}})}(jQuery));(function(a){a.widget("connexions.bookmark",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,tags:null,url:null,change:null,jsonRpc:null,rpcId:1,enabled:true},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$userId=b.element.find("input[name=userId]");b.$itemId=b.element.find("input[name=itemId]");b.$name=b.element.find(".itemName a");b.$description=b.element.find(".description");b.$rating=b.element.find(".rating .stars .owner");b.$favorite=b.element.find("input[name=isFavorite]");b.$private=b.element.find("input[name=isPrivate]");b.$tags=b.element.find("input[name=tags]");b.$edit=b.element.find(".control .item-edit");b.$delete=b.element.find(".control .item-delete");b.$save=b.element.find(".control .item-save");b.$url=b.element.find(".itemName a,.url a");b.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});b.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});b.$rating.stars({});b._setState();b._bindEvents()},_bindEvents:function(){var b=this;var e=b.options;b._squelch=false;var g=function(j,i){j.stopImmediatePropagation();j.preventDefault();j.stopPropagation();a.log("connexions.bookmark::_update_item("+i+")");if((b.options.enabled!==true)||(b._squelch===true)){return}var h=false;var l={id:{userId:e.userId,itemId:e.itemId}};if(b.$name.text()!==e.name){l.name=b.$name.text();h=true}if(b.$description.text()!==e.description){l.description=b.$description.text();h=true}if((b.$tags.length>0)&&(b.$tags.text()!==e.tags)){l.tags=b.$tags.text();h=true}if(b.$favorite.checkbox("isChecked")!==e.isFavorite){l.isFavorite=b.$favorite.checkbox("isChecked");h=true}if(b.$private.checkbox("isChecked")!==e.isPrivate){l.isPrivate=b.$private.checkbox("isChecked");h=true}if((b.$rating.length>0)&&(b.$rating.stars("value")!==e.rating)){l.rating=b.$rating.stars("value");h=true}if(b.$url.attr("href")!==e.url){l.url=b.$url.attr("href");h=true}if(h!==true){return}if(a.isFunction(b.options.change)){if(!b.options.change(l)){b._resetState();return}}var k={version:e.jsonRpc.version,id:e.rpcId++,method:"bookmark.update",params:l};a.ajax({url:e.jsonRpc.target,type:e.jsonRpc.transport,dataType:"json",data:JSON.stringify(k),success:function(o,p,n){if(o.error!==null){a.notify({title:"Bookmark update failed",text:'<p class="error">'+o.error.message+"</p>"});b._resetState();return}if(o.result===null){return}b._squelch=true;b.$itemId.val(o.result.itemId);b.$name.text(o.result.name);b.$description.text(o.result.description);b.$tags.text(o.result.tags);b.$rating.stars("select",o.result.rating);b.$favorite.checkbox((o.result.isFavorite?"check":"uncheck"));b.$private.checkbox((o.result.isPrivate?"check":"uncheck"));b.$url.attr("href",o.result.url);var m=b.element.parent();if(o.result.isPrivate){m.addClass("private")}else{m.removeClass("private")}b._squelch=false;b._setState()},error:function(n,o,m){a.notify({title:"Bookmark update failed",text:'<p class="error">'+o+"</p>"});b._resetState()},complete:function(m,n){}});return false};var d=function(h){return;h.preventDefault();h.stopPropagation();if(b.options.enabled!==true){return}};var f=function(h){h.preventDefault();h.stopPropagation();if(b.options.enabled!==true){return}};var c=function(i){return;var h;if(b.options.enabled===true){try{h=a.registry("urls").base+"/post?format=partial&url="+e.url}catch(i){return}}i.preventDefault();i.stopPropagation();a.get(h,function(j){b._dialog_save(j)})};b.element.bind("change.bookmark",g);b.$edit.bind("click.bookmark",d);b.$delete.bind("click.bookmark",f);b.$save.bind("click.bookmark",c)},_dialog_save:function(c){c='<div class="ui-validation-form"><div class="userInput lastUnit">'+c+"</div></div>";var b=a(c);b.find("form").bookmarkPost();b.dialog({autoOpen:true,height:350,width:450,modal:true,close:function(){}})},_setState:function(){var b=this;var c=b.options;c.userId=b.$userId.val();c.itemId=b.$itemId.val();c.name=b.$name.text();c.description=b.$description.text();if(b.$rating.length>0){c.rating=b.$rating.stars("value")}c.isFavorite=b.$favorite.checkbox("isChecked");c.isPrivate=b.$private.checkbox("isChecked");c.url=b.$url.attr("href")},_resetState:function(){var b=this;var c=b.options;b._squelch=true;b.$name.text(c.name);b.$description.text(c.description);if(b.$rating.length>0){b.$rating.stars("select",c.rating)}b.$favorite.checkbox((c.isFavorite?"check":"uncheck"));b.$private.checkbox((c.isPrivate?"check":"uncheck"));b.$url.attr("href",c.url);b._squelch=false},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!b.options.enabled){b.options.enabled=true;b.element.removeClass("ui-state-disabled");b.$favorite.checkbox("enable");b.$private.checkbox("enable");b.$rating.stars("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(b.options.enabled){b.options.enabled=false;b.element.addClass("ui-state-disabled");b.$favorite.checkbox("disable");b.$private.checkbox("disable");b.$rating.stars("disable");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$favorite.unbind(".bookmark");b.$private.unbind(".bookmark");b.$rating.unbind(".bookmark");b.$edit.unbind(".bookmark");b.$delete.unbind(".bookmark");b.$save.unbind(".bookmark");b.$favorite.checkbox("destroy");b.$private.checkbox("destroy");b.$rating.stars("destroy")}})}(jQuery));(function(a){a.widget("connexions.bookmarkList",{version:"0.0.1",widgetEventPrefix:"",options:{namespace:"",dimOpacity:0.5},_create:function(){var b=this;var c=b.options;b.$bookmarks=b.element.find("form.bookmark");b.$headers=b.element.find(".groupHeader .groupType");b.$bookmarks.bookmark();b.$headers.fadeTo(100,c.dimOpacity).hover(function(){b.$headers.fadeTo(100,1)},function(){b.$headers.fadeTo(100,c.dimOpacity)});b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options},destroy:function(){var b=this;b.$headers.unbind("hover");b.$bookmarks.bookmark("destroy")}})}(jQuery));(function(a){a.widget("connexions.pane",{version:"0.0.1",options:{namespace:"",partial:null,pageCur:null,pageVar:null,page:null,paginator:{},displayOptions:{}},_create:function(){this._paneInit()},_paneInit:function(){this._init_paginators();this._init_displayOptions()},_init_paginators:function(){var b=this;var c=b.options;b.$paginators=b.element.find("form.paginator");b.$paginators.each(function(e){var d=a(this);d.paginator({namespace:c.namespace,form:d,disableHover:(e!==0)});if(c.page===null){c.pageCur=d.paginator("getPage");c.pageVar=d.paginator("getPageVar")}});b.$paginators.bind("submit.uipane",function(d){d.preventDefault(true);d.stopPropagation(true);d.stopImmediatePropagation(true);c.page=a(this).paginator("getPage");b.reload()})},_init_displayOptions:function(){var c=this;c.$displayOptions=c.element.find("div.displayOptions");if(c.$displayOptions.length<1){return}var d=c.options;var b=(d.displayOptions===undefined?{}:d.displayOptions);if(b.namespace===undefined){b.namespace=d.namespace}if(!a.isFunction(b.apply)){b.apply=function(f){f.stopImmediatePropagation();f.preventDefault();f.stopPropagation();c.reload()}}c.$displayOptions.dropdownForm(b)},_paneDestroy:function(){var b=this;b.$paginators.paginator("destroy");b.$displayOptions.dropdownForm("destroy")},reload:function(g){var b=this;var e=b.options;var d=new RegExp(e.pageVar+"="+e.pageCur);var f=e.pageVar+"="+e.page;var h=window.location;var c=h.toString();if(h.search.length===0){c+="?"+f}else{if(!c.match(d)){c+="&"+f}else{c=c.replace(d,f)}}if(e.partial!==null){c+="&format=partial&part="+e.partial;a.ajax({url:c,dataType:"html",beforeSend:function(){b.element.mask()},error:function(k,i,j){a.notify({title:'Reload pane "'+e.partial+'" failed',text:'<p class="error">'+i+"</p>"})},success:function(k,i,j){b.destroy();b.element.html(k);b._create()},complete:function(){b.element.unmask()}})}else{window.location.assign(c)}},destroy:function(){this._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.bookmarksPane",a.connexions.pane,{version:"0.0.1",options:{namespace:""},_create:function(){var b=this;var c=b.options;b._init_bookmarkList();b._paneInit()},_init_bookmarkList:function(){var c=this;c.$bookmarkList=c.element.find("ul.bookmarks");if(c.$bookmarkList.length<1){return}var d=c.options;var b=(d.bookmarkList===undefined?{}:d.bookmarkList);if(b.namespace===undefined){b.namespace=d.namespace}c.$bookmarkList.bookmarkList(b)},destroy:function(){var b=this;b.$bookmarkList.bookmarkList("destroy");b._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.cloudPane",a.connexions.pane,{version:"0.0.1",options:{namespace:""},_create:function(){var b=this;var c=b.options;b._paneInit();b.$optionsForm=b.element.find(".displayOptions form");b._bindEvents()},_bindEvents:function(){this.$optionsForm.bind("change.cloudPane",function(d,c){var b=a(this).find(".field.highlightCount");if(c.group==="cloud"){b.removeClass("ui-state-disabled");b.find("select").removeAttr("disabled")}else{b.addClass("ui-state-disabled");b.find("select").attr("disabled",true)}})},destroy:function(){var b=this;b.$optionsForm.unbind(".cloudPane");b._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.sidebar",{version:"0.0.1",options:{namespace:""},_create:function(){var b=this;var c=b.options;c.namespace=b.element.attr("id");b.element.tabs({cache:true,cookie:c.namespace,ajaxOptions:{beforeSend:function(){var d=b.element.tabs("option","selected");b.$tab=b.element.find(".ui-tabs-panel").eq(d);b.$tab.mask()},complete:function(){b._bindReload(b.$tab);b.$tab.unmask()}}});b.element.find("ul:first li a:first").each(function(e){var d=a.data(this,"load.tabs");if(d){var f=b.element.find(".ui-tabs-panel").eq(e);b._bindReload(f)}});b._bindReload(b.element)},_bindReload:function(c){var b=this;c.find(".displayOptions").dropdownForm("setApplyCb",function(d){d.preventDefault();d.stopPropagation();d.stopImmediatePropagation();b.element.tabs("load",b.element.tabs("option","selected"))})},destroy:function(){this.element.tabs("destroy")}})}(jQuery));(function(a){a.widget("connexions.search",{options:{},_create:function(){var b=this;var c=b.options;b.$input=b.element.find("input[name=q]");b.$submit=b.element.find("button.submit");b.$context=b.element.find("input[name=searchContext]");b.$choices=b.element.find(".choices .list");b.contextLabel=b.$choices.find("li.active").text();b.$submit.addClass("ui-state-disabled").attr("disabled",true);b.$input.input({validation:function(d){if(d.length>0){b.$submit.removeClass("ui-state-disabled").removeAttr("disabled")}else{b.$submit.addClass("ui-state-disabled").attr("disabled",true)}return true}});b.$input.input("setLabel",b.contextLabel);b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;b.$choices.find("li").bind("mousedown.search",function(d){b.$input.input("setLabel",null)}).bind("click.search",function(f){var g=a(this);var d=g.attr("id").replace(/search-choice-/,"");b.$context.val(d);b.contextLabel=g.text();g.siblings(".active").removeClass("active");g.addClass("active");b.$input.input("setLabel",b.contextLabel)})},destroy:function(){var b=this;b.$input.input("destroy");b.$choices.find("li").unbind(".search")}})}(jQuery));(function(a){a.widget("connexions.bookmarkPost",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,tags:null,url:null,statusEl:null,jsonRpc:null,rpcId:1,enabled:true},_create:function(){var b=this;var d=b.options;b.element.hide();b.element.addClass("ui-form");if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({method:"bookmark.update"},c.jsonRpc,d.jsonRpc)}}if((d.statusEl!==null)&&(d.statusEl.jquery===undefined)){d.statusEl=a(d.statusEl)}b.$required=b.element.find(".required");b.$userId=b.element.find("input[name=userId]");b.$itemId=b.element.find("input[name=itemId]");b.$favorite=b.element.find("input[name=isFavorite]");b.$private=b.element.find("input[name=isPrivate]");b.$rating=b.element.find(".userRating .stars-wrapper");b.$name=b.element.find("input[name=name]");b.$url=b.element.find("input[name=url]");b.$description=b.element.find("textarea[name=description]");b.$tags=b.element.find("textarea[name=tags]");b.$save=b.element.find("button[name=submit]");b.$cancel=b.element.find("button[name=cancel]");b.$inputs=b.element.find("input[type=text],input[type=password],textarea");b.$cte=b.element.find(".click-to-edit");b.$tags.autocomplete({source:function(f,e){return b._autocomplete(f,e)}});b.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});b.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});b.$rating.stars({});b.$save.addClass("ui-priority-primary").button({disabled:true});b.$cancel.addClass("ui-priority-secondary").button({disabled:false});b.$inputs.input();b.$required.after('<div class="ui-field-info"><div class="ui-field-status"></div><div class="ui-field-requirements">required</div></div>');b.$required.filter("[name=tags]").next(".ui-field-info").find(".ui-field-requirements").text("comma-separated, 30 characters per tag - required");b.$required.each(function(){var e=a(this);e.next().css("width",e.css("width"))});b._setStateFromForm();b._bindEvents();b.element.show()},_setStateFromForm:function(){var b=this;var c=b.options;c.name=b.$name.val();c.description=b.$description.val();c.tags=b.$tags.val();c.isFavorite=b.$favorite.checkbox("isChecked");c.isPrivate=b.$private.checkbox("isChecked");c.url=b.$url.val();if(b.$userId.length>0){c.userId=b.$userId.val()}if(b.$userId.length>0){c.itemId=b.$itemId.val()}if(b.$rating.length>0){c.rating=b.$rating.stars("value")}},_setFormFromState:function(){var b=this;var c=b.options;b.$name.val(c.name);b.$description.val(c.description);b.$tags.val(c.tags);b.$favorite.checkbox(c.isFavorite?"check":"uncheck");b.$private.checkbox(c.isPrivate?"check":"uncheck");b.$url.val(c.url);if(b.$userId.length>0){b.$userId.val(c.userId)}if(b.$userId.length>0){b.$itemId.val(c.itemId)}if(b.$rating.length>0){b.$rating.stars("value",c.rating)}},_bindEvents:function(){var b=this;var e=b.options;var c=function(i,h){i.stopImmediatePropagation();i.preventDefault();i.stopPropagation();a.log("connexions.bookmarkPost::_save_click("+h+")");b._performUpdate();return false};var g=function(i,h){i.stopImmediatePropagation();i.preventDefault();i.stopPropagation();b._trigger("canceled",null,h)};var f=function(j,i){var h=a(this);if(h.data("validationInitialized")!==true){h.data("validationInitialized",true);return}h.removeClass("click-to-edit").unbind("validationChange")};var d=function(){var h=true;b.$required.each(function(){if(!a(this).hasClass("ui-state-valid")){h=false;return false}});if(h){b.$save.button("enable");b._status(true)}else{b.$save.button("disable");b._status(false)}};b.$inputs.bind("validation_change.bookmarkPost",d);b.$cte.bind("validation_change.bookmarkPost",f);b.$save.bind("click.bookmarkPost",c);b.$cancel.bind("click.bookmarkPost",g);d()},_performUpdate:function(){var c=this;var d=c.options;if(d.enabled!==true){return}var b=false;var f={id:{userId:d.userId,itemId:d.itemId}};if(c.$name.val()!==d.name){f.name=c.$name.val();b=true}if(c.$description.val()!==d.description){f.description=c.$description.val();b=true}if((c.$tags.length>0)&&(c.$tags.val()!==d.tags)){f.tags=c.$tags.val();b=true}if(c.$favorite.checkbox("isChecked")!==d.isFavorite){f.isFavorite=c.$favorite.checkbox("isChecked");b=true}if(c.$private.checkbox("isChecked")!==d.isPrivate){f.isPrivate=c.$private.checkbox("isChecked");b=true}if((c.$rating.length>0)&&(c.$rating.stars("value")!==d.rating)){f.rating=c.$rating.stars("value");b=true}if(c.$url.val()!==d.url){f.url=c.$url.val();b=true}if(b!==true){return}if(f.id.itemId===null){f.id.itemId=(f.url!==undefined?f.url:d.url)}var e={version:d.jsonRpc.version,id:d.rpcId++,method:d.jsonRpc.method,params:f};c.element.mask();a.ajax({url:d.jsonRpc.target,type:d.jsonRpc.transport,dataType:"json",data:JSON.stringify(e),success:function(i,j,h){if(i.error!==null){c._status(false,"Bookmark update failed",i.error.message);return}c._status(true,null,"Bookmark "+(d.itemId===null?"created":"updated"));if(i.result===null){return}c.options=a.extend(c.options,i.result);d=c.options;if(a.isArray(d.tags)){var g=[];a.each(d.tags,function(){g.push(this.tag)});d.tags=g.join(",")}c._setFormFromState();c._trigger("saved",null,i.result)},error:function(h,i,g){c._status(false,"Bookmark update failed",i)},complete:function(g,h){c.element.unmask()}})},_autocomplete:function(e,c){var b=this;var d=b.options;var g=d.rpcId++;var f={version:d.jsonRpc.version,id:g,method:"bookmark.autocompleteTag",params:{id:{userId:d.userId,itemId:d.itemId}}};if(f.params.id.itemId===null){f.params.id.itemId=b.$url.val()}f.params.str=b.$tags.autocomplete("option","term");a.ajax({type:d.jsonRpc.transport,url:d.jsonRpc.target,dataType:"json",data:JSON.stringify(f),success:function(h,i,j){if(h.error!==null){b.element.trigger("error",[i,j,h.error]);return}c(a.map(h.result,function(k){return{label:'<span class="name">'+k.tag+'</span> <span class="count">'+k.userItemCount+"</span>",value:k.tag}}));b.element.trigger("success",[h,i,j])},error:function(i,h,j){b.element.trigger("error",[h,i])}})},_status:function(b,g,f){var c=this;var d=c.options;if(d.statusEl===null){if((g!==undefined)&&(f!==undefined)){a.notify({title:g,text:f})}}else{var e="";if(f!==undefined){e+=f}d.statusEl.html(e);if(b){d.statusEl.removeClass("error").addClass("success")}else{d.statusEl.removeClass("success").addClass("error")}}},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!c.enabled){c.enabled=true;b.element.removeClass("ui-state-disabled");b.$favorite.checkbox("enable");b.$private.checkbox("enable");b.$rating.stars("enable");b.$inputs.input("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(c.enabled){c.enabled=false;b.element.addClass("ui-state-disabled");b.$favorite.checkbox("disable");b.$private.checkbox("disable");b.$rating.stars("disable");b.$inputs.input("disable");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$save.removeClass("ui-priority-primary");b.$cancel.removeClass("ui-priority-secondary");b.$required.next(".ui-field-info").remove();b.element.removeClass("ui-form");b.$inputs.unbind(".bookmarkPost");b.$cte.unbind(".bookmarkPost");b.$save.unbind(".bookmarkPost");b.$cancel.unbind(".bookmarkPost");b.$favorite.checkbox("destroy");b.$private.checkbox("destroy");b.$rating.stars("destroy");b.$inputs.input("destroy");b.$save.button("destroy");b.$cancel.button("destroy")}})}(jQuery));(function(a){a.widget("connexions.autocomplete",a.ui.autocomplete,{version:"0.0.1",options:{delay:200,minLength:2,separator:","},_init:function(){var b=this;var c=b.options;a.each(["search","focus","select"],function(){var e=this;var f=b["_do_"+e];var d=(a.isFunction(c[e])?c[e]:null);c[this]=function(h,i){var g=f.call(b,h,i);if(g!==false){if(d!==null){g=d.call(b.element[0],h,i)}}return g}})},_do_search:function(){var b=this._curTerm();if(b.length<this.options.minLength){return false}},_do_focus:function(){return false},_do_select:function(d,e){var c=this.options;var b=new RegExp("(\\s*"+c.separator+"\\s*)+","g");var f=c.val.substring(0,c.start)+e.item.value+c.val.substring(c.end)+c.separator+" ";f=f.replace(b,c.separator+" ");this.element.val(f);return false},_curTerm:function(){var b=this;var d=b.options;d.start=b._selectionStart();d.end=b._selectionEnd();d.val=b.element.val();if(d.start===d.end){d.end=d.val.indexOf(d.separator,d.start);if(d.end<0){d.end=d.val.length}var c=d.val.indexOf(d.separator,0);var e=0;while((c>=0)&&(c<d.start)){while((c<d.end)&&(d.val.substr(++c,1).match(/\s/))){}e=c;c=d.val.indexOf(d.separator,c)}d.start=e}d.term=d.val.substring(d.start,d.end);return d.term},_selectionStart:function(){var d=this;var e=0;if(d.element[0].createTextRange){var c=document.selection.createRange().duplicate();var b=d.element.val();c.moveEnd("character",b.length);if(c.text===""){e=b.length}else{e=b.lastIndexOf(c.text)}}else{e=d.element.attr("selectionStart")}return e},_selectionEnd:function(){var d=this;var e=0;if(d.element[0].createTextRange){var c=document.selection.createRange().duplicate();var b=d.element.val();c.moveEnd("character",-(b.length));e=c.text.length}else{e=d.element.attr("selectionEnd")}return e}})}(jQuery));