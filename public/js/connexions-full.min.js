(function(c){function a(){c.log=function(e){if((window.console!==undefined)&&c.isFunction(window.console.log)){var g=e;for(var f=1;f<arguments.length;f++){g=g.replace(/%s/,arguments[f])}window.console.log(g)}};c.log("Logging enabled")}if((window.console===undefined)||(!c.isFunction(window.console.log))){c(document).ready(a)}else{a()}if(c.browser.msie){try{document.execCommand("BackgroundImageCache",false,true)}catch(d){}}var b=0;c.jsonRpc=function(f,i,h,e){var g={version:f.version,id:b++,method:i,params:h};e=c.extend({},e,{url:f.target,type:f.transport,dataType:"json",data:JSON.stringify(g)});c.ajax(e)};c.validatePasswords=function(e,j,i){var g=j.val();var f=i.val();var h=true;if((g.length<1)||(f.length<1)){h=undefined;if(e[0]===j[0]){i.input("valid")}else{j.input("valid")}}else{if(g!==f){h="Passwords do not match.";if(e[0]===j[0]){i.input("valid",h);h=undefined}else{j.input("valid")}}else{if(e[0]===j[0]){i.input("valid",true)}else{j.input("valid",true)}}}return h};c.fn.mask=function(){return this.each(function(){var h=c("#pageHeader h1 a img");var g=c(this);var i=g.css("z-index");if(i==="auto"){i=99999}else{i++}var e=c("<div></div>").addClass("ui-widget-overlay").appendTo(g).css({width:g.outerWidth(),height:g.outerHeight(),"z-index":i});if(h.length>0){var f=h.attr("src");h.attr("src",f.replace(".gif","-spinner.gif"))}if(c.fn.bgiframe){e.bgiframe()}})};c.fn.unmask=function(){return this.each(function(){var h=c("#pageHeader h1 a img");var g=c(this);var e=g.find(".ui-widget-overlay");e.remove();if(h.length>0){var f=h.attr("src");h.attr("src",f.replace("-spinner.gif",".gif"))}})}}(jQuery));(function(a){a.registry=function(b,c){if(c!==undefined){a.data(document,b,c)}else{return a.data(document,b)}}}(jQuery));jQuery.cookie=function(b,j,m){if(typeof j!=="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires==="number"||m.expires.toUTCString)){var f;if(typeof m.expires==="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!==""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)===(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};(function(a){jQuery.fn.pngFix=function(d){d=jQuery.extend({blankgif:"blank.gif"},d);var c=(navigator.appName==="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)===4&&navigator.appVersion.indexOf("MSIE 5.5")!==-1);var b=(navigator.appName==="Microsoft Internet Explorer"&&parseInt(navigator.appVersion)===4&&navigator.appVersion.indexOf("MSIE 6.0")!==-1);if(jQuery.browser.msie&&(c||b)){jQuery(this).find("img[src$=.png]").each(function(){jQuery(this).attr("width",jQuery(this).width());jQuery(this).attr("height",jQuery(this).height());var l="";var g="";var f=(jQuery(this).attr("id"))?'id="'+jQuery(this).attr("id")+'" ':"";var m=(jQuery(this).attr("class"))?'class="'+jQuery(this).attr("class")+'" ':"";var i=(jQuery(this).attr("title"))?'title="'+jQuery(this).attr("title")+'" ':"";var j=(jQuery(this).attr("alt"))?'alt="'+jQuery(this).attr("alt")+'" ':"";var h=(jQuery(this).attr("align"))?"float:"+jQuery(this).attr("align")+";":"";var e=(jQuery(this).parent().attr("href"))?"cursor:hand;":"";if(this.style.border){l+="border:"+this.style.border+";";this.style.border=""}if(this.style.padding){l+="padding:"+this.style.padding+";";this.style.padding=""}if(this.style.margin){l+="margin:"+this.style.margin+";";this.style.margin=""}var k=(this.style.cssText);g+="<span "+f+m+i+j;g+='style="position:relative;white-space:pre-line;display:inline-block;background:transparent;'+h+e;g+="width:"+jQuery(this).width()+"px;height:"+jQuery(this).height()+"px;";g+="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+jQuery(this).attr("src")+"', sizingMethod='scale');";g+=k+'"></span>';if(l!==""){g='<span style="position:relative;display:inline-block;'+l+e+"width:"+jQuery(this).width()+"px;height:"+jQuery(this).height()+'px;">'+g+"</span>"}jQuery(this).hide();jQuery(this).after(g)});jQuery(this).find("*").each(function(){var f=jQuery(this).css("background-image");if(f.indexOf(".png")!==-1){var e=f.split('url("')[1].split('")')[0];jQuery(this).css("background-image","none");jQuery(this).get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"',sizingMethod='scale')"}});jQuery(this).find("input[src$=.png]").each(function(){var e=jQuery(this).attr("src");jQuery(this).get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale');";jQuery(this).attr("src",d.blankgif)})}return jQuery}}(jQuery));(function(a){a.widget("ui.checkbox",{version:"0.1.1",widgetEventPrefix:"",options:{css:"checkbox",cssOn:"on",cssOff:"off",titleOn:"click to turn off",titleOff:"click to turn on",useElTitle:true,hideLabel:false},_create:function(){var b=this;var d=this.options;d.enabled=b.element.attr("disabled")?false:true;d.checked=b.element.attr("checked")?true:false;d.title="";b.element.data("value.uicheckbox",d.checked);var c=b.element.attr("name");var f=b.element.attr("id");b.$label=false;if(f){b.$label=a("label[for="+f+"]")}if(((!b.$label)||(b.$label.length<1))&&c){b.$label=a("label[for="+c+"]")}if(d.useElTitle===true){d.title=b.element.attr("title");if(((!d.title)||(d.title.length<1))&&(b.$label.length>0)){d.title=b.$label.text()}}var e=d.title+(d.checked?d.titleOn:d.titleOff);b.$el=a('<span class="checkbox"><div class="'+d.css+(d.enabled?" ":" diabled ")+(d.checked?d.cssOn:d.cssOff)+'"'+(e&&e.length>0?' title="'+e+'"':"")+">&nbsp;</div></span>");b.img=b.$el.find("div");b.$el.insertAfter(b.element);b.element.hide();b.$value=a('<input type="hidden" '+(f?'id="'+f+'" ':"")+'name="'+c+'" />');b.$value.attr("value",d.checked);b.$value.insertBefore(b.$el);if(b.$label&&(b.$label.length>0)){if(d.hideLabel===true){b.$label.hide()}else{b.$label.click(function(g){g.preventDefault();g.stopPropagation();b.$el.trigger("click",[g]);return false})}}b._bindEvents()},_bindEvents:function(){var d=this;var c=function(h){if(d.options.enabled===true){d.$el.addClass("ui-state-hover")}};var g=function(h){d.$el.removeClass("ui-state-hover")};var f=function(h){if(d.options.enabled===true){d.$el.addClass("ui-state-focus")}};var e=function(h){d.$el.removeClass("ui-state-focus")};var b=function(h){d.toggle()};d.$el.bind("mouseenter.uicheckbox",c).bind("mouseleave.uicheckbox",g).bind("focus.uicheckbox",f).bind("blur.uicheckbox",e).bind("click.uicheckbox",b)},isChecked:function(){return this.options.checked},isEnabled:function(){return this.options.enabled},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.$el.removeClass("ui-state-disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.$el.addClass("ui-state-disabled");this._trigger("disabled")}},toggle:function(){if(!this.options.enabled){return}if(this.options.checked){this.uncheck()}else{this.check()}},check:function(){if(this.options.enabled&&(!this.options.checked)){this.options.checked=true;this.$value.attr("value",this.options.checked);this.img.removeClass(this.options.cssOff).addClass(this.options.cssOn).attr("title",this.options.title+this.options.titleOn);this._trigger("change",null,"check")}},uncheck:function(){if(this.options.enabled&&this.options.checked){this.options.checked=false;this.$value.attr("value",this.options.checked);this.img.removeClass(this.options.cssOn).addClass(this.options.cssOff).attr("title",this.options.title+this.options.titleOff);this._trigger("change",null,"uncheck")}},reset:function(){if(this.element.data("value.uicheckbox")){this.check()}else{this.uncheck()}},hasChanged:function(){return(this.options.checked!==this.element.data("value.uicheckbox"))},destroy:function(){if(this.$label){this.$label.show()}this.$el.unbind(".uicheckbox");this.$value.remove();this.$el.remove();this.element.show()}})}(jQuery));(function(a){a.widget("ui.input",{version:"0.1.1",widgetEventPrefix:"",options:{priority:"normal",$label:null,hideLabel:true,$validation:null,validation:null},_create:function(){var b=this;var c=this.options;b.saved(true);c.enabled=b.element.attr("disabled")?false:true;if(c.$validation){if(c.$validation.jquery===undefined){c.$validation=a(c.$validation)}}else{c.$validation=b.element.parent().find(".ui-field-status:first")}if((!c.validation)&&(b.element.hasClass("required"))){c.validation="!empty"}b.element.addClass("ui-input ui-corner-all ");b.keyTimer=null;if(c.priority==="primary"){b.element.addClass("ui-priority-primary")}else{if(c.priority==="secondary"){b.element.addClass("ui-priority-secondary")}}b.element.addClass("ui-state-default");if(!c.enabled){b.element.addClass("ui-state-disabled")}var d=b.element.attr("id");if((d===undefined)||(d.length<1)){d=b.element.attr("name")}if((d!==undefined)&&(d.length>0)){c.$label=b.element.parent().find("label[for="+d+"]")}else{c.$label=b.element.closest("label")}if(c.hideLabel===true){c.$label.addClass("ui-input-over").hide()}else{c.$label.addClass("ui-input-over").show()}b._bindEvents()},_bindEvents:function(){var d=this;var e=d.options;var c=function(i){if(d.options.enabled===true){d.element.addClass("ui-state-hover")}};var h=function(j){var i=a(this);i.removeClass("ui-state-hover")};var b=function(i){if(d.options.enabled!==true){return}if(d.keyTimer!==null){clearTimeout(d.keyTimer)}if(i.keyCode===9){return}d.valid(undefined);d.keyTimer=setTimeout(function(){d.validate()},1000)};var g=function(i){if(d.options.enabled===true){if(e.hideLabel===true){e.$label.hide()}d.element.removeClass("ui-state-empty").addClass("ui-state-focus ui-state-active")}};var f=function(i){d._blur()};d.element.bind("mouseenter.uiinput",c).bind("mouseleave.uiinput",h).bind("keydown.uiinput",b).bind("focus.uiinput",g).bind("blur.uiinput",f);e.$label.bind("click.uiinput",function(){d.element.focus()});if(d.val()!==""){d.validate()}else{if(e.hideLabel===true){e.$label.show()}}},_blur:function(){var b=this;var c=b.options;b.element.removeClass("ui-state-focus ui-state-active");if(!b.element.hasClass("ui-state-valid")){b.validate()}if(b.val()===""){b.element.addClass("ui-state-empty");if(c.hideLabel===true){c.$label.show()}}else{if(c.hideLabel===true){c.$label.hide()}b.element.removeClass("ui-state-empty")}},isEnabled:function(){return this.options.enabled},isValid:function(){return this.options.valid},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.element.removeClass("ui-state-disabled").removeAttr("disabled");this.options.$label.removeClass("ui-state-disabled").removeAttr("disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.element.attr("disabled",true).addClass("ui-state-disabled");this.options.$label.attr("disabled",true).addClass("ui-state-disabled");this._trigger("disabled")}},reset:function(){this.val(this.element.data("value.uiinput"));this.element.removeClass("ui-state-error ui-state-valid ui-state-changed");this._blur();this.element.removeClass("ui-state-error ui-state-valid ui-state-changed")},hasChanged:function(){return(this.val()!==this.element.data("value.uiinput"))},valid:function(b){if(b===this.options.valid){return}this.element.removeClass("ui-state-error ui-state-valid ui-state-changed");this.options.$validation.html("&nbsp;").removeClass("ui-state-invalid ui-state-valid");if(b===true){this.element.addClass("ui-state-valid");this.options.$validation.addClass("ui-state-valid")}else{if(b!==undefined){this.element.addClass("ui-state-error");this.options.$validation.addClass("ui-state-invalid");if(typeof b==="string"){this.options.$validation.html(b)}}}if(this.hasChanged()){this.element.addClass("ui-state-changed")}this.options.valid=b;if(b!==undefined){this._trigger("validation_change",null,[b])}},getLabel:function(){return this.options.$label.text()},setLabel:function(b){this.options.$label.text(b)},getOrigValue:function(){return this.element.data("value.uiinput")},saved:function(b){this.element.data("value.uiinput",this.val());if(b!==true){this.options.valid=undefined;this.validate()}},val:function(c){if(c!==undefined){c=a.trim(c);this.element.removeClass("ui-state-valid");delete this.options.valid;var b=this.element.val(c);this._blur();return b}return a.trim(this.element.val())},validate:function(){var d=[];var c;if(this.options.validation===null){this.valid(true);return}if(a.isFunction(this.options.validation)){var b=this.options.validation.apply(this.element,[this.val()]);if(typeof b==="string"){c=false;d.push(b)}else{c=b}}else{if(this.options.validation==="!empty"){c=((this.val().length>0)?true:false);if(!c){d.push("Cannot be empty")}}}this.valid(((c===false)&&(d.length>0)?d.join("<br />"):c))},destroy:function(){this.options.$validation.removeClass("ui-state-valid ui-state-invalid ");this.options.$label.unbind(".uiinput");this.element.removeClass("ui-state-default ui-state-disabled ui-state-hover ui-state-valid ui-state-error ui-state-focus ui-state-active ui-priority-primary ui-priority-secondary ").unbind(".uiinput").removeData(".uiinput")}})}(jQuery));
/*
 * jQuery UI Stars v2.1.1
 * http://plugins.jquery.com/project/Star_Rating_widget
 *
 * Copyright (c) 2009 Orkan (orkans@gmail.com)
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * $Rev: 114 $
 * $Date:: 2009-06-12 #$
 * $Build: 32 (2009-06-12)
 *
 * Take control of pre-assembled HTML:
 *  <div >
 *    <input class='ui-stars-rating' type='hidden' name='rating' value='...' />
 *    <div class='ui-stars ui-stars-cancel ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    ...
 *  </div>
 *
 * Depends:
 *      ui.core.js
 *      ui.widget.js
 *
 */
(function(a){a.widget("ui.stars",{version:"2.1.1b",widgetEventPrefix:"",options:{inputType:"div",split:0,disabled:false,cancelTitle:"Cancel Rating",cancelValue:0,cancelShow:true,oneVoteOnly:false,showTitles:false,captionEl:null,callback:null,starWidth:16,baseClass:"ui-stars",cancelClass:"ui-stars-cancel",starClass:"ui-stars-star",starOnClass:"ui-stars-star-on",starHoverClass:"ui-stars-star-hover",starDisabledClass:"ui-stars-star-disabled",cancelHoverClass:"ui-stars-cancel-hover",cancelDisabledClass:"ui-stars-cancel-disabled"},_create:function(){var b=this,e=this.options,f=0;this.$stars=a("."+e.starClass,this.element);this.$cancel=a("."+e.cancelClass,this.element);this.$input=a("input[type=hidden]:first",this.element);e.items=this.$stars.filter("."+e.starClass).length;e.value=this.$stars.filter("."+e.starOnClass).length;if(e.value>0){e.checked=e.defaultValue=e.value}else{e.value=e.defaultValue=e.cancelValue}if(e.disabled){this.$cancel.addClass(e.cancelDisabledClass)}e.cancelShow&=!e.oneVoteOnly;function d(){b.$stars.removeClass(e.starOnClass+" "+e.starHoverClass);b._showCap("")}function c(g,i){if(g>=0){var j=i?e.starHoverClass:e.starOnClass;var h=i?e.starOnClass:e.starHoverClass;b.$stars.eq(g).removeClass(h).addClass(j).prevAll("."+e.starClass).removeClass(h).addClass(j);b.$stars.eq(g).nextAll("."+e.starClass).removeClass(e.starHoverClass+" "+e.starOnClass);b._showCap(b.$stars.eq(g).find("a").attr("title"))}else{d()}}this.$stars.bind("click.stars",function(h){if(!e.forceSelect&&e.disabled){return false}var g=b.$stars.index(this);e.checked=g;e.value=g+1;e.title=a(this).find("a").attr("title");b.$input.val(e.value);c(e.checked,false);b._disableCancel();if(!e.forceSelect){b.callback(h,"star")}b._trigger("change",null,e.value)}).bind("mouseover.stars",function(){if(e.disabled){return false}var g=b.$stars.index(this);c(g,true)}).bind("mouseout.stars",function(){if(e.disabled){return false}c(e.checked,false)});this.$cancel.bind("click.stars",function(g){if(!e.forceSelect&&(e.disabled||e.value===e.cancelValue)){return false}e.checked=-1;e.value=e.cancelValue;b.$input.val(e.cancelValue);d();b._disableCancel();if(!e.forceSelect){b.callback(g,"cancel")}b._trigger("change",null,e.value)}).bind("mouseover.stars",function(){if(b._disableCancel()){return false}b.$cancel.addClass(e.cancelHoverClass);d();b._showCap(e.cancelTitle)}).bind("mouseout.stars",function(){if(b._disableCancel()){return false}b.$cancel.removeClass(e.cancelHoverClass);b.$stars.triggerHandler("mouseout.stars")});a(window).unload(function(){b.$cancel.unbind(".stars");b.$stars.unbind(".stars");b.$stars=b.$cancel=null});this.select(e.value);if(e.disabled){this.disable()}},_disableCancel:function(){var c=this.options,b=c.disabled||c.oneVoteOnly||(c.value===c.cancelValue);if(b){this.$cancel.removeClass(c.cancelHoverClass).addClass(c.cancelDisabledClass)}else{this.$cancel.removeClass(c.cancelDisabledClass)}this.$cancel.css("opacity",b?0.5:1);return b},_disableAll:function(){var b=this.options;this._disableCancel();if(b.disabled){this.$stars.filter("div").addClass(b.starDisabledClass)}else{this.$stars.filter("div").removeClass(b.starDisabledClass)}},_showCap:function(b){var c=this.options;if(c.captionEl){c.captionEl.text(b)}},value:function(){return this.options.value},select:function(d){var c=this.options,b=(d===c.cancelValue)?this.$cancel:this.$stars.eq(d-1);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},selectID:function(d){var c=this.options,b=(d===-1)?this.$cancel:this.$stars.eq(d);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},enable:function(){this.options.disabled=false;this._disableAll()},disable:function(){this.options.disabled=true;this._disableAll()},hasChanged:function(){return(this.options.value!==this.options.defaultValue)},reset:function(){this.select(this.options.defaultValue)},destroy:function(){this.$cancel.unbind(".stars");this.$stars.unbind(".stars");this.element.unbind(".stars").removeData("stars")},callback:function(c,b){var d=this.options;if(d.callback){d.callback(this,b,d.value,c)}if(d.oneVoteOnly&&!d.disabled){this.disable()}}})}(jQuery));(function(a){a.widget("ui.notify",{options:{speed:500,expires:5000,stack:"below"},_create:function(){var b=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message").each(function(d){var c=this.id||d;b.keys.push(c);b.templates[c]=a(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty()},create:function(b,d,c){if(typeof b==="object"){c=d;d=b;b=null}return new a.ui.notify.instance(this)._create(d,a.extend({},this.options,c),this.templates[b||this.keys[0]])}});a.extend(a.ui.notify,{instance:function(b){this.parent=b;this.isOpen=false}});a.extend(a.ui.notify.instance.prototype,{_create:function(h,e,g){this.options=e;var d=this,f=g.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(i,j){return(j in h)?h[j]:""}),c=(this.element=a(f)),b=c.find("a.ui-notify-close");if(this._trigger("beforeopen")===false){return}if(typeof this.options.click==="function"){c.addClass("ui-notify-click").bind("click",function(i){d._trigger("click",i,d)})}if(b.length&&!!e.expires){b.remove()}else{if(b.length){b.bind("click",function(){d.close();return false})}}this.open();if(typeof e.expires==="number"){window.setTimeout(function(){d.close()},e.expires)}return this},close:function(){var b=this,c=this.options.speed;this.isOpen=false;this.element.fadeTo(c,0).slideUp(c,function(){b._trigger("close")});return this},open:function(){if(this.isOpen){return this}var b=this;this.isOpen=true;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.parent.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){b._trigger("open")});return this},widget:function(){return this.element},_trigger:function(c,d,b){return this.parent._trigger.call(this,c,d,b)}})}(jQuery));(function(a){a.widget("ui.validationForm",{version:"0.1.1",widgetEventPrefix:"",options:{submitSelector:"button[name=submit]",hideLabels:true,disableSubmitOnUnchanged:true,$status:null},_init:function(){var b=this;var c=this.options;b.element.addClass("ui-form");if(!a.isFunction(c.validate)){c.validate=function(){return b._validate()}}c.enabled=b.element.attr("disabled")?false:true;if(c.$status){if(c.$status.jquery===undefined){c.$status=a(c.$status)}}else{c.$status=b.element.parent().find(".ui-form-status:first")}c.$required=b.element.find(".required");c.$inputs=b.element.find("input[type=text],input[type=password],textarea");if(c.$submit===undefined){c.$submit=b.element.find(c.submitSelector)}c.$cancel=b.element.find("button[name=cancel]");c.$reset=b.element.find("button[name=reset]");c.$inputs.input({hideLabel:c.hideLabels});c.$submit.button({priority:"primary",enabled:false});c.$cancel.button({priority:"secondary"});c.$reset.button({priority:"secondary"});b._bindEvents();b.validate()},_bindEvents:function(){var c=this;var d=c.options;var e=function(f){c.validate()};var b=function(f){f.preventDefault();f.stopPropagation();c.reset()};d.$inputs.bind("validation_change.uivalidationform",e);d.$reset.bind("click.uivalidationform",b);d.$submit.bind("click.uivalidationform",function(f){f.preventDefault();f.stopPropagation();c._trigger("submit")});d.$cancel.bind("click.uivalidationform",function(f){f.preventDefault();f.stopPropagation();c._trigger("cancel")})},_validate:function(){var b=this;var c=b.options;var d=true;c.$required.each(function(){if(!a(this).hasClass("ui-state-valid")){d=false;return false}});return d},isEnabled:function(){return this.options.enabled},enable:function(){if(!this.options.enabled){this.options.enabled=true;this.element.removeClass("ui-state-disabled").removeAttr("disabled");this.options.$label.removeClass("ui-state-disabled").removeAttr("disabled");this._trigger("enabled")}},disable:function(){if(this.options.enabled){this.options.enabled=false;this.element.attr("disabled",true).addClass("ui-state-disabled");this.options.$label.attr("disabled",true).addClass("ui-state-disabled");this._trigger("disabled")}},reset:function(){var b=this;var c=this.options;c.$inputs.input("reset");b.validate()},saved:function(){this.options.$inputs.input("saved");this.validate()},hasChanged:function(){var b=this;var d=this.options;var c=false;d.$inputs.each(function(){if(a(this).input("hasChanged")){c=true;return false}});return c},rebind:function(){var b=this;var c=b.options;c.$required=b.element.find(".required");c.$inputs=b.element.find("input[type=text],input[type=password],textarea");c.$inputs.unbind(".uivalidationform");b._bindEvents()},validate:function(){var b=this;var c=b.options;var d=b._trigger("validate");if(d){c.$status.removeClass("error").addClass("success").text("")}else{c.$status.removeClass("success").addClass("error")}if(d&&((c.disableSubmitOnUnchanged===false)||b.hasChanged())){c.$submit.button("enable")}else{c.$submit.button("disable")}},destroy:function(){var b=this;var c=b.options;b.element.unbind(".uivalidationform");c.$inputs.unbind(".uivalidationform");c.$submit.unbind(".uivalidationform");c.$cancel.unbind(".uivalidationform");c.$reset.unbind(".uivalidationform");c.$inputs.input("destroy");c.$submit.button("destroy");c.$cancel.button("destroy");c.$reset.button("destroy");b.element.removeClass("ui-form")}})}(jQuery));(function(b){var a=0;b.widget("connexions.collapsable",{version:"0.0.1",options:{cache:true,ajaxOptions:null,cookie:null,idPrefix:"connexions-collapsable-",panelTemplate:"<div></div>"},_create:function(){var d=this;var e=d.options;d.$toggle=d.element.find(".toggle:first");d.$a=d.$toggle.find("a:first");if(d.$a.length>0){var c=d.$a.attr("href");if(!c.match(/^#.+/)){d.$a.data("href.collapsable",c);d.$a.data("load.collapsable",c.replace(/#.*$/,""));var f=((d.$a.title&&d.$a.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,""))||e.idPrefix+(++a));d.$a.attr("href","#"+f);d.$content=b("#"+f);if(d.$content.length<1){d.$content=b(e.panelTemplate).attr("id",f).addClass("ui-corner-bottom").insertAfter(d.$toggle);d.$content.data("destroy.collapsable",true)}d.$content.addClass("content")}}else{d.$content=d.$toggle.next();d.$content.addClass("ui-corner-bottom")}d.$toggle.addClass("ui-corner-top");d.$toggle.prepend('<div class="ui-icon">&nbsp;</div>');d.$indicator=d.$toggle.find(".ui-icon:first");if(d.$toggle.hasClass("collapsed")){d.$indicator.addClass("ui-icon-triangle-1-e");d.$content.hide()}else{d.$indicator.addClass("ui-icon-triangle-1-s");d.$content.show();if(!d.$toggle.hasClass("expanded")){d.$toggle.addClass("expanded")}d._load()}d._bindEvents()},_bindEvents:function(){var c=this;c.$toggle.bind("click.collapsable",function(){if(c.$content.is(":hidden")){c.$toggle.removeClass("collapsed").addClass("expanded");c.$indicator.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s");c.$content.slideDown();c.element.trigger("expand");c._load()}else{c.$toggle.removeClass("expanded").addClass("collapsed");c.$indicator.removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e");c.$content.slideUp();c.element.trigger("collapse")}c.element.trigger("toggle")})},_load:function(){var c=this;var e=c.options;var d=c.$a.data("load.collapsable");c._abort();if((!d)||c.$a.data("cache.collapsable")){return}c.xhr=b.ajax(b.extend({},e.ajaxOptions,{url:d,success:function(f,g){c.$content.html(f);if(e.cache){c.$a.data("cache.collapsable",true)}c._trigger("load",null,c.element);try{e.ajaxOptions.success(f,g)}catch(h){}},error:function(i,f,g){c.$content.html("<div class='error'>Cannot load: "+i.statusText+"</div>");c._trigger("load",null,c.element);try{e.ajaxOptions.error(i,f,c.element,c.$a)}catch(h){}}}));return this},_abort:function(){var c=this;if(c.xhr){c.xhr.abort();delete c.xhr}return c},destroy:function(){var d=this;var e=d.options;var c=d.$a.data("href.collapsable");if(c){d.$a.attr("href",c)}b.each(["href","load","cache"],function(f,g){d.$a.removeData(g+".collapsable")});if(d.$content.data("destroy.collapsable")){d.$content.remove()}else{d.$content.removeClass("ui-corner-bottom content")}d.$toggle.removeClass("ui-corner-top");d.$toggle.removeClass("collapsed,expanded");d.$toggle.unbind(".collapsable");d.$content.show()}})}(jQuery));(function(a){a.widget("connexions.dropdownForm",{version:"0.1.1",widgetEventPrefix:"",options:{cookiePath:null,namespace:null,form:null,groups:null},_create:function(){var b=this;var c=b.options;b.$form=b.element.find("form:first");b.$submit=b.element.find(":submit");b.$control=a("<div class='control'><button>Display Options</button></div>");b.$control.prependTo(b.element);b.$button=b.$control.find("button");b.$button.button({icons:{secondary:"ui-icon-triangle-1-s"}});b.$control.fadeTo(100,0.5);b.element.find(".ui-optionGroups").optionGroups({cookiePath:c.cookiePath,namespace:c.namespace,form:b.$form});b.$form.hide();b._bindEvents()},_bindEvents:function(){var k=this;var b=k.options;var e=function(l){if(k.$form.is(":visible")&&(!a.contains(k.$form[0],l.target))){k.$control.trigger("click");k._trigger("mouseleave",l)}};var i=function(l){k.$control.fadeTo(100,1)};var c=function(l){if(k.$form.is(":visible")){return}k.$control.fadeTo(100,0.5)};var f=function(l){l.preventDefault();l.stopPropagation();k.$form.toggle();k.$button.toggleClass("ui-state-active");return false};var h=function(l){l.preventDefault()};var d=function(l){k.$submit.removeClass("ui-state-disabled").removeAttr("disabled").addClass("ui-state-default")};var j=function(n){var m=k.$form.serializeArray();var l={path:(b.cookiePath===null?window.location.pathname:b.cookiePath)};if(window.location.protocol==="https"){l.secure=true}a(m).each(function(){a.cookie(this.name,this.value,l)});if(!k._trigger("apply",n)){n.stopImmediatePropagation();n.preventDefault();n.stopPropagation();return false}};var g=function(l){l.preventDefault();k.$form.trigger("submit")};a("body").bind("click.uidropdownform",e);k.$control.bind("mouseenter.uidroppdownform",i).bind("mouseleave.uidroppdownform",c).bind("click.uidropdownform",f);k.$form.bind("change.uidropdownform",d).bind("submit.uidropdownform",j);k.$submit.bind("click.uidropdownform",g)},getGroup:function(){return this.element.find(".displayStyle").optionGroups("getGroup")},setGroup:function(b){return this.element.find(".displayStyle").optionGroups("setGroup",b)},getGroupInfo:function(){return this.element.find(".displayStyle").optionGroups("getGroupInfo")},setApplyCb:function(b){this.options.apply=b},open:function(){if(this.element.find("form:first").is(":visible")){return}this.element.find(".control:first").click()},close:function(){if(!this.element.find("form:first").is(":visible")){return}this.element.find(".control:first").click()},enable:function(b){var c=this;c.$form.find("input,select").removeAttr("disabled");if(b!==true){c.$submit.removeClass("ui-state-default ui-state-highlight").addClass("ui-state-disabled").attr("disabled",true)}else{c.$submit.removeClass("ui-state-disabled").removeAttr("disabled").addClass("ui-state-default")}},disable:function(){var b=this;b.$form.find("input,select").attr("disabled",true);b.$submit.removeClass("ui-state-default ui-state-highlight").addClass("ui-state-disabled").attr("disabled",true)},destroy:function(){var b=this;a("body").unbind(".uidropdownform");b.$control.unbind(".uidropdownform");b.$control.find("a:first, .ui-icon:first").unbind(".uidropdownform");b.$form.unbind(".uidropdownform");b.$button.button("destroy");b.$control.remove();b.element.find(".displayStyle").optionGroups("destroy")}})}(jQuery));(function(a){a.widget("connexions.optionGroups",{version:"0.1.1",options:{cookiePath:null,namespace:null,form:null},_create:function(){var b=this;var g=this.options;if(g.namespace===null){var e=b.element.data("namespace");if(e!==undefined){g.namespace=e}else{var d=b.element.attr("class");e=d.replace(/^(?:.* )?(.*?)OptionGroups(?: .*)?$/,"$1");if((e!==undefined)&&(e.length>0)){g.namespace=e}}}if(g.form===null){var f=b.element.data("form");if(f!==undefined){g.form=f}else{g.form=b.element.closest("form")}}var c=b.element.find("ul.groups");c.find("li").removeClass("ui-state-active").addClass("ui-state-default").filter(":first").addClass("ui-corner-left").end().find(":radio").hide();c.find(":checked").parent().addClass("ui-state-active");c.find("li.isCustom").addClass("control").button({icons:{secondary:"ui-icon-triangle-1-s"}}).removeClass("ui-corner-all").addClass("ui-corner-right");b._bindEvents()},_bindEvents:function(){var k=this;var b=this.options;var h=k.element.find("ul.groups");var g=k.element.find("fieldset:first");var c=h.find(".control:first");var f=function(l){l.preventDefault()};var i=function(l){l.preventDefault();l.stopPropagation();k.toggleFieldset()};var d=function(m){m.preventDefault();m.stopPropagation();var l=c.find(":radio");k.setGroup(l.val());return false};var e=function(m){m.preventDefault();m.stopPropagation();var l=a(this).find(":radio");k.setGroup(l.val())};var j=function(m){var l={path:(b.cookiePath===null?window.location.pathname:b.cookiePath)};if(window.location.protocol==="https"){l.secure=true}g.find(":checkbox").each(function(){a.cookie(a(this).attr("name"),null,l)});if(!h.find("li.ui-state-active").hasClass("isCustom")){g.find(":checkbox").attr("disabled",true)}};c.bind("click.uioptiongroups",i);g.bind("change.uioptiongroups",d);h.find("li:not(.control)").bind("change.uioptiongroups",e).bind("click.uioptiongroups",e);b.form.bind("submit.uioptiongroups",j)},getGroup:function(){return this.element.find("ul.groups :checked").val()},setGroup:function(h){var j=this;var f=j.element.find("ul.groups");var e=j.element.find("fieldset:first");var g=f.find(":radio[value="+h+"]");if(g.length!==1){return}f.find(":checked").attr("checked",false).removeAttr("checked");g.attr("checked","checked");f.find("li.ui-state-active").removeClass("ui-state-active");var d=g.parents("li:first");d.addClass("ui-state-active");if(!d.hasClass("control")){e.find("input").removeAttr("checked");e.find(".inGroup-"+h).attr("checked","checked")}var c=[];var i=[];e.find("input:checked").each(function(){c.push("."+a(this).attr("name").replace(/^.*?\[(.*?)\]$/,"$1").replace(/:/g," ."))});e.find("input:not(:checked)").each(function(){i.push("."+a(this).attr("name").replace(/^.*?\[(.*?)\]$/,"$1").replace(/:/g," ."))});var b={group:h,selected:c,deSelected:i};j.element.data("groupInfo",b);j.options.form.trigger("change",b)},getGroupInfo:function(){return this.element.data("groupInfo")},getForm:function(){return this.options.form},enable:function(){this.find(":input").removeAttr("disabled")},disable:function(){this.find(":input").attr("disabled",true)},toggleFieldset:function(){this.element.find("fieldset:first").toggleClass("ui-state-active").toggle()},destroy:function(){var c=this;c.element.find("a.option,div.option a:first").removeData("group");var d=c.element.find(".control:first");var b=c.element.find("input[name="+c.options.namespace+"Group]");d.unbind(".uioptiongroups");d.find("> a, .control > a, .control > .ui-icon").unbind(".uioptiongroups");c.element.find("fieldset:first").unbind(".uioptiongroups");c.element.find("a.option").unbind(".uioptiongroups");c.options.form.unbind(".uioptiongroups")}})}(jQuery));(function(a){a.widget("connexions.itemScope",{options:{namespace:"",jsonRpc:null,separator:",",minLength:2},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$input=b.element.find(".scopeEntry :text");b.$curItems=b.element.find(".scopeItem");b.$submit=b.element.find(".scopeEntry :submit");b.$input.input();if(d.jsonRpc!==null){b.$input.autocomplete({source:function(f,e){return b._autocomplete(f,e)},minLength:d.minLength})}b._bindEvents()},_autocomplete:function(e,c){var b=this;var d=b.options;var f=d.jsonRpc.params;f.str=b.$input.autocomplete("option","term");a.jsonRpc(d.jsonRpc,d.jsonRpc.method,f,{success:function(g,h,i){if(g.error!==null){b.element.trigger("error",[h,i,g.error]);return}c(a.map(g.result,function(j){return{label:'<span class="name">'+j.tag+'</span> <span class="count">'+j.userItemCount+"</span>",value:j.tag}}));b.element.trigger("success",[g,h,i])},error:function(h,g,i){b.element.trigger("error",[g,h])}})},_bindEvents:function(){var b=this;var c=b.options;var d=b.element.find(".deletable a.delete");d.bind("mouseenter.itemScope",function(f){a(this).css("opacity",1).addClass("ui-icon-circle-close").removeClass("ui-icon-close")}).bind("mouseleave.itemScope",function(f){a(this).css("opacity",0.25).addClass("ui-icon-close").removeClass("ui-icon-circle-close")}).trigger("mouseleave");b.$submit.bind("click.itemScope",function(f){f.preventDefault();f.stopPropagation();f.stopImmediatePropagation();b.element.submit()});b.element.bind("submit.itemScope",function(h){h.preventDefault();h.stopPropagation();h.stopImmediatePropagation();var i=window.location;var f=i.toString();var g=b.$input.val().replace(/\s*,\s*/g,",").replace(/,$/,"");if(f[f.length-1]!=="/"){f+="/"}if(g.length>0){if(b.$curItems.length>0){f+=","}f+=g}window.location.assign(f)})},destroy:function(){var b=this;var c=b.options;if(c.jsonRpc!==null){b.$input.autocomplete("destroy")}b.$input.input("destroy");b.element.find(".deletable a.delete").unbind(".itemScope");b.$submit.unbind(".itemScope");b.element.unbind(".itemScope")}})}(jQuery));(function(a){a.widget("connexions.paginator",{version:"0.1.1",options:{namespace:"",disableHover:false,page:1,pageVar:"Page"},_create:function(){var b=this;var d=b.options;if(d.form===null){var c=b.element.data("form");if(c!==undefined){d.form=c}else{d.form=b.element.closest("form")}}d.page=b.element.find("button.ui-state-active").text();d.pageVar=b.element.find("button:submit:first").attr("name");b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;if(!c.disableHover){b.element.fadeTo(100,0.5).hover(function(){a(this).fadeTo(100,1)},function(){a(this).fadeTo(100,0.5)})}b.element.find("select[name="+c.namespace+"PerPage]").bind("change.paginator",function(d){a.log("Add Cookie: name[%s], value[%s]",this.name,this.value);a.cookie(this.name,this.value);b.element.submit()});b.element.find(":submit").bind("click.paginator",function(d){c.page=a(this).val()})},getPage:function(){return this.options.page},getPageVar:function(){return this.options.pageVar},getForm:function(){return this.options.form},enable:function(){this.find(":button").removeAttr("disabled")},disable:function(){this.find(":button").attr("disabled",true)},destroy:function(){}})}(jQuery));(function(a){a.widget("connexions.pane",{version:"0.0.1",options:{namespace:"",partial:null,pageCur:null,pageVar:null,page:null,hiddenVars:null,paginator:{},displayOptions:{}},_create:function(){this._paneInit()},_paneInit:function(){this._init_paginators();this._init_displayOptions()},_init_paginators:function(){var b=this;var c=b.options;b.$paginators=b.element.find("form.paginator");b.$paginators.each(function(e){var d=a(this);d.paginator({namespace:c.namespace,form:d,disableHover:(e!==0)});if(c.page===null){c.pageCur=d.paginator("getPage");c.pageVar=d.paginator("getPageVar")}});b.$paginators.bind("submit.uipane",function(f){var d=a(this);f.preventDefault(true);f.stopPropagation(true);f.stopImmediatePropagation(true);c.page=d.paginator("getPage");b.reload()})},_init_displayOptions:function(){var c=this;c.$displayOptions=c.element.find("div.displayOptions");if(c.$displayOptions.length<1){return}var d=c.options;var b=(d.displayOptions===undefined?{}:d.displayOptions);if(b.namespace===undefined){b.namespace=d.namespace}if(!a.isFunction(b.apply)){b.apply=function(f){f.stopImmediatePropagation();f.preventDefault();f.stopPropagation();c.reload()}}c.$displayOptions.dropdownForm(b)},_paneDestroy:function(){var b=this;b.$paginators.paginator("destroy");b.$displayOptions.dropdownForm("destroy")},reload:function(h){var b=this;var e=b.options;var d=new RegExp(e.pageVar+"="+e.pageCur);var f=e.pageVar+"="+e.page;var g=window.location;var c=g.toString();if(g.search.length===0){c+="?"+f}else{if(!c.match(d)){c+="&"+f}else{c=c.replace(d,f)}}if(e.hiddenVars!==null){a.each(e.hiddenVars,function(i,j){c+="&"+i+"="+j})}if(e.partial!==null){c+="&format=partial&part="+e.partial;a.ajax({url:c,dataType:"html",beforeSend:function(){b.element.mask()},error:function(k,i,j){a.notify({title:'Reload pane "'+e.partial+'" failed',text:'<p class="error">'+i+"</p>"})},success:function(k,i,j){b.destroy();b.element.replaceWith(k)},complete:function(){b.element.unmask();if(a.isFunction(h)){h.call(b.element)}}})}else{window.location.assign(c)}},destroy:function(){this._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.itemsPane",a.connexions.pane,{version:"0.0.1",options:{namespace:""},_create:function(){var b=this;var c=b.options;b._init_itemList();b._paneInit()},_init_itemList:function(){var c=this;c.$itemList=c.element.find("ul.items");if(c.$itemList.length<1){return}var d=c.options;var b=(d.itemList===undefined?{}:d.itemList);if(b.namespace===undefined){b.namespace=d.namespace}c.$itemList.itemList(b)},destroy:function(){var b=this;b.$itemList.itemList("destroy");b._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.cloudPane",a.connexions.pane,{version:"0.0.1",options:{namespace:"",jsonRpc:null,apiKey:null},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b._paneInit();b.$optionsForm=b.element.find(".displayOptions form");b._bindEvents()},_bindEvents:function(){var b=this;this.$optionsForm.bind("change.cloudPane",function(f,d){var c=a(this).find(".field.highlightCount");if((d===undefined)||(d.group===undefined)||(d.group==="cloud")){c.removeClass("ui-state-disabled");c.find("select").removeAttr("disabled")}else{c.addClass("ui-state-disabled");c.find("select").attr("disabled",true)}});this.element.delegate(".item-edit, .item-delete","click",function(d){var c=a(this);d.preventDefault();d.stopPropagation();d.stopImmediatePropagation();if(c.hasClass("item-edit")){b._edit_item(c)}else{b._delete_confirm(c)}})},_edit_item:function(o){var n=this;var d=o.parents(".control:first");if(d.attr("disabled")!==undefined){return}d.attr("disabled",true);var b=n.options;var l=o.parents("li:first");var f=l.find(".item:first");var p=f.data("id");var g='<div class="edit-item"><input type="text" class="text" value="'+p+'" /><div class="buttons"><span class="item-save" title="save"><span class="title">Save</span><span class="icon connexions_sprites status-ok"></span></span><span class="item-cancel" title="cancel"><span class="title">Cancel</span><span class="icon connexions_sprites star_0_off"></span></span></div></div>';var k=a(g);d.hide();var e=parseInt(f.width(),10);var m=k.find("input");m.input().css("font-size",f.css("font-size")).width(e+16);k.appendTo(l).position({of:f,my:"center top",at:"center top",offset:"0 -5"});m.focus();function c(q){q.preventDefault();q.stopPropagation();q.stopImmediatePropagation();setTimeout(function(){d.removeAttr("disabled").show();k.remove()},100)}function j(q){}var i=k.find(".item-save");var h=k.find(".item-cancel");i.click(function(q){if(m.input("hasChanged")!==true){c(q);return}n._perform_rename(o,function(r){if(r!==false){var t=m.input("getOrigValue");var s=f.attr("href").replace(/\/([^\/]+)$/,"/"+r);f.attr("href",s).text(r).data("id",r);c(q)}})});h.click(function(q){c(q)});m.keydown(function(q){if(q.keyCode===13){i.click()}else{if(q.keyCode===27){h.click()}}})},_perform_rename:function(l,k){var i=this;var b=i.options;var f=l.parents("li:first");var g=f.find(".edit-item input");var c=f.find(".item:first");var e=c.data("id");var h=g.val();var j=false;var d={renames:e+":"+h};if(b.apiKey!==null){d.apiKey=b.apiKey}a.jsonRpc(b.jsonRpc,"user.renameTags",d,{success:function(n,o,m){if((!n)||(n.error!==null)){a.notify({title:"Tag rename failed",text:'<p class="error">'+(n?n.error.message:"")+"</p>"});return}if(n.result===null){return}if(n.result[e]!==true){a.notify({title:"Tag rename failed",text:'<p class="error">'+(n?n.result[e]:"")+"</p>"});return}a.notify({title:"Tag renamed",text:e+" renamed to "+h});j=h},error:function(n,o,m){a.notify({title:"Tag rename failed",text:'<p class="error">'+o+"</p>"})},complete:function(m,n){k(j)}})},_delete_confirm:function(j){var i=this;var b=j.parents(".control:first");if(b.attr("disabled")!==undefined){return}b.attr("disabled",true);var e=j.parents("li:first");var d='<div class="confirm">Really delete?<br /><button name="yes">Yes</button><button name="no" >No</button></div>';var f=a(d);i._placeConfirmation(b,f);function c(k){k.preventDefault();k.stopPropagation();k.stopImmediatePropagation();setTimeout(function(){b.removeAttr("disabled");f.remove()},100)}var h=f.find("button[name=yes]");var g=f.find("button[name=no]");h.click(function(k){c(k);i._perform_delete(j)});g.click(function(k){c(k)});a(document).keydown(function(k){if(k.keyCode===13){h.click()}else{if(k.keyCode===27){g.click()}}})},_perform_delete:function(d){var c=this;var e=c.options;var h=d.parents("li:first");var f=h.find(".item:first");var b=f.data("id");var g={tags:b};if(e.apiKey!==null){g.apiKey=e.apiKey}a.jsonRpc(e.jsonRpc,"user.deleteTags",g,{success:function(j,k,i){if((!j)||(j.error!==null)){a.notify({title:"Tag deletion failed",text:'<p class="error">'+(j?j.error.message:"")+"</p>"});return}if(j.result===null){return}if(j.result[b]!==true){a.notify({title:"Tag deletion failed",text:'<p class="error">'+(j?j.result[b]:"")+"</p>"});return}a.notify({title:"Tag deleted",text:b});h.hide("fast",function(){h.remove()})},error:function(j,k,i){a.notify({title:"Tag deletion failed",text:'<p class="error">'+k+"</p>"})},complete:function(i,j){}})},_placeConfirmation:function(d,e){var g=d.parents("li:first");var b=d.offset();var c=g.offset();var f={of:d};if(b.top<=c.top){f.my="right bottom";f.at="right bottom"}else{f.my="center top";f.at="center top"}e.appendTo(g).position(f)},destroy:function(){var b=this;b.$optionsForm.unbind(".cloudPane");b._paneDestroy()}})}(jQuery));(function(a){a.widget("connexions.sidebar",{version:"0.0.1",options:{namespace:""},_create:function(){var b=this;var c=b.options;c.namespace=b.element.attr("id");b.element.tabs({cache:true,cookie:c.namespace,ajaxOptions:{beforeSend:function(){var d=b.element.tabs("option","selected");b.$tab=b.element.find(".ui-tabs-panel").eq(d);b.$tab.mask()},complete:function(){b._bindReload(b.$tab);b.$tab.unmask()}}});b.element.find("ul:first li a:first").each(function(e){var d=a.data(this,"load.tabs");if(d){var f=b.element.find(".ui-tabs-panel").eq(e);b._bindReload(f)}});b._bindReload(b.element)},_bindReload:function(c){var b=this;c.find(".displayOptions").dropdownForm("setApplyCb",function(d){d.preventDefault();d.stopPropagation();d.stopImmediatePropagation();b.element.tabs("load",b.element.tabs("option","selected"))})},destroy:function(){this.element.tabs("destroy")}})}(jQuery));(function(a){a.widget("connexions.itemList",{version:"0.0.1",widgetEventPrefix:"",options:{namespace:"",objClass:null,dimOpacity:0.5},_create:function(){var c=this;var d=c.options;var b=d.objClass;c.$items=c.element.find("li > form");c.$headers=c.element.find(".groupHeader .groupType");if(b===null){b=d.objClass=c.$items.attr("class")}if(c.$items.length>0){c.$items[b]({deleted:function(g,f){c._itemDeleted(a(this))}})}c.$headers.fadeTo(100,d.dimOpacity).hover(function(){c.$headers.fadeTo(100,1)},function(){c.$headers.fadeTo(100,d.dimOpacity)});c._bindEvents()},_bindEvents:function(){var b=this;var c=b.options},_itemDeleted:function(c){var e=c.parent(".item");var d=e.prev(".groupHeader");var b=e.next();c.slideUp("fast",function(){e.slideUp("normal",function(){c.item("destroy");e.remove();if((d.length>0)&&(!b.hasClass("item"))){d.slideUp("normal",function(){d.remove()})}})})},destroy:function(){var b=this;var c=b.options;b.$headers.unbind("hover");if(b.$items.length>0){b.$items[c.objClass]("destroy")}}})}(jQuery));(function(a){a.widget("connexions.search",{options:{},_create:function(){var b=this;var c=b.options;b.$input=b.element.find("input[name=terms]");b.$submit=b.element.find("button.submit");b.$context=b.element.find("input[name=searchContext]");b.$choices=b.element.find(".choices .list");b.contextLabel=b.$choices.find("li.active").text();b.$submit.addClass("ui-state-disabled").attr("disabled",true);b.$input.input({validation:function(d){if(d.length>0){b.$submit.removeClass("ui-state-disabled").removeAttr("disabled")}else{b.$submit.addClass("ui-state-disabled").attr("disabled",true)}return true}});b.$input.input("setLabel",b.contextLabel);b._bindEvents()},_bindEvents:function(){var b=this;var c=b.options;b.$choices.find("li").bind("mousedown.search",function(d){b.$input.input("setLabel",null)}).bind("click.search",function(f){var g=a(this);var d=g.attr("id").replace(/search-choice-/,"");b.$context.val(d);a.cookie("searchContext",d);b.contextLabel=g.text();g.siblings(".active").removeClass("active");g.addClass("active");b.$input.input("setLabel",b.contextLabel)})},destroy:function(){var b=this;b.$input.input("destroy");b.$choices.find("li").unbind(".search")}})}(jQuery));(function(a){a.widget("connexions.bookmarkPost",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,tags:null,url:null,$status:null,jsonRpc:null,apiKey:null,enabled:true},_create:function(){var b=this;var d=b.options;b.element.hide();b.element.addClass("ui-form");if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}if((d.$status!==null)&&(d.$status.jquery===undefined)){d.$status=a(d.$status)}d.$required=b.element.find(".required");d.$userId=b.element.find("input[name=userId]");d.$itemId=b.element.find("input[name=itemId]");d.$name=b.element.find("input[name=name]");d.$url=b.element.find("input[name=url]");d.$description=b.element.find("textarea[name=description]");d.$tags=b.element.find("textarea[name=tags]");d.$favorite=b.element.find("input[name=isFavorite]");d.$private=b.element.find("input[name=isPrivate]");d.$rating=b.element.find(".userRating .stars-wrapper");d.$save=b.element.find("button[name=submit]");d.$cancel=b.element.find("button[name=cancel]");d.$reset=b.element.find("button[name=reset]");d.$inputs=b.element.find("input[type=text],input[type=password],textarea");d.$cte=b.element.find(".click-to-edit");d.$suggestions=b.element.find(".suggestions");d.$collapsable=b.element.find(".collapsable");d.$tags.autocomplete({source:function(f,e){a.log("connexions.bookmarkPost::$tags.source("+f.term+")");return b._autocomplete(f,e)},change:function(g,f){a.log('connexions.bookmarkPost::$tags.change( "'+d.$tags.val()+'" )');b._highlightTags()},close:function(g,f){a.log("connexions.bookmarkPost::$tags.close()");b._highlightTags()}});d.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});d.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});d.$rating.stars({});d.$save.addClass("ui-priority-primary").button({disabled:true});d.$cancel.addClass("ui-priority-secondary").button({disabled:false});d.$reset.addClass("ui-priority-secondary").button({disabled:false});d.$suggestions.tabs();d.$collapsable.collapsable();d.$inputs.input();d.$required.after('<div class="ui-field-info"><div class="ui-field-status"></div><div class="ui-field-requirements">required</div></div>');d.$required.filter("[name=tags]").next(".ui-field-info").find(".ui-field-requirements").text("comma-separated, 30 characters per tag - required");d.$required.each(function(){var e=a(this);e.next().css("width",e.css("width"))});b._setStateFromForm();b._bindEvents();b.element.show()},_setStateFromForm:function(){var b=this;var c=b.options;c.name=c.$name.val();c.description=c.$description.val();c.tags=c.$tags.val();c.isFavorite=c.$favorite.checkbox("isChecked");c.isPrivate=c.$private.checkbox("isChecked");c.url=c.$url.val();if(c.$userId.length>0){c.userId=c.$userId.val()}if(c.$userId.length>0){c.itemId=c.$itemId.val()}if(c.$rating.length>0){c.rating=c.$rating.stars("value")}},_setFormFromState:function(){var b=this;var c=b.options;c.$name.val(c.name);c.$description.val(c.description);c.$tags.val(c.tags);c.$favorite.checkbox(c.isFavorite?"check":"uncheck");c.$private.checkbox(c.isPrivate?"check":"uncheck");c.$url.val(c.url);if(c.$userId.length>0){c.$userId.val(c.userId)}if(c.$userId.length>0){c.$itemId.val(c.itemId)}if(c.$rating.length>0){c.$rating.stars("value",c.rating)}},_bindEvents:function(){var i=this;var b=i.options;var c=function(l,k){l.stopImmediatePropagation();l.preventDefault();l.stopPropagation();a.log("connexions.bookmarkPost::_save_click("+k+")");i._performUpdate();return false};var h=function(l,k){l.stopImmediatePropagation();l.preventDefault();l.stopPropagation();i._trigger("canceled",null,k);i._trigger("complete")};var e=function(l,k){l.stopImmediatePropagation();l.preventDefault();l.stopPropagation();i.reset()};var g=function(m,l){var k=a(this);if(k.data("validationInitialized")!==true){k.data("validationInitialized",true);return}k.removeClass("click-to-edit").unbind("validationChange")};var f=function(m,l){var k=a(this);if(k.hasClass("ui-state-valid")){if((!b.$name.input("hasChanged"))||(!b.$description.input("hasChanged"))||(!b.$tags.input("hasChanged"))){i._headers(b.$url.val())}}};var d=function(){i.validate()};var j=function(k){var l=a.ui.keyCode;if(k.keyCode===a.ui.keyCode.COMMA){var m=b.$tags.autocomplete("widget");b.$tags.autocomplete("close")}};i._tagClick=function(o){o.preventDefault();o.stopPropagation();var m=a(this);var k=m.text();var l=b.$tags.val();if(m.hasClass("selected")){var n=new RegExp("\\s*"+k+"\\s*[,]?");l=l.replace(n,"")}else{if(!l.match(/,\s*$/)){l+=", "}l+=k}b.$tags.val(l);i._highlightTags()};b.$inputs.bind("validation_change.bookmarkPost",d);b.$favorite.bind("change.bookmarkPost",d);b.$private.bind("change.bookmarkPost",d);b.$rating.bind("change.bookmarkPost",d);b.$cte.bind("validation_change.bookmarkPost",g);b.$save.bind("click.bookmarkPost",c);b.$cancel.bind("click.bookmarkPost",h);b.$reset.bind("click.bookmarkPost",e);b.$url.bind("validation_change.bookmarkPost",f);b.$tags.bind("keydown.bookmarkPost",j);b.$suggestions.find(".cloud .cloudItem a").bind("click.bookmarkPost",i._tagClick);d()},_performUpdate:function(){var c=this;var d=c.options;if(d.enabled!==true){return}var b=false;var e={id:{userId:d.userId,itemId:d.itemId}};if(d.$name.val()!==d.name){e.name=d.$name.val();b=true}if(d.$description.val()!==d.description){e.description=d.$description.val();b=true}if((d.$tags.length>0)&&(d.$tags.val()!==d.tags)){e.tags=d.$tags.val();b=true}if(d.$favorite.checkbox("isChecked")!==d.isFavorite){e.isFavorite=d.$favorite.checkbox("isChecked");b=true}if(d.$private.checkbox("isChecked")!==d.isPrivate){e.isPrivate=d.$private.checkbox("isChecked");b=true}if((d.$rating.length>0)&&(d.$rating.stars("value")!==d.rating)){e.rating=d.$rating.stars("value");b=true}if(d.$url.val()!==d.url){e.url=d.$url.val();b=true}if(b!==true){c._trigger("complete");return}if(e.id.itemId===null){e.id.itemId=(e.url!==undefined?e.url:d.url)}if(d.apiKey!==null){e.apiKey=d.apiKey}c.element.mask();a.jsonRpc(d.jsonRpc,"bookmark.update",e,{success:function(h,i,g){if(h.error!==null){c._status(false,"Bookmark update failed",h.error.message);return}c._status(true,"Bookmark update succeeded","Bookmark "+(d.itemId===null?"created":"updated"));if(h.result===null){return}c.options=a.extend(c.options,h.result);d=c.options;if(a.isArray(d.tags)){var f=[];a.each(d.tags,function(){f.push(this.tag)});d.tags=f.join(",")}c._setFormFromState();c._trigger("saved",null,h.result);c._trigger("complete")},error:function(g,h,f){c._status(false,"Bookmark update failed",h)},complete:function(f,g){c.element.unmask()}})},_headers_success:function(f){var c=this;var e=c.options;if(!e.$name.input("hasChanged")){if(f.title.length>0){e.$name.val(f.title);e.$name.trigger("blur")}}if(!e.$name.input("hasChanged")){var d=f.meta.filter("meta[name=description]");if(d.length>0){e.$description.val(d.attr("content"));e.$description.trigger("blur")}}if(!e.$tags.input("hasChanged")){var b=f.meta.filter("meta[name=keywords]");if(b.length>0){e.$tags.val(b.attr("content"));e.$tags.trigger("blur")}}},_headers:function(c,f){var b=this;var d=b.options;if(b.headersUrl===c){return}b.headersUrl=c;var e={url:c,keepTags:"title,meta"};a.jsonRpc(d.jsonRpc,"util.getHead",e,{success:function(i,k,h){if(i.error!==null){return}if(i.result===null){return}var g=a("<div />");g.html(i.result.html);var j={title:g.find("title").text(),meta:g.find("meta")};if(a.isFunction(f)){f(j)}else{b._headers_success(j)}},error:function(h,i,g){},complete:function(g,h){}});a.ajax({url:(a.registry("urls")).base+"/post/",data:{format:"partial",part:"main-tags-recommended",url:c},success:function(h){var g=d.$suggestions.find("#suggestions-tags .recommended .content");d.$suggestions.find(".cloud .cloudItem a").unbind(".bookmarkPost");g.html(h);d.$suggestions.find(".cloud .cloudItem a").bind("click.bookmarkPost",b._tagClick);b._highlightTags()}})},_highlightTags:function(){var d=this;var h=d.options;if(h.$suggestions.length<1){return}var g=h.$suggestions.find(".cloud .cloudItem a");g.filter(".selected").removeClass("selected");var e=h.$tags.val();var c=e.length;var b=null;if(c<1){return}e=e.split(/\s*,\s*/);c=e.length;for(var f=0;f<c;f++){b=e[f].toLowerCase();if(b.length<1){continue}b=b.replace('"','"');a.log("connexions.bookmarkPost::_highlightTags("+b+")");g.filter(':contains("'+b+'")').addClass("selected")}},_autocomplete:function(e,c){var b=this;var d=b.options;var f={id:{userId:d.userId,itemId:d.itemId}};if((f.id.itemId===null)||(d.$url.val()!==d.url)){f.id.itemId=d.$url.val()}f.str=d.$tags.autocomplete("option","term");a.jsonRpc(d.jsonRpc,"bookmark.autocompleteTag",f,{success:function(g,h,i){if(g.error!==null){b.element.trigger("error",[h,i,g.error]);return}c(a.map(g.result,function(j){return{label:'<span class="name">'+j.tag+'</span> <span class="count">'+j.userItemCount+"</span>",value:j.tag}}));b.element.trigger("success",[g,h,i])},error:function(h,g,i){b.element.trigger("error",[g,h])}})},_status:function(b,g,f){var c=this;var d=c.options;if(d.$status===null){if((g!==undefined)&&(f!==undefined)){a.notify({title:g,text:f})}}else{var e="";if(f!==undefined){e+=f}d.$status.html(e);if(b){d.$status.removeClass("error").addClass("success")}else{d.$status.removeClass("success").addClass("error")}}},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!c.enabled){c.enabled=true;b.element.removeClass("ui-state-disabled");c.$favorite.checkbox("enable");c.$private.checkbox("enable");c.$rating.stars("enable");c.$inputs.input("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(c.enabled){c.enabled=false;b.element.addClass("ui-state-disabled");c.$favorite.checkbox("disable");c.$private.checkbox("disable");c.$rating.stars("disable");c.$inputs.input("disable");b._trigger("disabled",null,true)}},reset:function(){var b=this;var c=b.options;c.$favorite.checkbox("reset");c.$private.checkbox("reset");c.$rating.stars("reset");c.$inputs.input("reset");b._trigger("reset");b.headersUrl=undefined;b.validate()},validate:function(){var b=this;var d=b.options;var e=true;var c=b.hasChanged();if(c){d.$required.each(function(){if(!a(this).hasClass("ui-state-valid")){e=false;return false}});if(e){b._status(true)}else{b._status(false)}}if(c&&e){d.$save.button("enable")}else{d.$save.button("disable")}},hasChanged:function(){var b=this;var d=b.options;var c=false;d.$inputs.each(function(){if(a(this).input("hasChanged")){c=true;return false}});if((!c)&&(d.$favorite.checkbox("hasChanged")||d.$private.checkbox("hasChanged")||d.$rating.stars("hasChanged"))){c=true}return c},destroy:function(){var b=this;var c=b.options;c.$save.removeClass("ui-priority-primary");c.$cancel.removeClass("ui-priority-secondary");c.$reset.removeClass("ui-priority-secondary");c.$required.next(".ui-field-info").remove();b.element.removeClass("ui-form");c.$inputs.unbind(".bookmarkPost");c.$favorite.unbind(".bookmarkPost");c.$private.unbind(".bookmarkPost");c.$rating.unbind(".bookmarkPost");c.$cte.unbind(".bookmarkPost");c.$save.unbind(".bookmarkPost");c.$cancel.unbind(".bookmarkPost");c.$reset.unbind(".bookmarkPost");c.$url.unbind(".bookmarkPost");c.$tags.unbind(".bookmarkPost");c.$suggestions.find(".cloud .cloudItem a").unbind(".bookmarkPost");c.$favorite.checkbox("destroy");c.$private.checkbox("destroy");c.$rating.stars("destroy");c.$inputs.input("destroy");c.$save.button("destroy");c.$cancel.button("destroy");c.$reset.button("destroy");c.$suggestions.tabs("destroy");c.$collapsable.collapsable("destroy")}})}(jQuery));(function(a){a.widget("connexions.autocomplete",a.ui.autocomplete,{version:"0.0.1",options:{delay:200,minLength:2,separator:","},_init:function(){var b=this;var c=b.options;a.each(["search","focus","select"],function(){var e=this;var f=b["_do_"+e];var d=(a.isFunction(c[e])?c[e]:null);c[this]=function(h,i){var g=f.call(b,h,i);if(g!==false){if(d!==null){g=d.call(b.element[0],h,i)}}return g}})},_do_search:function(){var b=this._curTerm();if(b.length<this.options.minLength){return false}},_do_focus:function(){return false},_do_select:function(d,e){var c=this.options;var b=new RegExp("(\\s*"+c.separator+"\\s*)+","g");var f=c.val.substring(0,c.start)+e.item.value+c.val.substring(c.end)+c.separator+" ";f=f.replace(b,c.separator+" ");this.element.val(f);return false},_curTerm:function(){var b=this;var d=b.options;d.start=b._selectionStart();d.end=b._selectionEnd();d.val=b.element.val();if(d.start===d.end){d.end=d.val.indexOf(d.separator,d.start);if(d.end<0){d.end=d.val.length}var c=d.val.indexOf(d.separator,0);var e=0;while((c>=0)&&(c<d.start)){while((c<d.end)&&(d.val.substr(++c,1).match(/\s/))){}e=c;c=d.val.indexOf(d.separator,c)}d.start=e}d.term=d.val.substring(d.start,d.end);return d.term},_selectionStart:function(){var d=this;var e=0;if(d.element[0].createTextRange){var c=document.selection.createRange().duplicate();var b=d.element.val();c.moveEnd("character",b.length);if(c.text===""){e=b.length}else{e=b.lastIndexOf(c.text)}}else{e=d.element.attr("selectionStart")}return e},_selectionEnd:function(){var d=this;var e=0;if(d.element[0].createTextRange){var c=document.selection.createRange().duplicate();var b=d.element.val();c.moveEnd("character",-(b.length));e=c.text.length}else{e=d.element.attr("selectionEnd")}return e}})}(jQuery));(function(a){a.widget("connexions.bookmark",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,tags:null,url:null,change:null,jsonRpc:null,apiKey:null,enabled:true},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$userId=b.element.find("input[name=userId]");b.$itemId=b.element.find("input[name=itemId]");b.$name=b.element.find(".itemName a");b.$description=b.element.find(".description");b.$rating=b.element.find(".rating .stars .owner");b.$favorite=b.element.find("input[name=isFavorite]");b.$private=b.element.find("input[name=isPrivate]");b.$tags=b.element.find("input[name=tags]");b.$edit=b.element.find(".control .item-edit");b.$delete=b.element.find(".control .item-delete");b.$save=b.element.find(".control .item-save");b.$url=b.element.find(".itemName a,.url a");b.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});b.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});b.$rating.stars({});b._setState();b._bindEvents()},_bindEvents:function(){var b=this;var e=b.options;b._squelch=false;var g=function(i,h){i.stopImmediatePropagation();i.preventDefault();i.stopPropagation();b._performUpdate()};var d=function(j){if(b.options.enabled===true){var i;try{i=a.registry("urls").base+"/post?format=partial&part=main&url="+e.url+"&excludeSuggestions=true"}catch(h){return}a.get(i,function(k){b._showBookmarkDialog("Edit",k)})}j.preventDefault();j.stopPropagation()};var f=function(j){j.stopImmediatePropagation();j.preventDefault();j.stopPropagation();if(b.options.enabled!==true){return}var i='<div class="confirm">Really delete?<br /><button name="yes">Yes</button><button name="no" >No</button></div>';var h=a(i);b.$delete.after(h);b.$delete.attr("disabled",true);h.find("button[name=yes]").click(function(k){b.$delete.removeAttr("disabled");h.remove();b._performDelete()});h.find("button[name=no]").click(function(){b.$delete.removeAttr("disabled");h.remove()})};var c=function(j){if(b.options.enabled===true){var i;try{i=a.registry("urls").base+"/post?format=partial&part=main&url="+e.url}catch(h){return}a.get(i,function(k){b._showBookmarkDialog("Save",k)})}j.preventDefault();j.stopPropagation()};b.element.bind("change.bookmark",g);b.$edit.bind("click.bookmark",d);b.$delete.bind("click.bookmark",f);b.$save.bind("click.bookmark",c)},_performDelete:function(){var b=this;var c=b.options;if(c.enabled!==true){return}var d={id:{userId:c.userId,itemId:c.itemId}};if(c.apiKey!==null){d.apiKey=c.apiKey}a.jsonRpc(c.jsonRpc,"bookmark.delete",d,{success:function(f,g,e){if((!f)||(f.error!==null)){a.notify({title:"Bookmark delete failed",text:'<p class="error">'+(f?f.error.message:"")+"</p>"});return}b._trigger("deleted")},error:function(f,g,e){a.notify({title:"Bookmark delete failed",text:'<p class="error">'+g+"</p>"})},complete:function(e,f){}})},_performUpdate:function(){var c=this;var d=c.options;if((d.enabled!==true)||(c._squelch===true)){return}var b=false;var e={id:{userId:d.userId,itemId:d.itemId}};if(c.$name.text()!==d.name){e.name=c.$name.text();b=true}if(c.$description.text()!==d.description){e.description=c.$description.text();b=true}if((c.$tags.length>0)&&(c.$tags.text()!==d.tags)){e.tags=c.$tags.text();b=true}if(c.$favorite.checkbox("isChecked")!==d.isFavorite){e.isFavorite=c.$favorite.checkbox("isChecked");b=true}if(c.$private.checkbox("isChecked")!==d.isPrivate){e.isPrivate=c.$private.checkbox("isChecked");b=true}if((c.$rating.length>0)&&(c.$rating.stars("value")!==d.rating)){e.rating=c.$rating.stars("value");b=true}if(c.$url.attr("href")!==d.url){e.url=c.$url.attr("href");b=true}if(b!==true){return}a.log("connexions.bookmark::_performUpdate()");if(a.isFunction(c.options.change)){if(!c.options.change(e)){c._resetState();return}}if(d.apiKey!==null){e.apiKey=d.apiKey}a.jsonRpc(d.jsonRpc,"bookmark.update",e,{success:function(g,h,f){if((!g)||(g.error!==null)){a.notify({title:"Bookmark update failed",text:'<p class="error">'+(g?g.error.message:"")+"</p>"});c._resetState();return}if(g.result===null){return}c._refreshBookmark(g.result)},error:function(g,h,f){a.notify({title:"Bookmark update failed",text:'<p class="error">'+h+"</p>"});c._resetState()},complete:function(f,g){}})},_refreshBookmark:function(e){var b=this;var d=b.options;b._squelch=true;b.$itemId.val(e.itemId);b.$name.text(e.name);b.$description.text(e.description);b.$tags.text(e.tags);b.$rating.stars("select",e.rating);b.$favorite.checkbox((e.isFavorite?"check":"uncheck"));b.$private.checkbox((e.isPrivate?"check":"uncheck"));b.$url.attr("href",e.url);var c=b.element.parent();if(e.isPrivate){c.addClass("private")}else{c.removeClass("private")}b._squelch=false;b._setState()},_showBookmarkDialog:function(e,d){var c=this;d='<div class="ui-validation-form" style="padding:0;"><div class="userInput lastUnit">'+d+"</div></div>";var b=a(d);b.dialog({autoOpen:true,title:e+" bookmark",width:480,resizable:false,modal:true,open:function(f,g){b.find("form").bookmarkPost({saved:function(h,i){c._refreshBookmark(i)},complete:function(){b.dialog("close")}})},close:function(f,g){b.dialog("destroy");b.remove()}})},_setState:function(){var b=this;var c=b.options;c.userId=b.$userId.val();c.itemId=b.$itemId.val();c.name=b.$name.text();c.description=b.$description.text();if(b.$rating.length>0){c.rating=b.$rating.stars("value")}c.isFavorite=b.$favorite.checkbox("isChecked");c.isPrivate=b.$private.checkbox("isChecked");c.url=b.$url.attr("href")},_resetState:function(){var b=this;var c=b.options;b._squelch=true;b.$name.text(c.name);b.$description.text(c.description);if(b.$rating.length>0){b.$rating.stars("select",c.rating)}b.$favorite.checkbox((c.isFavorite?"check":"uncheck"));b.$private.checkbox((c.isPrivate?"check":"uncheck"));b.$url.attr("href",c.url);b._squelch=false},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!b.options.enabled){b.options.enabled=true;b.element.removeClass("ui-state-disabled");b.$favorite.checkbox("enable");b.$private.checkbox("enable");b.$rating.stars("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(b.options.enabled){b.options.enabled=false;b.element.addClass("ui-state-disabled");b.$favorite.checkbox("disable");b.$private.checkbox("disable");b.$rating.stars("disable");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$favorite.unbind(".bookmark");b.$private.unbind(".bookmark");b.$rating.unbind(".bookmark");b.$edit.unbind(".bookmark");b.$delete.unbind(".bookmark");b.$save.unbind(".bookmark");b.$favorite.checkbox("destroy");b.$private.checkbox("destroy");b.$rating.stars("destroy")}})}(jQuery));(function(a){a.widget("connexions.user",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,name:null,fullName:null,email:null,apiKey:null,pictureUrl:null,profile:null,lastVisit:null,change:null,jsonRpc:null,enabled:true},_create:function(){var b=this;var d=b.options;if(a.isFunction(a.registry)){var c=a.registry("api");if(c&&c.jsonRpc){d.jsonRpc=a.extend({},c.jsonRpc,d.jsonRpc)}}b.$userId=b.element.find("input[name=userId]");b.$name=b.element.find(".userId a");b.$fullName=b.element.find(".fullName");b.$email=b.element.find(".email a");b.$relation=b.element.find(".relation");b.$edit=b.element.find(".control > .item-edit");b.$delete=b.element.find(".control > .item-delete");b._setState();b._bindEvents()},_bindEvents:function(){var b=this;var d=b.options;b._squelch=false;var f=function(h,g){h.stopImmediatePropagation();h.preventDefault();h.stopPropagation();b._performUpdate()};var c=function(g){if(b.options.enabled===true){b._showModifyDialog()}g.preventDefault();g.stopPropagation()};var e=function(i){i.stopImmediatePropagation();i.preventDefault();i.stopPropagation();if(b.options.enabled!==true){return}var h='<div class="confirm">Really delete?<br /><button name="yes">Yes</button><button name="no" >No</button></div>';var g=a(h);b.$delete.after(g);b.$delete.attr("disabled",true);g.find("button[name=yes]").click(function(j){b.$delete.removeAttr("disabled");g.remove();b._performDelete()});g.find("button[name=no]").click(function(){b.$delete.removeAttr("disabled");g.remove()})};b.element.bind("change.user",f);b.$edit.bind("click.user",c);b.$delete.bind("click.user",e)},_performDelete:function(){var b=this;var c=b.options;if(c.enabled!==true){return}var d={id:{userId:c.userId}};a.jsonRpc(c.jsonRpc,"user.delete",d,{success:function(f,g,e){if((!f)||(f.error!==null)){a.notify({title:"User delete failed",text:'<p class="error">'+(f?f.error.message:"")+"</p>"});return}b._trigger("deleted")},error:function(f,g,e){a.notify({title:"User delete failed",text:'<p class="error">'+g+"</p>"})},complete:function(e,f){}})},_performUpdate:function(){var c=this;var d=c.options;if((d.enabled!==true)||(c._squelch===true)){return}var b=false;var e={id:{userId:d.userId}};if(c.$name.text()!==d.name){e.name=c.$name.text();b=true}if(c.$fullName.text()!==d.fullName){e.fullName=c.$fullName.text();b=true}if(c.$email.text()!==d.email){e.email=c.$email.text();b=true}if(b!==true){return}a.log("connexions.user::_performUpdate()");if(a.isFunction(c.options.change)){if(!c.options.change(e)){c._resetState();return}}a.jsonRpc(d.jsonRpc,"user.update",e,{success:function(g,h,f){if((!g)||(g.error!==null)){a.notify({title:"User update failed",text:'<p class="error">'+(g?g.error.message:"")+"</p>"});c._resetState();return}if(g.result===null){return}c._squelch=true;c.$name.text(g.result.name);c.$fullName.text(g.result.fullName);c.$email.text(g.result.email);c.$email.attr("href","mailto:"+g.result.email);c._squelch=false;c._setState()},error:function(g,h,f){a.notify({title:"User update failed",text:'<p class="error">'+h+"</p>"});c._resetState()},complete:function(f,g){}})},_showModifyDialog:function(){return},_setState:function(){var b=this;var c=b.options;c.userId=b.$userId.val();c.name=b.$name.text();c.fullName=b.$fullName.text();c.email=b.$email.text()},_resetState:function(){var b=this;var c=b.options;b._squelch=true;b.$name.text(c.name);b.$fullName.text(c.fullName);b.$email.text(c.email);b.$email.attr("href","mailto:"+c.email);b._squelch=false},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!b.options.enabled){b.options.enabled=true;b.element.removeClass("ui-state-disabled");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(b.options.enabled){b.options.enabled=false;b.element.addClass("ui-state-disabled");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$edit.unbind(".user");b.$delete.unbind(".user")}})}(jQuery));