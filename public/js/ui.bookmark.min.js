(function(a){a.widget("ui.bookmark",{version:"0.0.1",widgetEventPrefix:"",options:{userId:null,itemId:null,name:null,description:null,rating:null,isFavorite:null,isPrivate:null,url:null,change:null,enabled:true},_create:function(){var b=this;var c=b.options;b.$userId=b.element.find("input[name=userId]");b.$itemId=b.element.find("input[name=itemId]");b.$name=b.element.find(".itemName a");b.$description=b.element.find(".description");b.$rating=b.element.find(".rating .stars .owner");b.$favorite=b.element.find("input[name=isFavorite]");b.$private=b.element.find("input[name=isPrivate]");b.$edit=b.element.find(".control .item-edit");b.$delete=b.element.find(".control .item-delete");b.$save=b.element.find(".control .item-save");b.$url=b.element.find(".itemName a,.url a");b.$favorite.checkbox({css:"connexions_sprites",cssOn:"star_fill",cssOff:"star_empty",titleOn:"Favorite: click to remove from Favorites",titleOff:"Click to add to Favorites",useElTitle:false,hideLabel:true});b.$private.checkbox({css:"connexions_sprites",cssOn:"lock_fill",cssOff:"lock_empty",titleOn:"Private: click to share",titleOff:"Public: click to mark as private",useElTitle:false,hideLabel:true});b.$rating.stars({});b._setState();b._bindEvents()},_bindEvents:function(){var b=this;var e=b.options;b._squelch=false;var g=function(i,h){i.stopImmediatePropagation();i.preventDefault();i.stopPropagation();a.log("ui.bookmark::_update_item("+h+")");if((b.options.enabled!==true)||(b._squelch===true)){return}var h={userId:e.userId,itemId:e.itemId,isFavorite:b.$favorite.checkbox("isChecked"),isPrivate:b.$private.checkbox("isChecked")};if(b.$name.length>0){h.name=b.$name.text()}if(b.$description.length>0){h.description=b.$description.text()}if(b.$rating.length>0){h.rating=b.$rating.stars("value")}if(a.isFunction(b.options.change)){if(!b.options.change(h)){b._resetState();return}}};var d=function(h){h.preventDefault();h.stopPropagation();if(b.options.enabled!==true){return}};var f=function(h){h.preventDefault();h.stopPropagation();if(b.options.enabled!==true){return}};var c=function(h){h.preventDefault();h.stopPropagation();if(b.options.enabled!==true){return}};b.element.bind("change.bookmark",g);b.$edit.bind("click.bookmark",d);b.$delete.bind("click.bookmark",f);b.$save.bind("click.bookmark",c)},_setState:function(){var b=this;var c=b.options;c.userId=b.$userId.val();c.itemId=b.$itemId.val();c.name=b.$name.text();c.description=b.$description.text();if(b.$rating.length>0){c.rating=b.$rating.stars("value")}c.isFavorite=b.$favorite.checkbox("isChecked");c.isPrivate=b.$private.checkbox("isChecked");c.url=b.$url.attr("href")},_resetState:function(){var b=this;var c=b.options;b._squelch=true;b.$name.text(c.name);b.$description.text(c.description);if(b.$rating.length>0){b.$rating.stars("select",c.rating)}if(c.isFavorite){b.$favorite.checkbox("check")}else{b.$favorite.checkbox("uncheck")}if(c.isPrivate){b.$private.checkbox("check")}else{b.$private.checkbox("uncheck")}b.$url.attr("href",c.url);b._squelch=false},isEnabled:function(){return this.options.enabled},enable:function(){var b=this;var c=b.options;if(!b.options.enabled){b.options.enabled=true;b.element.removeClass("ui-state-disabled");b.$favorite.checkbox("enable");b.$private.checkbox("enable");b.$rating.stars("enable");b._trigger("enabled",null,true)}},disable:function(){var b=this;var c=b.options;if(b.options.enabled){b.options.enabled=false;b.element.addClass("ui-state-disabled");b.$favorite.checkbox("disable");b.$private.checkbox("disable");b.$rating.stars("disable");b._trigger("disabled",null,true)}},destroy:function(){var b=this;var c=b.options;b.$favorite.unbind(".bookmark");b.$private.unbind(".bookmark");b.$rating.unbind(".bookmark");b.$edit.unbind(".bookmark");b.$delete.unbind(".bookmark");b.$save.unbind(".bookmark");b.$favorite.checkbox("destroy");b.$private.checkbox("destroy");b.$rating.stars("destroy")}})}(jQuery));