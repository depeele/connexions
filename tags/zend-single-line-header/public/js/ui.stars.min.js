/*
 * jQuery UI Stars v2.1.1
 * http://plugins.jquery.com/project/Star_Rating_widget
 *
 * Copyright (c) 2009 Orkan (orkans@gmail.com)
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * $Rev: 114 $
 * $Date:: 2009-06-12 #$
 * $Build: 32 (2009-06-12)
 *
 * Take control of pre-assembled HTML:
 *  <div >
 *    <input class='ui-stars-rating' type='hidden' name='rating' value='...' />
 *    <div class='ui-stars ui-stars-cancel ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    <div class='ui-stars ui-stars-star ...'><a ..></a></div>
 *    ...
 *  </div>
 *
 * Depends:
 *  ui.core.js
 *
 */
(function(a){a.widget("ui.stars",{version:"2.1.1b",widgetEventPrefix:"",options:{inputType:"div",split:0,disabled:false,cancelTitle:"Cancel Rating",cancelValue:0,cancelShow:true,oneVoteOnly:false,showTitles:false,captionEl:null,callback:null,starWidth:16,baseClass:"ui-stars",cancelClass:"ui-stars-cancel",starClass:"ui-stars-star",starOnClass:"ui-stars-star-on",starHoverClass:"ui-stars-star-hover",starDisabledClass:"ui-stars-star-disabled",cancelHoverClass:"ui-stars-cancel-hover",cancelDisabledClass:"ui-stars-cancel-disabled"},_create:function(){var b=this,e=this.options,f=0;this.$stars=a("."+e.starClass,this.element);this.$cancel=a("."+e.cancelClass,this.element);this.$input=a("input[type=hidden]:first",this.element);e.items=this.$stars.filter("."+e.starClass).length;e.value=this.$stars.filter("."+e.starOnClass).length;if(e.value>0){e.checked=e.defaultValue=e.value}else{e.value=e.cancelValue}if(e.disabled){this.$cancel.addClass(e.cancelDisabledClass)}e.cancelShow&=!e.oneVoteOnly;function d(){b.$stars.removeClass(e.starOnClass+" "+e.starHoverClass);b._showCap("")}function c(g,i){if(g>=0){var j=i?e.starHoverClass:e.starOnClass;var h=i?e.starOnClass:e.starHoverClass;b.$stars.eq(g).removeClass(h).addClass(j).prevAll("."+e.starClass).removeClass(h).addClass(j);b.$stars.eq(g).nextAll("."+e.starClass).removeClass(e.starHoverClass+" "+e.starOnClass);b._showCap(b.$stars.eq(g).find("a").attr("title"))}else{d()}}this.$stars.bind("click.stars",function(h){if(!e.forceSelect&&e.disabled){return false}var g=b.$stars.index(this);e.checked=g;e.value=g+1;e.title=a(this).find("a").attr("title");b.$input.val(e.value);c(e.checked,false);b._disableCancel();!e.forceSelect&&b.callback(h,"star");b._trigger("change",null,e.value)}).bind("mouseover.stars",function(){if(e.disabled){return false}var g=b.$stars.index(this);c(g,true)}).bind("mouseout.stars",function(){if(e.disabled){return false}c(e.checked,false)});this.$cancel.bind("click.stars",function(g){if(!e.forceSelect&&(e.disabled||e.value===e.cancelValue)){return false}e.checked=-1;e.value=e.cancelValue;b.$input.val(e.cancelValue);d();b._disableCancel();!e.forceSelect&&b.callback(g,"cancel")}).bind("mouseover.stars",function(){if(b._disableCancel()){return false}b.$cancel.addClass(e.cancelHoverClass);d();b._showCap(e.cancelTitle)}).bind("mouseout.stars",function(){if(b._disableCancel()){return false}b.$cancel.removeClass(e.cancelHoverClass);b.$stars.triggerHandler("mouseout.stars")});a(window).unload(function(){b.$cancel.unbind(".stars");b.$stars.unbind(".stars");b.$stars=b.$cancel=null});this.select(e.value);e.disabled&&this.disable()},_disableCancel:function(){var c=this.options,b=c.disabled||c.oneVoteOnly||(c.value===c.cancelValue);if(b){this.$cancel.removeClass(c.cancelHoverClass).addClass(c.cancelDisabledClass)}else{this.$cancel.removeClass(c.cancelDisabledClass)}this.$cancel.css("opacity",b?0.5:1);return b},_disableAll:function(){var b=this.options;this._disableCancel();if(b.disabled){this.$stars.filter("div").addClass(b.starDisabledClass)}else{this.$stars.filter("div").removeClass(b.starDisabledClass)}},_showCap:function(b){var c=this.options;if(c.captionEl){c.captionEl.text(b)}},value:function(){return this.options.value},select:function(d){var c=this.options,b=(d===c.cancelValue)?this.$cancel:this.$stars.eq(d-1);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},selectID:function(d){var c=this.options,b=(d===-1)?this.$cancel:this.$stars.eq(d);c.forceSelect=true;b.triggerHandler("click.stars");c.forceSelect=false},enable:function(){this.options.disabled=false;this._disableAll()},disable:function(){this.options.disabled=true;this._disableAll()},destroy:function(){this.$cancel.unbind(".stars");this.$stars.unbind(".stars");this.element.unbind(".stars").removeData("stars")},callback:function(c,b){var d=this.options;d.callback&&d.callback(this,b,d.value,c);d.oneVoteOnly&&!d.disabled&&this.disable()}})}(jQuery));